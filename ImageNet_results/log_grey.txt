{'dataset': 'imagenet', 'save': 'black_results_imagenet', 'attack': 'black', 'numimg': 50, 'maxiter': 2000, 'print_every': 1, 'early_stop_iters': 0, 'firstimg': 0, 'binary_steps': 2, 'init_const': 100, 'use_zvalue': False, 'untargeted': True, 'reset_adam': True, 'use_resize': True, 'adam_beta1': 0.9, 'adam_beta2': 0.999, 'seed': 1216, 'solver': 'adam', 'save_ckpts': 'best_modifier_imagenet', 'load_ckpt': '', 'start_iter': 0, 'init_size': 32, 'uniform': False, 'method': 'tanh', 'gpu': '0', 'hash': 10, 'batch': 256, 'start_idx': 1, 'dct': False, 'lr': 0.01, 'transform': 'centrol_crop', 'dist_metrics': 'pdist', 'bits': 8, 'factor': 4, 'maximize': 'minus', 'htype': 'phash', 'inception': False, 'use_tanh': True}
Loading model imagenet
Device mapping:
early stop: 200
creating save_ckpts  best_modifier_imagenet
use tanh True
method is  tanh
batch size  256
resize  32
use important  True
load ckpt 
use dct False
dist metrics pdist
htype  phash
loss2  Tensor("Reshape_3:0", shape=(?,), dtype=float32)
Using adam solver
Generate data
Done...
for image id  1
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 1.92e-08, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 5.776, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 4.6563e-05, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 7.418, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00010757, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 9.108, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00018217, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 10.907, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00026568, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 12.631, size = (1, 32, 32, 1), loss = 37.995, loss1 = 37.995, loss2 = 0.00036219, lr=0.01
saving outstep 0 and iteration 5
[STATS][L2] iter = 6, cost = 1536, time = 14.282, size = (1, 32, 32, 1), loss = 37.995, loss1 = 37.995, loss2 = 0.00046152, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 15.871, size = (1, 32, 32, 1), loss = 37.995, loss1 = 37.995, loss2 = 0.00058839, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 17.403, size = (1, 32, 32, 1), loss = 19.738, loss1 = 19.738, loss2 = 0.000727, lr=0.01
saving outstep 0 and iteration 8
[STATS][L2] iter = 9, cost = 2304, time = 19.039, size = (1, 32, 32, 1), loss = 0.00085054, loss1 = 0, loss2 = 0.00085054, lr=0.01
saving outstep 0 and iteration 9
[STATS][L3](First valid attack found!) iter = 9, cost = 2560, time = 19.039, size = (1, 32, 32, 1), loss = 0.00085116, loss1 = 0, loss2 = 0.00085116
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.526, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 5.1108e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.067, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00011555, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.824, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00018685, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.408, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00026794, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.974, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00035675, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.542, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00045322, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.092, size = (1, 32, 32, 1), loss = 9.8693, loss1 = 9.8688, loss2 = 0.00056912, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.637, size = (1, 32, 32, 1), loss = 9.8695, loss1 = 9.8688, loss2 = 0.00070026, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.195, size = (1, 32, 32, 1), loss = 0.00082996, loss1 = 0, loss2 = 0.00082996, lr=0.01
saving outstep 1 and iteration 9
[STATS][L3](Attack found!) iter = 9, cost = 2560, time = 14.195, size = (1, 32, 32, 1), loss = 0.00083102, loss1 = 0, loss2 = 0.00083102
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  2.4328317782974085
l2_distortion between inputs and adv_current  2.4328317782974085
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.00082994706
perceptual metrics distance between adv_current and img 0.00082994706
normalized perceptual metrics distance between adv and img 2.8817606410787753e-06
normalized perceptual metrics distance between adv_current and img 2.8817606410787753e-06
perceptual hash difference is  10
Saving to id1_differ10_True_l22.43_pdistance0.0008299470646306872
[STATS][L1] total = 2, id = 1, time = 41.515, success = True, const = 50.000000, hash_avg=10.00000, distortion = 2.43283, success_rate = 0.500, l2_avg=2.43283, p_avg=0.0008299470646306872, iteration_avg=10.0
vice:GPU:0
overall average l2  2.4328317782974085
overal average perceptual distance  0.0008299470646306872
overal average iterations  10.0
for image id  2
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.616, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 6.0279e-06, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.178, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 1.4948e-05, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.731, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 2.7811e-05, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.523, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 4.2917e-05, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 8.058, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 6.461e-05, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.587, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 9.1338e-05, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.115, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00011132, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.658, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00013367, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.190, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00016764, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.841, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00019857, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.542, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00023798, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 19.093, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00026432, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.619, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00030331, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.147, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00034055, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.673, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00038792, lr=0.01
saving outstep 0 and iteration 15
[STATS][L2] iter = 16, cost = 4096, time = 25.199, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00044102, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.722, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00049154, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.263, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00056593, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.861, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00062425, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.481, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00067607, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 33.080, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00075991, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.840, size = (1, 32, 32, 1), loss = 66.405, loss1 = 66.404, loss2 = 0.00083345, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 36.411, size = (1, 32, 32, 1), loss = 66.405, loss1 = 66.404, loss2 = 0.00090734, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.961, size = (1, 32, 32, 1), loss = 66.405, loss1 = 66.404, loss2 = 0.00099989, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 39.502, size = (1, 32, 32, 1), loss = 66.405, loss1 = 66.404, loss2 = 0.0010983, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 41.025, size = (1, 32, 32, 1), loss = 66.405, loss1 = 66.404, loss2 = 0.0011978, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.589, size = (1, 32, 32, 1), loss = 66.405, loss1 = 66.404, loss2 = 0.0012877, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 44.275, size = (1, 32, 32, 1), loss = 66.405, loss1 = 66.404, loss2 = 0.001371, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.811, size = (1, 32, 32, 1), loss = 66.405, loss1 = 66.404, loss2 = 0.0014728, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 47.381, size = (1, 32, 32, 1), loss = 66.405, loss1 = 66.404, loss2 = 0.0015876, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 48.929, size = (1, 32, 32, 1), loss = 66.405, loss1 = 66.404, loss2 = 0.0016997, lr=0.01
[STATS][L2] iter = 32, cost = 8192, time = 50.467, size = (1, 32, 32, 1), loss = 66.406, loss1 = 66.404, loss2 = 0.0018551, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 52.038, size = (1, 32, 32, 1), loss = 66.406, loss1 = 66.404, loss2 = 0.0019602, lr=0.01
[STATS][L2] iter = 34, cost = 8704, time = 53.562, size = (1, 32, 32, 1), loss = 66.406, loss1 = 66.404, loss2 = 0.0020496, lr=0.01
[STATS][L2] iter = 35, cost = 8960, time = 55.106, size = (1, 32, 32, 1), loss = 66.406, loss1 = 66.404, loss2 = 0.002144, lr=0.01
[STATS][L2] iter = 36, cost = 9216, time = 56.648, size = (1, 32, 32, 1), loss = 53.707, loss1 = 53.705, loss2 = 0.002237, lr=0.01
saving outstep 0 and iteration 36
[STATS][L2] iter = 37, cost = 9472, time = 58.314, size = (1, 32, 32, 1), loss = 53.707, loss1 = 53.705, loss2 = 0.0023881, lr=0.01
[STATS][L2] iter = 38, cost = 9728, time = 59.841, size = (1, 32, 32, 1), loss = 53.707, loss1 = 53.705, loss2 = 0.0025122, lr=0.01
[STATS][L2] iter = 39, cost = 9984, time = 61.383, size = (1, 32, 32, 1), loss = 53.708, loss1 = 53.705, loss2 = 0.0026449, lr=0.01
[STATS][L2] iter = 40, cost = 10240, time = 62.925, size = (1, 32, 32, 1), loss = 53.708, loss1 = 53.705, loss2 = 0.00283, lr=0.01
[STATS][L2] iter = 41, cost = 10496, time = 64.466, size = (1, 32, 32, 1), loss = 53.708, loss1 = 53.705, loss2 = 0.0029817, lr=0.01
[STATS][L2] iter = 42, cost = 10752, time = 65.992, size = (1, 32, 32, 1), loss = 53.708, loss1 = 53.705, loss2 = 0.0031792, lr=0.01
[STATS][L2] iter = 43, cost = 11008, time = 67.517, size = (1, 32, 32, 1), loss = 53.708, loss1 = 53.705, loss2 = 0.0033445, lr=0.01
[STATS][L2] iter = 44, cost = 11264, time = 69.129, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0035539, lr=0.01
saving outstep 0 and iteration 44
[STATS][L2] iter = 45, cost = 11520, time = 70.682, size = (1, 32, 32, 1), loss = 37.999, loss1 = 37.995, loss2 = 0.0037347, lr=0.01
[STATS][L2] iter = 46, cost = 11776, time = 72.356, size = (1, 32, 32, 1), loss = 37.999, loss1 = 37.995, loss2 = 0.003917, lr=0.01
[STATS][L2] iter = 47, cost = 12032, time = 73.958, size = (1, 32, 32, 1), loss = 37.999, loss1 = 37.995, loss2 = 0.0040936, lr=0.01
[STATS][L2] iter = 48, cost = 12288, time = 75.478, size = (1, 32, 32, 1), loss = 37.999, loss1 = 37.995, loss2 = 0.0042213, lr=0.01
[STATS][L2] iter = 49, cost = 12544, time = 77.021, size = (1, 32, 32, 1), loss = 37.999, loss1 = 37.995, loss2 = 0.0043909, lr=0.01
[STATS][L2] iter = 50, cost = 12800, time = 78.553, size = (1, 32, 32, 1), loss = 37.999, loss1 = 37.995, loss2 = 0.0045447, lr=0.01
[STATS][L2] iter = 51, cost = 13056, time = 80.144, size = (1, 32, 32, 1), loss = 38, loss1 = 37.995, loss2 = 0.0047173, lr=0.01
[STATS][L2] iter = 52, cost = 13312, time = 81.674, size = (1, 32, 32, 1), loss = 38, loss1 = 37.995, loss2 = 0.0048832, lr=0.01
[STATS][L2] iter = 53, cost = 13568, time = 83.250, size = (1, 32, 32, 1), loss = 38, loss1 = 37.995, loss2 = 0.005074, lr=0.01
[STATS][L2] iter = 54, cost = 13824, time = 85.070, size = (1, 32, 32, 1), loss = 38, loss1 = 37.995, loss2 = 0.0053107, lr=0.01
[STATS][L2] iter = 55, cost = 14080, time = 86.636, size = (1, 32, 32, 1), loss = 38, loss1 = 37.995, loss2 = 0.0055352, lr=0.01
[STATS][L2] iter = 56, cost = 14336, time = 88.164, size = (1, 32, 32, 1), loss = 38.001, loss1 = 37.995, loss2 = 0.0057727, lr=0.01
[STATS][L2] iter = 57, cost = 14592, time = 89.697, size = (1, 32, 32, 1), loss = 38.001, loss1 = 37.995, loss2 = 0.0060429, lr=0.01
[STATS][L2] iter = 58, cost = 14848, time = 91.300, size = (1, 32, 32, 1), loss = 38.001, loss1 = 37.995, loss2 = 0.0062444, lr=0.01
[STATS][L2] iter = 59, cost = 15104, time = 92.837, size = (1, 32, 32, 1), loss = 38.001, loss1 = 37.995, loss2 = 0.0064706, lr=0.01
[STATS][L2] iter = 60, cost = 15360, time = 94.544, size = (1, 32, 32, 1), loss = 38.002, loss1 = 37.995, loss2 = 0.0066392, lr=0.01
[STATS][L2] iter = 61, cost = 15616, time = 96.080, size = (1, 32, 32, 1), loss = 38.002, loss1 = 37.995, loss2 = 0.0069387, lr=0.01
[STATS][L2] iter = 62, cost = 15872, time = 97.671, size = (1, 32, 32, 1), loss = 38.002, loss1 = 37.995, loss2 = 0.0072179, lr=0.01
[STATS][L2] iter = 63, cost = 16128, time = 99.244, size = (1, 32, 32, 1), loss = 38.002, loss1 = 37.995, loss2 = 0.0074035, lr=0.01
[STATS][L2] iter = 64, cost = 16384, time = 100.807, size = (1, 32, 32, 1), loss = 38.003, loss1 = 37.995, loss2 = 0.0076831, lr=0.01
[STATS][L2] iter = 65, cost = 16640, time = 102.348, size = (1, 32, 32, 1), loss = 38.003, loss1 = 37.995, loss2 = 0.0079516, lr=0.01
[STATS][L2] iter = 66, cost = 16896, time = 103.925, size = (1, 32, 32, 1), loss = 38.003, loss1 = 37.995, loss2 = 0.0082781, lr=0.01
[STATS][L2] iter = 67, cost = 17152, time = 105.549, size = (1, 32, 32, 1), loss = 38.003, loss1 = 37.995, loss2 = 0.0085685, lr=0.01
[STATS][L2] iter = 68, cost = 17408, time = 107.143, size = (1, 32, 32, 1), loss = 38.004, loss1 = 37.995, loss2 = 0.0088594, lr=0.01
[STATS][L2] iter = 69, cost = 17664, time = 108.681, size = (1, 32, 32, 1), loss = 38.004, loss1 = 37.995, loss2 = 0.0092611, lr=0.01
[STATS][L2] iter = 70, cost = 17920, time = 110.242, size = (1, 32, 32, 1), loss = 38.005, loss1 = 37.995, loss2 = 0.0096371, lr=0.01
[STATS][L2] iter = 71, cost = 18176, time = 111.826, size = (1, 32, 32, 1), loss = 19.747, loss1 = 19.738, loss2 = 0.0099576, lr=0.01
saving outstep 0 and iteration 71
[STATS][L2] iter = 72, cost = 18432, time = 113.395, size = (1, 32, 32, 1), loss = 19.748, loss1 = 19.738, loss2 = 0.010226, lr=0.01
[STATS][L2] iter = 73, cost = 18688, time = 115.009, size = (1, 32, 32, 1), loss = 19.748, loss1 = 19.738, loss2 = 0.010526, lr=0.01
[STATS][L2] iter = 74, cost = 18944, time = 116.554, size = (1, 32, 32, 1), loss = 19.748, loss1 = 19.738, loss2 = 0.01088, lr=0.01
[STATS][L2] iter = 75, cost = 19200, time = 118.243, size = (1, 32, 32, 1), loss = 19.749, loss1 = 19.738, loss2 = 0.011328, lr=0.01
[STATS][L2] iter = 76, cost = 19456, time = 119.784, size = (1, 32, 32, 1), loss = 19.749, loss1 = 19.738, loss2 = 0.011727, lr=0.01
[STATS][L2] iter = 77, cost = 19712, time = 121.312, size = (1, 32, 32, 1), loss = 19.75, loss1 = 19.738, loss2 = 0.012077, lr=0.01
[STATS][L2] iter = 78, cost = 19968, time = 122.866, size = (1, 32, 32, 1), loss = 19.75, loss1 = 19.738, loss2 = 0.012419, lr=0.01
[STATS][L2] iter = 79, cost = 20224, time = 124.391, size = (1, 32, 32, 1), loss = 19.75, loss1 = 19.738, loss2 = 0.01277, lr=0.01
[STATS][L2] iter = 80, cost = 20480, time = 125.930, size = (1, 32, 32, 1), loss = 19.751, loss1 = 19.738, loss2 = 0.013263, lr=0.01
[STATS][L2] iter = 81, cost = 20736, time = 127.447, size = (1, 32, 32, 1), loss = 19.751, loss1 = 19.738, loss2 = 0.013629, lr=0.01
[STATS][L2] iter = 82, cost = 20992, time = 129.004, size = (1, 32, 32, 1), loss = 19.752, loss1 = 19.738, loss2 = 0.014076, lr=0.01
[STATS][L2] iter = 83, cost = 21248, time = 130.553, size = (1, 32, 32, 1), loss = 19.752, loss1 = 19.738, loss2 = 0.014471, lr=0.01
[STATS][L2] iter = 84, cost = 21504, time = 132.155, size = (1, 32, 32, 1), loss = 19.752, loss1 = 19.738, loss2 = 0.014872, lr=0.01
[STATS][L2] iter = 85, cost = 21760, time = 133.760, size = (1, 32, 32, 1), loss = 19.753, loss1 = 19.738, loss2 = 0.015358, lr=0.01
[STATS][L2] iter = 86, cost = 22016, time = 135.332, size = (1, 32, 32, 1), loss = 19.753, loss1 = 19.738, loss2 = 0.015768, lr=0.01
[STATS][L2] iter = 87, cost = 22272, time = 136.870, size = (1, 32, 32, 1), loss = 19.754, loss1 = 19.738, loss2 = 0.016228, lr=0.01
[STATS][L2] iter = 88, cost = 22528, time = 138.413, size = (1, 32, 32, 1), loss = 0.016723, loss1 = 0, loss2 = 0.016723, lr=0.01
saving outstep 0 and iteration 88
[STATS][L3](First valid attack found!) iter = 88, cost = 22784, time = 138.413, size = (1, 32, 32, 1), loss = 0.0167, loss1 = 0, loss2 = 0.0167
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.532, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 6.428e-06, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.046, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 1.5026e-05, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.687, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 2.7752e-05, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.239, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 4.2789e-05, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.786, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 5.8808e-05, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.304, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 7.5711e-05, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.840, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 9.5249e-05, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.372, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0.00012147, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 13.914, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0.00015271, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.431, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0.00018346, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 16.967, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00021942, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.569, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00025878, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.198, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00030414, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.732, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00035344, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.248, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00040509, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 24.760, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00046695, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.275, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00051188, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 27.791, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00058645, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.334, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.0006632, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 30.860, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.00072725, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.420, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.00079712, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 33.974, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.0008851, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 35.662, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.00094757, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.208, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.00099328, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 38.740, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.0010807, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 40.451, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.0011934, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 41.972, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.0012657, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 43.495, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.001364, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.088, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.0014897, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 46.689, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.0015779, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 48.255, size = (1, 32, 32, 1), loss = 33.204, loss1 = 33.202, loss2 = 0.0016932, lr=0.01
[STATS][L2] iter = 32, cost = 8192, time = 49.938, size = (1, 32, 32, 1), loss = 33.204, loss1 = 33.202, loss2 = 0.0018425, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 51.478, size = (1, 32, 32, 1), loss = 33.204, loss1 = 33.202, loss2 = 0.0019878, lr=0.01
[STATS][L2] iter = 34, cost = 8704, time = 53.025, size = (1, 32, 32, 1), loss = 33.204, loss1 = 33.202, loss2 = 0.0020807, lr=0.01
[STATS][L2] iter = 35, cost = 8960, time = 54.747, size = (1, 32, 32, 1), loss = 33.204, loss1 = 33.202, loss2 = 0.0021819, lr=0.01
[STATS][L2] iter = 36, cost = 9216, time = 56.278, size = (1, 32, 32, 1), loss = 33.204, loss1 = 33.202, loss2 = 0.0023208, lr=0.01
[STATS][L2] iter = 37, cost = 9472, time = 57.799, size = (1, 32, 32, 1), loss = 33.204, loss1 = 33.202, loss2 = 0.0024684, lr=0.01
[STATS][L2] iter = 38, cost = 9728, time = 59.403, size = (1, 32, 32, 1), loss = 26.855, loss1 = 26.852, loss2 = 0.0026346, lr=0.01
[STATS][L2] iter = 39, cost = 9984, time = 61.001, size = (1, 32, 32, 1), loss = 26.855, loss1 = 26.852, loss2 = 0.002819, lr=0.01
[STATS][L2] iter = 40, cost = 10240, time = 62.584, size = (1, 32, 32, 1), loss = 26.855, loss1 = 26.852, loss2 = 0.00298, lr=0.01
[STATS][L2] iter = 41, cost = 10496, time = 64.117, size = (1, 32, 32, 1), loss = 26.856, loss1 = 26.852, loss2 = 0.0031253, lr=0.01
[STATS][L2] iter = 42, cost = 10752, time = 65.699, size = (1, 32, 32, 1), loss = 26.856, loss1 = 26.852, loss2 = 0.0033357, lr=0.01
[STATS][L2] iter = 43, cost = 11008, time = 67.243, size = (1, 32, 32, 1), loss = 26.856, loss1 = 26.852, loss2 = 0.0035246, lr=0.01
[STATS][L2] iter = 44, cost = 11264, time = 68.779, size = (1, 32, 32, 1), loss = 26.856, loss1 = 26.852, loss2 = 0.0037344, lr=0.01
[STATS][L2] iter = 45, cost = 11520, time = 70.309, size = (1, 32, 32, 1), loss = 26.856, loss1 = 26.852, loss2 = 0.0038905, lr=0.01
[STATS][L2] iter = 46, cost = 11776, time = 71.837, size = (1, 32, 32, 1), loss = 26.857, loss1 = 26.852, loss2 = 0.0040878, lr=0.01
[STATS][L2] iter = 47, cost = 12032, time = 73.392, size = (1, 32, 32, 1), loss = 26.857, loss1 = 26.852, loss2 = 0.0042935, lr=0.01
[STATS][L2] iter = 48, cost = 12288, time = 74.979, size = (1, 32, 32, 1), loss = 26.857, loss1 = 26.852, loss2 = 0.0045088, lr=0.01
[STATS][L2] iter = 49, cost = 12544, time = 76.603, size = (1, 32, 32, 1), loss = 26.857, loss1 = 26.852, loss2 = 0.0047, lr=0.01
[STATS][L2] iter = 50, cost = 12800, time = 78.129, size = (1, 32, 32, 1), loss = 26.857, loss1 = 26.852, loss2 = 0.0049057, lr=0.01
[STATS][L2] iter = 51, cost = 13056, time = 79.714, size = (1, 32, 32, 1), loss = 26.858, loss1 = 26.852, loss2 = 0.0051058, lr=0.01
[STATS][L2] iter = 52, cost = 13312, time = 81.281, size = (1, 32, 32, 1), loss = 26.858, loss1 = 26.852, loss2 = 0.0053293, lr=0.01
[STATS][L2] iter = 53, cost = 13568, time = 82.806, size = (1, 32, 32, 1), loss = 26.858, loss1 = 26.852, loss2 = 0.0055838, lr=0.01
[STATS][L2] iter = 54, cost = 13824, time = 84.386, size = (1, 32, 32, 1), loss = 26.858, loss1 = 26.852, loss2 = 0.005858, lr=0.01
[STATS][L2] iter = 55, cost = 14080, time = 85.918, size = (1, 32, 32, 1), loss = 19.004, loss1 = 18.997, loss2 = 0.0061178, lr=0.01
[STATS][L2] iter = 56, cost = 14336, time = 87.464, size = (1, 32, 32, 1), loss = 19.004, loss1 = 18.997, loss2 = 0.006511, lr=0.01
[STATS][L2] iter = 57, cost = 14592, time = 89.027, size = (1, 32, 32, 1), loss = 19.004, loss1 = 18.997, loss2 = 0.0068199, lr=0.01
[STATS][L2] iter = 58, cost = 14848, time = 90.680, size = (1, 32, 32, 1), loss = 19.005, loss1 = 18.997, loss2 = 0.0071375, lr=0.01
[STATS][L2] iter = 59, cost = 15104, time = 92.224, size = (1, 32, 32, 1), loss = 19.005, loss1 = 18.997, loss2 = 0.0074455, lr=0.01
[STATS][L2] iter = 60, cost = 15360, time = 93.763, size = (1, 32, 32, 1), loss = 19.005, loss1 = 18.997, loss2 = 0.0076628, lr=0.01
[STATS][L2] iter = 61, cost = 15616, time = 95.298, size = (1, 32, 32, 1), loss = 19.006, loss1 = 18.997, loss2 = 0.0080713, lr=0.01
[STATS][L2] iter = 62, cost = 15872, time = 96.839, size = (1, 32, 32, 1), loss = 19.006, loss1 = 18.997, loss2 = 0.0084088, lr=0.01
[STATS][L2] iter = 63, cost = 16128, time = 98.362, size = (1, 32, 32, 1), loss = 19.006, loss1 = 18.997, loss2 = 0.0087193, lr=0.01
[STATS][L2] iter = 64, cost = 16384, time = 99.886, size = (1, 32, 32, 1), loss = 19.006, loss1 = 18.997, loss2 = 0.0090072, lr=0.01
[STATS][L2] iter = 65, cost = 16640, time = 101.419, size = (1, 32, 32, 1), loss = 19.007, loss1 = 18.997, loss2 = 0.0093293, lr=0.01
[STATS][L2] iter = 66, cost = 16896, time = 102.979, size = (1, 32, 32, 1), loss = 19.007, loss1 = 18.997, loss2 = 0.0097537, lr=0.01
[STATS][L2] iter = 67, cost = 17152, time = 104.606, size = (1, 32, 32, 1), loss = 9.8789, loss1 = 9.8688, loss2 = 0.010172, lr=0.01
[STATS][L2] iter = 68, cost = 17408, time = 106.151, size = (1, 32, 32, 1), loss = 9.8793, loss1 = 9.8688, loss2 = 0.010561, lr=0.01
[STATS][L2] iter = 69, cost = 17664, time = 107.720, size = (1, 32, 32, 1), loss = 9.8798, loss1 = 9.8688, loss2 = 0.011006, lr=0.01
[STATS][L2] iter = 70, cost = 17920, time = 109.275, size = (1, 32, 32, 1), loss = 9.8802, loss1 = 9.8688, loss2 = 0.01146, lr=0.01
[STATS][L2] iter = 71, cost = 18176, time = 110.824, size = (1, 32, 32, 1), loss = 9.8808, loss1 = 9.8688, loss2 = 0.012015, lr=0.01
[STATS][L2] iter = 72, cost = 18432, time = 112.363, size = (1, 32, 32, 1), loss = 9.8811, loss1 = 9.8688, loss2 = 0.012298, lr=0.01
[STATS][L2] iter = 73, cost = 18688, time = 113.889, size = (1, 32, 32, 1), loss = 9.8815, loss1 = 9.8688, loss2 = 0.012762, lr=0.01
[STATS][L2] iter = 74, cost = 18944, time = 115.457, size = (1, 32, 32, 1), loss = 9.882, loss1 = 9.8688, loss2 = 0.013227, lr=0.01
[STATS][L2] iter = 75, cost = 19200, time = 117.056, size = (1, 32, 32, 1), loss = 9.8823, loss1 = 9.8688, loss2 = 0.013521, lr=0.01
[STATS][L2] iter = 76, cost = 19456, time = 118.654, size = (1, 32, 32, 1), loss = 9.8828, loss1 = 9.8688, loss2 = 0.014023, lr=0.01
[STATS][L2] iter = 77, cost = 19712, time = 120.187, size = (1, 32, 32, 1), loss = 9.8833, loss1 = 9.8688, loss2 = 0.01451, lr=0.01
[STATS][L2] iter = 78, cost = 19968, time = 121.768, size = (1, 32, 32, 1), loss = 9.8838, loss1 = 9.8688, loss2 = 0.015053, lr=0.01
[STATS][L2] iter = 79, cost = 20224, time = 123.312, size = (1, 32, 32, 1), loss = 9.8843, loss1 = 9.8688, loss2 = 0.015563, lr=0.01
[STATS][L2] iter = 80, cost = 20480, time = 124.893, size = (1, 32, 32, 1), loss = 9.8848, loss1 = 9.8688, loss2 = 0.016035, lr=0.01
[STATS][L2] iter = 81, cost = 20736, time = 126.424, size = (1, 32, 32, 1), loss = 9.8854, loss1 = 9.8688, loss2 = 0.016592, lr=0.01
[STATS][L2] iter = 82, cost = 20992, time = 128.009, size = (1, 32, 32, 1), loss = 9.886, loss1 = 9.8688, loss2 = 0.017216, lr=0.01
[STATS][L2] iter = 83, cost = 21248, time = 129.782, size = (1, 32, 32, 1), loss = 9.8865, loss1 = 9.8688, loss2 = 0.017751, lr=0.01
[STATS][L2] iter = 84, cost = 21504, time = 131.349, size = (1, 32, 32, 1), loss = 9.887, loss1 = 9.8688, loss2 = 0.018205, lr=0.01
[STATS][L2] iter = 85, cost = 21760, time = 132.893, size = (1, 32, 32, 1), loss = 9.8873, loss1 = 9.8688, loss2 = 0.018573, lr=0.01
[STATS][L2] iter = 86, cost = 22016, time = 134.443, size = (1, 32, 32, 1), loss = 9.8879, loss1 = 9.8688, loss2 = 0.01911, lr=0.01
[STATS][L2] iter = 87, cost = 22272, time = 136.006, size = (1, 32, 32, 1), loss = 9.8884, loss1 = 9.8688, loss2 = 0.019601, lr=0.01
[STATS][L2] iter = 88, cost = 22528, time = 137.560, size = (1, 32, 32, 1), loss = 9.889, loss1 = 9.8688, loss2 = 0.020242, lr=0.01
[STATS][L2] iter = 89, cost = 22784, time = 139.085, size = (1, 32, 32, 1), loss = 9.8894, loss1 = 9.8688, loss2 = 0.020617, lr=0.01
[STATS][L2] iter = 90, cost = 23040, time = 140.617, size = (1, 32, 32, 1), loss = 9.8898, loss1 = 9.8688, loss2 = 0.021032, lr=0.01
[STATS][L2] iter = 91, cost = 23296, time = 142.345, size = (1, 32, 32, 1), loss = 9.8904, loss1 = 9.8688, loss2 = 0.021592, lr=0.01
[STATS][L2] iter = 92, cost = 23552, time = 143.946, size = (1, 32, 32, 1), loss = 9.891, loss1 = 9.8688, loss2 = 0.022218, lr=0.01
[STATS][L2] iter = 93, cost = 23808, time = 145.582, size = (1, 32, 32, 1), loss = 9.8914, loss1 = 9.8688, loss2 = 0.022595, lr=0.01
[STATS][L2] iter = 94, cost = 24064, time = 147.186, size = (1, 32, 32, 1), loss = 9.8919, loss1 = 9.8688, loss2 = 0.023147, lr=0.01
[STATS][L2] iter = 95, cost = 24320, time = 148.712, size = (1, 32, 32, 1), loss = 9.8924, loss1 = 9.8688, loss2 = 0.023621, lr=0.01
[STATS][L2] iter = 96, cost = 24576, time = 150.281, size = (1, 32, 32, 1), loss = 9.8927, loss1 = 9.8688, loss2 = 0.023924, lr=0.01
[STATS][L2] iter = 97, cost = 24832, time = 151.817, size = (1, 32, 32, 1), loss = 9.8935, loss1 = 9.8688, loss2 = 0.024746, lr=0.01
[STATS][L2] iter = 98, cost = 25088, time = 153.372, size = (1, 32, 32, 1), loss = 0.025398, loss1 = 0, loss2 = 0.025398, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 98, cost = 25344, time = 153.372, size = (1, 32, 32, 1), loss = 0.025376, loss1 = 0, loss2 = 0.025376
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  6.866369205601716
l2_distortion between inputs and adv_current  6.866369205601716
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.016722843
perceptual metrics distance between adv_current and img 0.016722843
normalized perceptual metrics distance between adv and img 5.806542726026641e-05
normalized perceptual metrics distance between adv_current and img 5.806542726026641e-05
perceptual hash difference is  10
Saving to id2_differ10_True_l26.87_pdistance0.016722843050956726
[STATS][L1] total = 3, id = 2, time = 296.995, success = True, const = 100.000000, hash_avg=10.00000, distortion = 6.86637, success_rate = 0.667, l2_avg=4.64960, p_avg=0.008776395057793707, iteration_avg=49.5
overall average l2  4.649600491949562
overal average perceptual distance  0.008776395057793707
overal average iterations  49.5
for image id  3
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.894, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 1.5453e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.558, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 4.1289e-05, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 5.121, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 7.1415e-05, lr=0.01
saving outstep 0 and iteration 3
[STATS][L2] iter = 4, cost = 1024, time = 6.696, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00010724, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 8.267, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00015573, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.814, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00021529, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.376, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00027792, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.972, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00033917, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.541, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00041904, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 16.155, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00049656, lr=0.01
saving outstep 0 and iteration 10
[STATS][L2] iter = 11, cost = 2816, time = 17.759, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00058301, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 19.297, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00068029, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.830, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00076715, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.415, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00088214, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.945, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00099406, lr=0.01
saving outstep 0 and iteration 15
[STATS][L2] iter = 16, cost = 4096, time = 25.494, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.001109, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 27.085, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0012124, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.670, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0013405, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 30.257, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0014665, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.827, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0015969, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 33.383, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0017193, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.964, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0018606, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 36.506, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0019808, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 38.050, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0021444, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 39.572, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0022738, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 41.126, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0023969, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.694, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0025283, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 44.278, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0026734, lr=0.01
saving outstep 0 and iteration 28
[STATS][L2] iter = 29, cost = 7424, time = 45.835, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0028303, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 47.385, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0029647, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 48.945, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0030923, lr=0.01
[STATS][L2] iter = 32, cost = 8192, time = 50.502, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0032498, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 52.045, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0034124, lr=0.01
[STATS][L2] iter = 34, cost = 8704, time = 53.583, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0035747, lr=0.01
[STATS][L2] iter = 35, cost = 8960, time = 55.164, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0037362, lr=0.01
[STATS][L2] iter = 36, cost = 9216, time = 56.742, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0038914, lr=0.01
[STATS][L2] iter = 37, cost = 9472, time = 58.520, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0040723, lr=0.01
[STATS][L2] iter = 38, cost = 9728, time = 60.062, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0042198, lr=0.01
[STATS][L2] iter = 39, cost = 9984, time = 61.640, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0043829, lr=0.01
[STATS][L2] iter = 40, cost = 10240, time = 63.171, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0045593, lr=0.01
[STATS][L2] iter = 41, cost = 10496, time = 64.696, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0047634, lr=0.01
[STATS][L2] iter = 42, cost = 10752, time = 66.228, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0049316, lr=0.01
[STATS][L2] iter = 43, cost = 11008, time = 67.777, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0050915, lr=0.01
[STATS][L2] iter = 44, cost = 11264, time = 69.348, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0052852, lr=0.01
[STATS][L2] iter = 45, cost = 11520, time = 70.963, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0054647, lr=0.01
[STATS][L2] iter = 46, cost = 11776, time = 72.607, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0055989, lr=0.01
[STATS][L2] iter = 47, cost = 12032, time = 74.243, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0057415, lr=0.01
[STATS][L2] iter = 48, cost = 12288, time = 75.792, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0059423, lr=0.01
[STATS][L2] iter = 49, cost = 12544, time = 77.354, size = (1, 32, 32, 1), loss = 0.0061124, loss1 = 0, loss2 = 0.0061124, lr=0.01
saving outstep 0 and iteration 49
[STATS][L3](First valid attack found!) iter = 49, cost = 12800, time = 77.354, size = (1, 32, 32, 1), loss = 0.0061103, loss1 = 0, loss2 = 0.0061103
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.523, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 1.6863e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.042, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 4.1269e-05, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.594, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 6.6785e-05, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.171, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00010371, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.743, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.0001555, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.298, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00021951, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.852, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00028271, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.382, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00034537, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 13.908, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00042848, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.436, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00052517, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 16.980, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.0006159, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.548, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00072284, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.129, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00081032, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.668, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00089861, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.240, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.0010277, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 24.788, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.0011499, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.341, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0012696, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 27.921, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0014114, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.470, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.001532, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 30.997, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0016557, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.641, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0017769, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.342, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0018859, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 35.882, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0020064, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.412, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0021544, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 38.942, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0022915, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 40.521, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0024525, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.034, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0026109, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 43.549, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0027714, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.089, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0029613, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 46.635, size = (1, 32, 32, 1), loss = 19.001, loss1 = 18.997, loss2 = 0.0031607, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 48.221, size = (1, 32, 32, 1), loss = 19.001, loss1 = 18.997, loss2 = 0.0033392, lr=0.01
[STATS][L2] iter = 32, cost = 8192, time = 49.868, size = (1, 32, 32, 1), loss = 19.001, loss1 = 18.997, loss2 = 0.0034868, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 51.395, size = (1, 32, 32, 1), loss = 19.001, loss1 = 18.997, loss2 = 0.0036487, lr=0.01
[STATS][L2] iter = 34, cost = 8704, time = 52.944, size = (1, 32, 32, 1), loss = 19.001, loss1 = 18.997, loss2 = 0.0038116, lr=0.01
[STATS][L2] iter = 35, cost = 8960, time = 54.505, size = (1, 32, 32, 1), loss = 19.001, loss1 = 18.997, loss2 = 0.0040386, lr=0.01
[STATS][L2] iter = 36, cost = 9216, time = 56.046, size = (1, 32, 32, 1), loss = 19.002, loss1 = 18.997, loss2 = 0.0041911, lr=0.01
[STATS][L2] iter = 37, cost = 9472, time = 57.582, size = (1, 32, 32, 1), loss = 9.8731, loss1 = 9.8688, loss2 = 0.0043372, lr=0.01
[STATS][L2] iter = 38, cost = 9728, time = 59.125, size = (1, 32, 32, 1), loss = 9.8733, loss1 = 9.8688, loss2 = 0.0045261, lr=0.01
[STATS][L2] iter = 39, cost = 9984, time = 60.676, size = (1, 32, 32, 1), loss = 9.8734, loss1 = 9.8688, loss2 = 0.0046804, lr=0.01
[STATS][L2] iter = 40, cost = 10240, time = 62.276, size = (1, 32, 32, 1), loss = 9.8737, loss1 = 9.8688, loss2 = 0.0048933, lr=0.01
[STATS][L2] iter = 41, cost = 10496, time = 63.819, size = (1, 32, 32, 1), loss = 9.8739, loss1 = 9.8688, loss2 = 0.0050847, lr=0.01
[STATS][L2] iter = 42, cost = 10752, time = 65.385, size = (1, 32, 32, 1), loss = 9.874, loss1 = 9.8688, loss2 = 0.0052658, lr=0.01
[STATS][L2] iter = 43, cost = 11008, time = 66.941, size = (1, 32, 32, 1), loss = 9.8743, loss1 = 9.8688, loss2 = 0.00551, lr=0.01
[STATS][L2] iter = 44, cost = 11264, time = 68.475, size = (1, 32, 32, 1), loss = 9.8745, loss1 = 9.8688, loss2 = 0.0057405, lr=0.01
[STATS][L2] iter = 45, cost = 11520, time = 70.026, size = (1, 32, 32, 1), loss = 9.8747, loss1 = 9.8688, loss2 = 0.0059439, lr=0.01
[STATS][L2] iter = 46, cost = 11776, time = 71.569, size = (1, 32, 32, 1), loss = 9.8749, loss1 = 9.8688, loss2 = 0.0061641, lr=0.01
[STATS][L2] iter = 47, cost = 12032, time = 73.343, size = (1, 32, 32, 1), loss = 9.8751, loss1 = 9.8688, loss2 = 0.0063746, lr=0.01
[STATS][L2] iter = 48, cost = 12288, time = 74.886, size = (1, 32, 32, 1), loss = 9.8754, loss1 = 9.8688, loss2 = 0.0066161, lr=0.01
[STATS][L2] iter = 49, cost = 12544, time = 76.497, size = (1, 32, 32, 1), loss = 9.8756, loss1 = 9.8688, loss2 = 0.0068085, lr=0.01
[STATS][L2] iter = 50, cost = 12800, time = 78.022, size = (1, 32, 32, 1), loss = 9.8758, loss1 = 9.8688, loss2 = 0.0070456, lr=0.01
[STATS][L2] iter = 51, cost = 13056, time = 79.554, size = (1, 32, 32, 1), loss = 0.0072606, loss1 = 0, loss2 = 0.0072606, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 51, cost = 13312, time = 79.554, size = (1, 32, 32, 1), loss = 0.0072576, loss1 = 0, loss2 = 0.0072576
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  7.362931305672832
l2_distortion between inputs and adv_current  7.362931305672832
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.006112724
perceptual metrics distance between adv_current and img 0.006112724
normalized perceptual metrics distance between adv and img 2.1224736378321217e-05
normalized perceptual metrics distance between adv_current and img 2.1224736378321217e-05
perceptual hash difference is  10
Saving to id3_differ10_True_l27.36_pdistance0.0061127240769565105
[STATS][L1] total = 4, id = 3, time = 161.345, success = True, const = 100.000000, hash_avg=10.00000, distortion = 7.36293, success_rate = 0.750, l2_avg=5.55404, p_avg=0.007888504730847975, iteration_avg=49.666666666666664
ica:0/task:0/device:GPU:0
overall average l2  5.5540440965239855
overal average perceptual distance  0.007888504730847975
overal average iterations  49.666666666666664
for image id  4
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.551, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 8.493e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.078, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00019653, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.663, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00033648, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.247, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00047513, lr=0.01
saving outstep 0 and iteration 4
[STATS][L2] iter = 5, cost = 1280, time = 7.846, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00067614, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.402, size = (1, 32, 32, 1), loss = 66.405, loss1 = 66.404, loss2 = 0.00087796, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.930, size = (1, 32, 32, 1), loss = 66.405, loss1 = 66.404, loss2 = 0.0011532, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.451, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.0013865, lr=0.01
saving outstep 0 and iteration 8
[STATS][L2] iter = 9, cost = 2304, time = 13.997, size = (1, 32, 32, 1), loss = 53.707, loss1 = 53.705, loss2 = 0.0015883, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.520, size = (1, 32, 32, 1), loss = 53.707, loss1 = 53.705, loss2 = 0.0018339, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.047, size = (1, 32, 32, 1), loss = 53.707, loss1 = 53.705, loss2 = 0.0021186, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.591, size = (1, 32, 32, 1), loss = 53.707, loss1 = 53.705, loss2 = 0.0023664, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.140, size = (1, 32, 32, 1), loss = 53.708, loss1 = 53.705, loss2 = 0.0027282, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.718, size = (1, 32, 32, 1), loss = 53.708, loss1 = 53.705, loss2 = 0.0030896, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.240, size = (1, 32, 32, 1), loss = 53.708, loss1 = 53.705, loss2 = 0.003454, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 24.791, size = (1, 32, 32, 1), loss = 37.999, loss1 = 37.995, loss2 = 0.0037259, lr=0.01
saving outstep 0 and iteration 16
[STATS][L2] iter = 17, cost = 4352, time = 26.345, size = (1, 32, 32, 1), loss = 37.999, loss1 = 37.995, loss2 = 0.0040938, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 27.901, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0044038, lr=0.01
saving outstep 0 and iteration 18
[STATS][L2] iter = 19, cost = 4864, time = 29.433, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.004786, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 30.959, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.005048, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.508, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0053711, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.081, size = (1, 32, 32, 1), loss = 0.00579, loss1 = 0, loss2 = 0.00579, lr=0.01
saving outstep 0 and iteration 22
[STATS][L3](First valid attack found!) iter = 22, cost = 5888, time = 34.081, size = (1, 32, 32, 1), loss = 0.005788, loss1 = 0, loss2 = 0.005788
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.574, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 9.6847e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.101, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0.00020191, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.688, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0.0003662, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.220, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00054882, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.760, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.00072077, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.282, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.00090764, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.816, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.001105, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.397, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.0012866, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.033, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.0015548, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.563, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.0018749, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.226, size = (1, 32, 32, 1), loss = 26.855, loss1 = 26.852, loss2 = 0.0021671, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.765, size = (1, 32, 32, 1), loss = 26.855, loss1 = 26.852, loss2 = 0.0024791, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.339, size = (1, 32, 32, 1), loss = 26.855, loss1 = 26.852, loss2 = 0.0027214, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.927, size = (1, 32, 32, 1), loss = 26.856, loss1 = 26.852, loss2 = 0.0031072, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.452, size = (1, 32, 32, 1), loss = 19.001, loss1 = 18.997, loss2 = 0.0033964, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 24.996, size = (1, 32, 32, 1), loss = 19.001, loss1 = 18.997, loss2 = 0.0035827, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.575, size = (1, 32, 32, 1), loss = 19.001, loss1 = 18.997, loss2 = 0.0038428, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.238, size = (1, 32, 32, 1), loss = 19.002, loss1 = 18.997, loss2 = 0.0041452, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.845, size = (1, 32, 32, 1), loss = 19.002, loss1 = 18.997, loss2 = 0.004452, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.411, size = (1, 32, 32, 1), loss = 0.004845, loss1 = 0, loss2 = 0.004845, lr=0.01
saving outstep 1 and iteration 20
[STATS][L3](Attack found!) iter = 20, cost = 5376, time = 31.411, size = (1, 32, 32, 1), loss = 0.0048459, loss1 = 0, loss2 = 0.0048459
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  4.415514542339608
l2_distortion between inputs and adv_current  4.415514542339608
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.004844766
perceptual metrics distance between adv_current and img 0.004844766
normalized perceptual metrics distance between adv and img 1.682210454924239e-05
normalized perceptual metrics distance between adv_current and img 1.682210454924239e-05
perceptual hash difference is  10
Saving to id4_differ10_True_l24.42_pdistance0.0048447661101818085
[STATS][L1] total = 5, id = 4, time = 69.410, success = True, const = 50.000000, hash_avg=10.00000, distortion = 4.41551, success_rate = 0.800, l2_avg=5.26941, p_avg=0.007127570075681433, iteration_avg=43.0
e:GPU:0
overall average l2  5.269411707977891
overal average perceptual distance  0.007127570075681433
overal average iterations  43.0
for image id  5
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.529, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 8.321e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.234, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00021228, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.795, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00039835, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.355, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00068197, lr=0.01
saving outstep 0 and iteration 4
[STATS][L2] iter = 5, cost = 1280, time = 7.934, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00097138, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.474, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0013774, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.065, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0016998, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.597, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0021832, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.158, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0026114, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.682, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0028185, lr=0.01
saving outstep 0 and iteration 10
[STATS][L2] iter = 11, cost = 2816, time = 17.245, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0032388, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.807, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0034757, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.539, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0039127, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.086, size = (1, 32, 32, 1), loss = 0.0044161, loss1 = 0, loss2 = 0.0044161, lr=0.01
saving outstep 0 and iteration 14
[STATS][L3](First valid attack found!) iter = 14, cost = 3840, time = 22.086, size = (1, 32, 32, 1), loss = 0.004416, loss1 = 0, loss2 = 0.004416
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.560, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 7.9554e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.125, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00021987, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.645, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00045775, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.165, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00073838, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.693, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0011193, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.283, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.001459, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.849, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0018964, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.383, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0022192, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 13.929, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0025653, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.522, size = (1, 32, 32, 1), loss = 9.8719, loss1 = 9.8688, loss2 = 0.0031258, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.120, size = (1, 32, 32, 1), loss = 9.8724, loss1 = 9.8688, loss2 = 0.0036573, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.645, size = (1, 32, 32, 1), loss = 9.8731, loss1 = 9.8688, loss2 = 0.0043047, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.174, size = (1, 32, 32, 1), loss = 9.8737, loss1 = 9.8688, loss2 = 0.0049571, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.771, size = (1, 32, 32, 1), loss = 9.8742, loss1 = 9.8688, loss2 = 0.0054289, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.317, size = (1, 32, 32, 1), loss = 9.8748, loss1 = 9.8688, loss2 = 0.0059978, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 24.869, size = (1, 32, 32, 1), loss = 9.8753, loss1 = 9.8688, loss2 = 0.0065825, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.508, size = (1, 32, 32, 1), loss = 0.007279, loss1 = 0, loss2 = 0.007279, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 17, cost = 4608, time = 26.508, size = (1, 32, 32, 1), loss = 0.0072798, loss1 = 0, loss2 = 0.0072798
b:localhost/replica:0/task:0/device:GPU:0
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  3.5562747199676057
l2_distortion between inputs and adv_current  3.5562747199676057
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.004415678
perceptual metrics distance between adv_current and img 0.004415678
normalized perceptual metrics distance between adv and img 1.53322147929834e-05
normalized perceptual metrics distance between adv_current and img 1.53322147929834e-05
perceptual hash difference is  10
Saving to id5_differ10_True_l23.56_pdistance0.004415677860379219
[STATS][L1] total = 6, id = 5, time = 52.411, success = True, const = 100.000000, hash_avg=10.00000, distortion = 3.55627, success_rate = 0.833, l2_avg=4.92678, p_avg=0.00658519163262099, iteration_avg=37.4
calhost/replica:0/task:0/device:GPU:0
overall average l2  4.926784310375834
overal average perceptual distance  0.00658519163262099
overal average iterations  37.4
for image id  6
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.523, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 5.9916e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.052, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00014629, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.608, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00022427, lr=0.01
saving outstep 0 and iteration 3
[STATS][L2] iter = 4, cost = 1024, time = 6.264, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00034119, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.828, size = (1, 32, 32, 1), loss = 37.995, loss1 = 37.995, loss2 = 0.0004714, lr=0.01
saving outstep 0 and iteration 5
[STATS][L2] iter = 6, cost = 1536, time = 9.524, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0006082, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.058, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00075527, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.634, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00089674, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.171, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0010966, lr=0.01
saving outstep 0 and iteration 9
[STATS][L2] iter = 10, cost = 2560, time = 15.802, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.001287, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.387, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0014272, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.966, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0016198, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.535, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0018396, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.148, size = (1, 32, 32, 1), loss = 0.0020638, loss1 = 0, loss2 = 0.0020638, lr=0.01
saving outstep 0 and iteration 14
[STATS][L3](First valid attack found!) iter = 14, cost = 3840, time = 22.148, size = (1, 32, 32, 1), loss = 0.0020631, loss1 = 0, loss2 = 0.0020631
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.617, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 6.4835e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.180, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00013678, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.746, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00024055, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.299, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00038907, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.810, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00053496, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.346, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00068322, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.053, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00086182, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.923, size = (1, 32, 32, 1), loss = 9.8698, loss1 = 9.8688, loss2 = 0.0010597, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.465, size = (1, 32, 32, 1), loss = 9.87, loss1 = 9.8688, loss2 = 0.0012702, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 16.008, size = (1, 32, 32, 1), loss = 9.8703, loss1 = 9.8688, loss2 = 0.0014835, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.549, size = (1, 32, 32, 1), loss = 9.8705, loss1 = 9.8688, loss2 = 0.0017025, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 19.116, size = (1, 32, 32, 1), loss = 9.8707, loss1 = 9.8688, loss2 = 0.0019448, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.664, size = (1, 32, 32, 1), loss = 9.8709, loss1 = 9.8688, loss2 = 0.0021547, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.208, size = (1, 32, 32, 1), loss = 9.8712, loss1 = 9.8688, loss2 = 0.0023973, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.753, size = (1, 32, 32, 1), loss = 9.8714, loss1 = 9.8688, loss2 = 0.0026635, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.310, size = (1, 32, 32, 1), loss = 9.8717, loss1 = 9.8688, loss2 = 0.0029166, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.903, size = (1, 32, 32, 1), loss = 0.0031696, loss1 = 0, loss2 = 0.0031696, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 17, cost = 4608, time = 26.903, size = (1, 32, 32, 1), loss = 0.0031733, loss1 = 0, loss2 = 0.0031733
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  3.0636207262581636
l2_distortion between inputs and adv_current  3.0636207262581636
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0020636262
perceptual metrics distance between adv_current and img 0.0020636262
normalized perceptual metrics distance between adv and img 7.165368717525982e-06
normalized perceptual metrics distance between adv_current and img 7.165368717525982e-06
perceptual hash difference is  10
Saving to id6_differ10_True_l23.06_pdistance0.002063626190647483
[STATS][L1] total = 7, id = 6, time = 53.013, success = True, const = 100.000000, hash_avg=10.00000, distortion = 3.06362, success_rate = 0.857, l2_avg=4.61626, p_avg=0.005831597392292072, iteration_avg=33.666666666666664
0
imoverall average hash  10.0
overall average l2  4.616257046356222
overal average perceptual distance  0.005831597392292072
overal average iterations  33.666666666666664
for image id  7
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.624, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 3.9611e-05, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.166, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 9.4454e-05, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.703, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00016301, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.264, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00024761, lr=0.01
saving outstep 0 and iteration 4
[STATS][L2] iter = 5, cost = 1280, time = 7.830, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00032796, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.446, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00042224, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.982, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00054779, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.528, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00065838, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.064, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00076637, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.619, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00087787, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.218, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0010012, lr=0.01
saving outstep 0 and iteration 11
[STATS][L2] iter = 12, cost = 3072, time = 18.793, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0011495, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.350, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0012772, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.903, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0014456, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.484, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0016437, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.048, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0017999, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.610, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0019886, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.158, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0021421, lr=0.01
saving outstep 0 and iteration 18
[STATS][L2] iter = 19, cost = 4864, time = 29.693, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0023435, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.230, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0025525, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.767, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0027397, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.331, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0029608, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 35.919, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0031499, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.536, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0033458, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 39.120, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0035733, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 40.642, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0037667, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.170, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0040092, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 43.704, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0042067, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.270, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0044379, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 46.808, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0046351, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 48.390, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0048491, lr=0.01
[STATS][L2] iter = 32, cost = 8192, time = 49.971, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0050916, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 51.579, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0052778, lr=0.01
[STATS][L2] iter = 34, cost = 8704, time = 53.169, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0054769, lr=0.01
[STATS][L2] iter = 35, cost = 8960, time = 54.735, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0056691, lr=0.01
[STATS][L2] iter = 36, cost = 9216, time = 56.285, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0058804, lr=0.01
[STATS][L2] iter = 37, cost = 9472, time = 57.818, size = (1, 32, 32, 1), loss = 19.744, loss1 = 19.738, loss2 = 0.0061138, lr=0.01
[STATS][L2] iter = 38, cost = 9728, time = 59.385, size = (1, 32, 32, 1), loss = 19.744, loss1 = 19.738, loss2 = 0.0063555, lr=0.01
[STATS][L2] iter = 39, cost = 9984, time = 61.014, size = (1, 32, 32, 1), loss = 19.744, loss1 = 19.738, loss2 = 0.0065301, lr=0.01
[STATS][L2] iter = 40, cost = 10240, time = 62.611, size = (1, 32, 32, 1), loss = 19.744, loss1 = 19.738, loss2 = 0.0067042, lr=0.01
[STATS][L2] iter = 41, cost = 10496, time = 64.188, size = (1, 32, 32, 1), loss = 19.744, loss1 = 19.738, loss2 = 0.0068876, lr=0.01
[STATS][L2] iter = 42, cost = 10752, time = 65.731, size = (1, 32, 32, 1), loss = 19.745, loss1 = 19.738, loss2 = 0.0070565, lr=0.01
[STATS][L2] iter = 43, cost = 11008, time = 67.342, size = (1, 32, 32, 1), loss = 19.745, loss1 = 19.738, loss2 = 0.0072278, lr=0.01
[STATS][L2] iter = 44, cost = 11264, time = 69.144, size = (1, 32, 32, 1), loss = 19.745, loss1 = 19.738, loss2 = 0.0073832, lr=0.01
[STATS][L2] iter = 45, cost = 11520, time = 70.719, size = (1, 32, 32, 1), loss = 19.745, loss1 = 19.738, loss2 = 0.0075758, lr=0.01
[STATS][L2] iter = 46, cost = 11776, time = 72.262, size = (1, 32, 32, 1), loss = 19.745, loss1 = 19.738, loss2 = 0.0077574, lr=0.01
[STATS][L2] iter = 47, cost = 12032, time = 73.855, size = (1, 32, 32, 1), loss = 19.745, loss1 = 19.738, loss2 = 0.0079151, lr=0.01
[STATS][L2] iter = 48, cost = 12288, time = 75.388, size = (1, 32, 32, 1), loss = 19.746, loss1 = 19.738, loss2 = 0.0080502, lr=0.01
[STATS][L2] iter = 49, cost = 12544, time = 76.979, size = (1, 32, 32, 1), loss = 19.746, loss1 = 19.738, loss2 = 0.0082102, lr=0.01
[STATS][L2] iter = 50, cost = 12800, time = 78.552, size = (1, 32, 32, 1), loss = 0.0083514, loss1 = 0, loss2 = 0.0083514, lr=0.01
saving outstep 0 and iteration 50
[STATS][L3](First valid attack found!) iter = 50, cost = 13056, time = 78.552, size = (1, 32, 32, 1), loss = 0.0083519, loss1 = 0, loss2 = 0.0083519
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.558, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 3.6905e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.095, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 8.2412e-05, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.669, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00016077, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.196, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00024556, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.724, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00033318, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.255, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00043674, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.843, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00055224, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.506, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00065654, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.105, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.0007694, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.670, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00087503, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.242, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.0010006, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.792, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0011356, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.371, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0012561, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.907, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0014087, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.450, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0015665, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.044, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0017463, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.593, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.00192, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.167, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0020676, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.720, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0022735, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.288, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.00245, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.832, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0026416, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.373, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0028219, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 35.921, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0030136, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.452, size = (1, 32, 32, 1), loss = 19.001, loss1 = 18.997, loss2 = 0.0031954, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 39.017, size = (1, 32, 32, 1), loss = 19.001, loss1 = 18.997, loss2 = 0.0033921, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 40.588, size = (1, 32, 32, 1), loss = 19.001, loss1 = 18.997, loss2 = 0.0035899, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.149, size = (1, 32, 32, 1), loss = 19.001, loss1 = 18.997, loss2 = 0.0038031, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 43.695, size = (1, 32, 32, 1), loss = 9.8727, loss1 = 9.8688, loss2 = 0.0039781, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.239, size = (1, 32, 32, 1), loss = 9.873, loss1 = 9.8688, loss2 = 0.0041994, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 46.780, size = (1, 32, 32, 1), loss = 9.8732, loss1 = 9.8688, loss2 = 0.0044009, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 48.318, size = (1, 32, 32, 1), loss = 9.8734, loss1 = 9.8688, loss2 = 0.0046073, lr=0.01
[STATS][L2] iter = 32, cost = 8192, time = 49.888, size = (1, 32, 32, 1), loss = 9.8736, loss1 = 9.8688, loss2 = 0.0047972, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 51.465, size = (1, 32, 32, 1), loss = 9.8738, loss1 = 9.8688, loss2 = 0.0050032, lr=0.01
[STATS][L2] iter = 34, cost = 8704, time = 53.030, size = (1, 32, 32, 1), loss = 9.8739, loss1 = 9.8688, loss2 = 0.0051796, lr=0.01
[STATS][L2] iter = 35, cost = 8960, time = 54.598, size = (1, 32, 32, 1), loss = 9.8741, loss1 = 9.8688, loss2 = 0.0053613, lr=0.01
[STATS][L2] iter = 36, cost = 9216, time = 56.211, size = (1, 32, 32, 1), loss = 9.8743, loss1 = 9.8688, loss2 = 0.0055172, lr=0.01
[STATS][L2] iter = 37, cost = 9472, time = 57.738, size = (1, 32, 32, 1), loss = 9.8745, loss1 = 9.8688, loss2 = 0.0057625, lr=0.01
[STATS][L2] iter = 38, cost = 9728, time = 59.297, size = (1, 32, 32, 1), loss = 9.8747, loss1 = 9.8688, loss2 = 0.0059368, lr=0.01
[STATS][L2] iter = 39, cost = 9984, time = 60.825, size = (1, 32, 32, 1), loss = 9.8749, loss1 = 9.8688, loss2 = 0.0061603, lr=0.01
[STATS][L2] iter = 40, cost = 10240, time = 62.363, size = (1, 32, 32, 1), loss = 9.8751, loss1 = 9.8688, loss2 = 0.0063537, lr=0.01
[STATS][L2] iter = 41, cost = 10496, time = 63.909, size = (1, 32, 32, 1), loss = 9.8753, loss1 = 9.8688, loss2 = 0.0065544, lr=0.01
[STATS][L2] iter = 42, cost = 10752, time = 65.497, size = (1, 32, 32, 1), loss = 9.8755, loss1 = 9.8688, loss2 = 0.0067159, lr=0.01
[STATS][L2] iter = 43, cost = 11008, time = 67.060, size = (1, 32, 32, 1), loss = 9.8757, loss1 = 9.8688, loss2 = 0.0069, lr=0.01
[STATS][L2] iter = 44, cost = 11264, time = 68.715, size = (1, 32, 32, 1), loss = 9.8759, loss1 = 9.8688, loss2 = 0.0071075, lr=0.01
[STATS][L2] iter = 45, cost = 11520, time = 70.262, size = (1, 32, 32, 1), loss = 9.8761, loss1 = 9.8688, loss2 = 0.0073023, lr=0.01
[STATS][L2] iter = 46, cost = 11776, time = 71.814, size = (1, 32, 32, 1), loss = 9.8763, loss1 = 9.8688, loss2 = 0.0075404, lr=0.01
[STATS][L2] iter = 47, cost = 12032, time = 73.345, size = (1, 32, 32, 1), loss = 9.8765, loss1 = 9.8688, loss2 = 0.0077626, lr=0.01
[STATS][L2] iter = 48, cost = 12288, time = 74.880, size = (1, 32, 32, 1), loss = 9.8767, loss1 = 9.8688, loss2 = 0.0079204, lr=0.01
[STATS][L2] iter = 49, cost = 12544, time = 76.402, size = (1, 32, 32, 1), loss = 0.0081092, loss1 = 0, loss2 = 0.0081092, lr=0.01
saving outstep 1 and iteration 49
[STATS][L3](Attack found!) iter = 49, cost = 12800, time = 76.402, size = (1, 32, 32, 1), loss = 0.0081094, loss1 = 0, loss2 = 0.0081094
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  7.2513944331456734
l2_distortion between inputs and adv_current  7.2513944331456734
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.00810954
perceptual metrics distance between adv_current and img 0.00810954
normalized perceptual metrics distance between adv and img 2.815812412235472e-05
normalized perceptual metrics distance between adv_current and img 2.815812412235472e-05
perceptual hash difference is  10
Saving to id7_differ10_True_l27.25_pdistance0.00810953974723816
[STATS][L1] total = 8, id = 7, time = 159.498, success = True, const = 50.000000, hash_avg=10.00000, distortion = 7.25139, success_rate = 0.875, l2_avg=4.99271, p_avg=0.006157017728712942, iteration_avg=36.142857142857146
overall average l2  4.992705244469001
overal average perceptual distance  0.006157017728712942
overal average iterations  36.142857142857146
for image id  8
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.537, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00024556, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.118, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00072401, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.832, size = (1, 32, 32, 1), loss = 66.405, loss1 = 66.404, loss2 = 0.0011258, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.365, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.0015173, lr=0.01
saving outstep 0 and iteration 4
[STATS][L2] iter = 5, cost = 1280, time = 7.892, size = (1, 32, 32, 1), loss = 53.707, loss1 = 53.705, loss2 = 0.0020873, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.418, size = (1, 32, 32, 1), loss = 53.707, loss1 = 53.705, loss2 = 0.0024697, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.941, size = (1, 32, 32, 1), loss = 53.709, loss1 = 53.705, loss2 = 0.0035699, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.468, size = (1, 32, 32, 1), loss = 53.709, loss1 = 53.705, loss2 = 0.004513, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.070, size = (1, 32, 32, 1), loss = 53.711, loss1 = 53.705, loss2 = 0.0056218, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.663, size = (1, 32, 32, 1), loss = 53.711, loss1 = 53.705, loss2 = 0.0065192, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.216, size = (1, 32, 32, 1), loss = 53.713, loss1 = 53.705, loss2 = 0.0076083, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.750, size = (1, 32, 32, 1), loss = 53.714, loss1 = 53.705, loss2 = 0.0085451, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.281, size = (1, 32, 32, 1), loss = 53.715, loss1 = 53.705, loss2 = 0.010146, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.817, size = (1, 32, 32, 1), loss = 38.006, loss1 = 37.995, loss2 = 0.011157, lr=0.01
saving outstep 0 and iteration 14
[STATS][L2] iter = 15, cost = 3840, time = 23.348, size = (1, 32, 32, 1), loss = 38.007, loss1 = 37.995, loss2 = 0.01258, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 24.862, size = (1, 32, 32, 1), loss = 38.008, loss1 = 37.995, loss2 = 0.013571, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.452, size = (1, 32, 32, 1), loss = 38.01, loss1 = 37.995, loss2 = 0.015256, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.014, size = (1, 32, 32, 1), loss = 38.012, loss1 = 37.995, loss2 = 0.016754, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.598, size = (1, 32, 32, 1), loss = 38.013, loss1 = 37.995, loss2 = 0.018382, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.141, size = (1, 32, 32, 1), loss = 38.015, loss1 = 37.995, loss2 = 0.020064, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.670, size = (1, 32, 32, 1), loss = 38.016, loss1 = 37.995, loss2 = 0.021531, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.261, size = (1, 32, 32, 1), loss = 38.017, loss1 = 37.995, loss2 = 0.022264, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 35.799, size = (1, 32, 32, 1), loss = 38.018, loss1 = 37.995, loss2 = 0.023085, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.405, size = (1, 32, 32, 1), loss = 38.019, loss1 = 37.995, loss2 = 0.024464, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 38.936, size = (1, 32, 32, 1), loss = 19.763, loss1 = 19.738, loss2 = 0.025254, lr=0.01
saving outstep 0 and iteration 25
[STATS][L2] iter = 26, cost = 6656, time = 40.465, size = (1, 32, 32, 1), loss = 19.764, loss1 = 19.738, loss2 = 0.026289, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.006, size = (1, 32, 32, 1), loss = 19.765, loss1 = 19.738, loss2 = 0.027574, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 43.583, size = (1, 32, 32, 1), loss = 19.766, loss1 = 19.738, loss2 = 0.02833, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.165, size = (1, 32, 32, 1), loss = 19.766, loss1 = 19.738, loss2 = 0.028864, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 46.727, size = (1, 32, 32, 1), loss = 19.768, loss1 = 19.738, loss2 = 0.030104, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 48.320, size = (1, 32, 32, 1), loss = 19.769, loss1 = 19.738, loss2 = 0.031773, lr=0.01
[STATS][L2] iter = 32, cost = 8192, time = 49.867, size = (1, 32, 32, 1), loss = 19.77, loss1 = 19.738, loss2 = 0.032279, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 51.404, size = (1, 32, 32, 1), loss = 19.771, loss1 = 19.738, loss2 = 0.033235, lr=0.01
[STATS][L2] iter = 34, cost = 8704, time = 52.920, size = (1, 32, 32, 1), loss = 19.772, loss1 = 19.738, loss2 = 0.034224, lr=0.01
[STATS][L2] iter = 35, cost = 8960, time = 54.457, size = (1, 32, 32, 1), loss = 19.773, loss1 = 19.738, loss2 = 0.035362, lr=0.01
[STATS][L2] iter = 36, cost = 9216, time = 56.056, size = (1, 32, 32, 1), loss = 19.774, loss1 = 19.738, loss2 = 0.036393, lr=0.01
[STATS][L2] iter = 37, cost = 9472, time = 57.653, size = (1, 32, 32, 1), loss = 19.775, loss1 = 19.738, loss2 = 0.037126, lr=0.01
[STATS][L2] iter = 38, cost = 9728, time = 59.306, size = (1, 32, 32, 1), loss = 19.776, loss1 = 19.738, loss2 = 0.038051, lr=0.01
[STATS][L2] iter = 39, cost = 9984, time = 60.880, size = (1, 32, 32, 1), loss = 19.776, loss1 = 19.738, loss2 = 0.038752, lr=0.01
[STATS][L2] iter = 40, cost = 10240, time = 62.486, size = (1, 32, 32, 1), loss = 19.777, loss1 = 19.738, loss2 = 0.039644, lr=0.01
[STATS][L2] iter = 41, cost = 10496, time = 64.014, size = (1, 32, 32, 1), loss = 0.040097, loss1 = 0, loss2 = 0.040097, lr=0.01
saving outstep 0 and iteration 41
[STATS][L3](First valid attack found!) iter = 41, cost = 10752, time = 64.014, size = (1, 32, 32, 1), loss = 0.0401, loss1 = 0, loss2 = 0.0401
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.537, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00019372, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.137, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00061832, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.738, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.0012746, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.292, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.0019135, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.893, size = (1, 32, 32, 1), loss = 26.855, loss1 = 26.852, loss2 = 0.0024232, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.445, size = (1, 32, 32, 1), loss = 26.855, loss1 = 26.852, loss2 = 0.0030074, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.985, size = (1, 32, 32, 1), loss = 26.856, loss1 = 26.852, loss2 = 0.0035352, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.520, size = (1, 32, 32, 1), loss = 26.857, loss1 = 26.852, loss2 = 0.0046533, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.050, size = (1, 32, 32, 1), loss = 26.858, loss1 = 26.852, loss2 = 0.005372, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.605, size = (1, 32, 32, 1), loss = 26.859, loss1 = 26.852, loss2 = 0.0064539, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.156, size = (1, 32, 32, 1), loss = 26.86, loss1 = 26.852, loss2 = 0.0078551, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.716, size = (1, 32, 32, 1), loss = 26.862, loss1 = 26.852, loss2 = 0.0090377, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.313, size = (1, 32, 32, 1), loss = 26.863, loss1 = 26.852, loss2 = 0.010295, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.922, size = (1, 32, 32, 1), loss = 19.009, loss1 = 18.997, loss2 = 0.011335, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.505, size = (1, 32, 32, 1), loss = 19.01, loss1 = 18.997, loss2 = 0.01276, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.030, size = (1, 32, 32, 1), loss = 19.012, loss1 = 18.997, loss2 = 0.014248, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.632, size = (1, 32, 32, 1), loss = 19.013, loss1 = 18.997, loss2 = 0.015473, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.145, size = (1, 32, 32, 1), loss = 19.014, loss1 = 18.997, loss2 = 0.016514, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.675, size = (1, 32, 32, 1), loss = 19.015, loss1 = 18.997, loss2 = 0.017707, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.265, size = (1, 32, 32, 1), loss = 19.016, loss1 = 18.997, loss2 = 0.018984, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.823, size = (1, 32, 32, 1), loss = 19.018, loss1 = 18.997, loss2 = 0.020334, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.381, size = (1, 32, 32, 1), loss = 19.019, loss1 = 18.997, loss2 = 0.021583, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 35.939, size = (1, 32, 32, 1), loss = 19.02, loss1 = 18.997, loss2 = 0.022824, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.546, size = (1, 32, 32, 1), loss = 19.021, loss1 = 18.997, loss2 = 0.023894, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 39.156, size = (1, 32, 32, 1), loss = 9.8938, loss1 = 9.8688, loss2 = 0.02504, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 40.758, size = (1, 32, 32, 1), loss = 9.895, loss1 = 9.8688, loss2 = 0.026199, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.485, size = (1, 32, 32, 1), loss = 9.8958, loss1 = 9.8688, loss2 = 0.026992, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 44.033, size = (1, 32, 32, 1), loss = 9.8958, loss1 = 9.8688, loss2 = 0.027032, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.556, size = (1, 32, 32, 1), loss = 9.8965, loss1 = 9.8688, loss2 = 0.027745, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 47.110, size = (1, 32, 32, 1), loss = 9.897, loss1 = 9.8688, loss2 = 0.028281, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 48.645, size = (1, 32, 32, 1), loss = 9.898, loss1 = 9.8688, loss2 = 0.029204, lr=0.01
[STATS][L2] iter = 32, cost = 8192, time = 50.184, size = (1, 32, 32, 1), loss = 9.899, loss1 = 9.8688, loss2 = 0.030225, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 51.738, size = (1, 32, 32, 1), loss = 9.8999, loss1 = 9.8688, loss2 = 0.031087, lr=0.01
[STATS][L2] iter = 34, cost = 8704, time = 53.313, size = (1, 32, 32, 1), loss = 9.9009, loss1 = 9.8688, loss2 = 0.032162, lr=0.01
[STATS][L2] iter = 35, cost = 8960, time = 54.887, size = (1, 32, 32, 1), loss = 9.9017, loss1 = 9.8688, loss2 = 0.032912, lr=0.01
[STATS][L2] iter = 36, cost = 9216, time = 56.435, size = (1, 32, 32, 1), loss = 9.9025, loss1 = 9.8688, loss2 = 0.033758, lr=0.01
[STATS][L2] iter = 37, cost = 9472, time = 57.956, size = (1, 32, 32, 1), loss = 9.904, loss1 = 9.8688, loss2 = 0.035202, lr=0.01
[STATS][L2] iter = 38, cost = 9728, time = 59.507, size = (1, 32, 32, 1), loss = 9.9048, loss1 = 9.8688, loss2 = 0.035989, lr=0.01
[STATS][L2] iter = 39, cost = 9984, time = 61.065, size = (1, 32, 32, 1), loss = 9.9049, loss1 = 9.8688, loss2 = 0.036182, lr=0.01
[STATS][L2] iter = 40, cost = 10240, time = 62.613, size = (1, 32, 32, 1), loss = 9.9054, loss1 = 9.8688, loss2 = 0.036597, lr=0.01
[STATS][L2] iter = 41, cost = 10496, time = 64.154, size = (1, 32, 32, 1), loss = 9.9059, loss1 = 9.8688, loss2 = 0.037112, lr=0.01
[STATS][L2] iter = 42, cost = 10752, time = 65.714, size = (1, 32, 32, 1), loss = 0.03757, loss1 = 0, loss2 = 0.03757, lr=0.01
saving outstep 1 and iteration 42
[STATS][L3](Attack found!) iter = 42, cost = 11008, time = 65.714, size = (1, 32, 32, 1), loss = 0.037573, loss1 = 0, loss2 = 0.037573
device:GPU:0
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  7.1947760709329955
l2_distortion between inputs and adv_current  7.1947760709329955
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.037570514
perceptual metrics distance between adv_current and img 0.037570514
normalized perceptual metrics distance between adv and img 0.00013045317286418544
normalized perceptual metrics distance between adv_current and img 0.00013045317286418544
perceptual hash difference is  10
Saving to id8_differ10_True_l27.19_pdistance0.037570513784885406
[STATS][L1] total = 9, id = 8, time = 134.217, success = True, const = 50.000000, hash_avg=10.00000, distortion = 7.19478, success_rate = 0.889, l2_avg=5.26796, p_avg=0.0100837047357345, iteration_avg=36.875
impoverall average hash  10.0
overall average l2  5.267964097777001
overal average perceptual distance  0.0100837047357345
overal average iterations  36.875
for image id  9
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.565, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 5.1776e-05, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.107, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.0001306, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.639, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00024031, lr=0.01
saving outstep 0 and iteration 3
[STATS][L2] iter = 4, cost = 1024, time = 6.197, size = (1, 32, 32, 1), loss = 37.995, loss1 = 37.995, loss2 = 0.00034165, lr=0.01
saving outstep 0 and iteration 4
[STATS][L2] iter = 5, cost = 1280, time = 7.729, size = (1, 32, 32, 1), loss = 37.995, loss1 = 37.995, loss2 = 0.00046222, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.282, size = (1, 32, 32, 1), loss = 37.995, loss1 = 37.995, loss2 = 0.00058241, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.882, size = (1, 32, 32, 1), loss = 19.738, loss1 = 19.738, loss2 = 0.00070755, lr=0.01
saving outstep 0 and iteration 7
[STATS][L2] iter = 8, cost = 2048, time = 12.547, size = (1, 32, 32, 1), loss = 0.0008593, loss1 = 0, loss2 = 0.0008593, lr=0.01
saving outstep 0 and iteration 8
[STATS][L3](First valid attack found!) iter = 8, cost = 2304, time = 12.547, size = (1, 32, 32, 1), loss = 0.00086057, loss1 = 0, loss2 = 0.00086057
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.598, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 5.9703e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.160, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00013329, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.724, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00024765, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.255, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00041249, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.796, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00054925, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.347, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00068818, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.918, size = (1, 32, 32, 1), loss = 9.8696, loss1 = 9.8688, loss2 = 0.00085814, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.511, size = (1, 32, 32, 1), loss = 0.001023, loss1 = 0, loss2 = 0.001023, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 8, cost = 2304, time = 12.511, size = (1, 32, 32, 1), loss = 0.0010234, loss1 = 0, loss2 = 0.0010234
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  2.272460210042232
l2_distortion between inputs and adv_current  2.272460210042232
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.00085922924
perceptual metrics distance between adv_current and img 0.00085922924
normalized perceptual metrics distance between adv and img 2.9834348727793745e-06
normalized perceptual metrics distance between adv_current and img 2.9834348727793745e-06
perceptual hash difference is  10
Saving to id9_differ10_True_l22.27_pdistance0.0008592292433604598
[STATS][L1] total = 10, id = 9, time = 28.939, success = True, const = 100.000000, hash_avg=10.00000, distortion = 2.27246, success_rate = 0.900, l2_avg=4.93513, p_avg=0.009058763014359606, iteration_avg=33.77777777777778
calhost/replica:0/task:0/device:GPU:0
overall average l2  4.935130332473138
overal average perceptual distance  0.009058763014359606
overal average iterations  33.77777777777778
for image id  10
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.550, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 6.098e-05, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.100, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00015595, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.624, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00031856, lr=0.01
saving outstep 0 and iteration 3
[STATS][L2] iter = 4, cost = 1024, time = 6.162, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.0005238, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.744, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00077108, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.340, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00095751, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.875, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.0011854, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.477, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.001426, lr=0.01
saving outstep 0 and iteration 8
[STATS][L2] iter = 9, cost = 2304, time = 14.011, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0017152, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.569, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.002058, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.096, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0024583, lr=0.01
saving outstep 0 and iteration 11
[STATS][L2] iter = 12, cost = 3072, time = 18.627, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0027138, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.180, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0029553, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.748, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0032733, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.390, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0036331, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 24.926, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0040546, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.448, size = (1, 32, 32, 1), loss = 0.0044411, loss1 = 0, loss2 = 0.0044411, lr=0.01
saving outstep 0 and iteration 17
[STATS][L3](First valid attack found!) iter = 17, cost = 4608, time = 26.448, size = (1, 32, 32, 1), loss = 0.0044413, loss1 = 0, loss2 = 0.0044413
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.547, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 5.5101e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.085, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00017212, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.810, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00033884, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.388, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00044374, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.972, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00062456, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.571, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00075529, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.153, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00093107, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.716, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0011562, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.270, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0014018, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.829, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0017286, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.370, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.002045, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.969, size = (1, 32, 32, 1), loss = 9.871, loss1 = 9.8688, loss2 = 0.0022222, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.577, size = (1, 32, 32, 1), loss = 9.8713, loss1 = 9.8688, loss2 = 0.002555, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.140, size = (1, 32, 32, 1), loss = 9.8716, loss1 = 9.8688, loss2 = 0.0028829, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.689, size = (1, 32, 32, 1), loss = 0.0032874, loss1 = 0, loss2 = 0.0032874, lr=0.01
saving outstep 1 and iteration 15
[STATS][L3](Attack found!) iter = 15, cost = 4096, time = 23.689, size = (1, 32, 32, 1), loss = 0.0032884, loss1 = 0, loss2 = 0.0032884
st/replica:0/task:0/device:GPU:0
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  3.3790514210899882
l2_distortion between inputs and adv_current  3.3790514210899882
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.003287122
perceptual metrics distance between adv_current and img 0.003287122
normalized perceptual metrics distance between adv and img 1.1413617661067596e-05
normalized perceptual metrics distance between adv_current and img 1.1413617661067596e-05
perceptual hash difference is  10
Saving to id10_differ10_True_l23.38_pdistance0.0032871218863874674
[STATS][L1] total = 11, id = 10, time = 54.128, success = True, const = 50.000000, hash_avg=10.00000, distortion = 3.37905, success_rate = 0.909, l2_avg=4.77952, p_avg=0.008481598901562392, iteration_avg=32.2
overall average l2  4.779522441334823
overal average perceptual distance  0.008481598901562392
overal average iterations  32.2
for image id  11
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.662, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00010422, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.212, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00023761, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.747, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00044227, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.325, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00062641, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.993, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00085667, lr=0.01
saving outstep 0 and iteration 5
[STATS][L2] iter = 6, cost = 1536, time = 9.621, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0010202, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.150, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0012585, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.721, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0015141, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.278, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0017942, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.796, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0021679, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.322, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0025468, lr=0.01
saving outstep 0 and iteration 11
[STATS][L2] iter = 12, cost = 3072, time = 18.931, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0029135, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.487, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0032781, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.051, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.003678, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.627, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0039913, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.165, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0043276, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.695, size = (1, 32, 32, 1), loss = 0.0048385, loss1 = 0, loss2 = 0.0048385, lr=0.01
saving outstep 0 and iteration 17
[STATS][L3](First valid attack found!) iter = 17, cost = 4608, time = 26.695, size = (1, 32, 32, 1), loss = 0.0048354, loss1 = 0, loss2 = 0.0048354
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.556, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00012139, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.093, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.000292, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.637, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00048291, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.224, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00067875, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.766, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00094514, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.297, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0012197, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.832, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0015081, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.366, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0018129, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 13.963, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0022066, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.500, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0026116, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.022, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0029886, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.531, size = (1, 32, 32, 1), loss = 9.8721, loss1 = 9.8688, loss2 = 0.0033626, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.080, size = (1, 32, 32, 1), loss = 9.8726, loss1 = 9.8688, loss2 = 0.0037848, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.656, size = (1, 32, 32, 1), loss = 9.873, loss1 = 9.8688, loss2 = 0.0042371, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.189, size = (1, 32, 32, 1), loss = 9.8735, loss1 = 9.8688, loss2 = 0.0047296, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 24.729, size = (1, 32, 32, 1), loss = 9.874, loss1 = 9.8688, loss2 = 0.0052297, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.273, size = (1, 32, 32, 1), loss = 0.0060389, loss1 = 0, loss2 = 0.0060389, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 17, cost = 4608, time = 26.273, size = (1, 32, 32, 1), loss = 0.006037, loss1 = 0, loss2 = 0.006037
ce:GPU:0
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  3.8947192551616103
l2_distortion between inputs and adv_current  3.8947192551616103
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0048381733
perceptual metrics distance between adv_current and img 0.0048381733
normalized perceptual metrics distance between adv and img 1.6799212769708698e-05
normalized perceptual metrics distance between adv_current and img 1.6799212769708698e-05
perceptual hash difference is  10
Saving to id11_differ10_True_l23.89_pdistance0.0048381732776761055
[STATS][L1] total = 12, id = 11, time = 57.027, success = True, const = 100.000000, hash_avg=10.00000, distortion = 3.89472, success_rate = 0.917, l2_avg=4.69909, p_avg=0.008150378390300002, iteration_avg=30.90909090909091
task:0/device:GPU:0
overall average l2  4.699085788046349
overal average perceptual distance  0.008150378390300002
overal average iterations  30.90909090909091
for image id  12
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.524, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00010177, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.094, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00024378, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.673, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00042122, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.415, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00070452, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.945, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00097313, lr=0.01
saving outstep 0 and iteration 5
[STATS][L2] iter = 6, cost = 1536, time = 9.493, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0012496, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.019, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0015938, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.561, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0019314, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.148, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0023234, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.710, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0028209, lr=0.01
saving outstep 0 and iteration 10
[STATS][L2] iter = 11, cost = 2816, time = 17.271, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.00327, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.818, size = (1, 32, 32, 1), loss = 0.0037865, loss1 = 0, loss2 = 0.0037865, lr=0.01
saving outstep 0 and iteration 12
[STATS][L3](First valid attack found!) iter = 12, cost = 3328, time = 18.818, size = (1, 32, 32, 1), loss = 0.0037856, loss1 = 0, loss2 = 0.0037856
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.569, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00013329, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.110, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00031768, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.676, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00050056, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.226, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.0007802, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.770, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0010737, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.341, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0013788, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.921, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0017408, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.493, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0021288, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.102, size = (1, 32, 32, 1), loss = 9.8712, loss1 = 9.8688, loss2 = 0.0024657, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.718, size = (1, 32, 32, 1), loss = 9.8715, loss1 = 9.8688, loss2 = 0.0027403, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.251, size = (1, 32, 32, 1), loss = 9.872, loss1 = 9.8688, loss2 = 0.0032477, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.854, size = (1, 32, 32, 1), loss = 0.0036812, loss1 = 0, loss2 = 0.0036812, lr=0.01
saving outstep 1 and iteration 12
[STATS][L3](Attack found!) iter = 12, cost = 3328, time = 18.854, size = (1, 32, 32, 1), loss = 0.0036815, loss1 = 0, loss2 = 0.0036815
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  2.9370935425613927
l2_distortion between inputs and adv_current  2.9370935425613927
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0036813868
perceptual metrics distance between adv_current and img 0.0036813868
normalized perceptual metrics distance between adv and img 1.2782593128374881e-05
normalized perceptual metrics distance between adv_current and img 1.2782593128374881e-05
perceptual hash difference is  12
Saving to id12_differ12_True_l22.94_pdistance0.003681386820971966
[STATS][L1] total = 13, id = 12, time = 41.603, success = True, const = 50.000000, hash_avg=10.16667, distortion = 2.93709, success_rate = 0.923, l2_avg=4.55225, p_avg=0.007777962426189333, iteration_avg=29.416666666666668
overall average l2  4.552253100922603
overal average perceptual distance  0.007777962426189333
overal average iterations  29.416666666666668
for image id  13
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.526, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00011473, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.144, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00026445, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.697, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00059039, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.346, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.0010729, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.920, size = (1, 32, 32, 1), loss = 53.707, loss1 = 53.705, loss2 = 0.0016111, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.507, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0020676, lr=0.01
saving outstep 0 and iteration 6
[STATS][L2] iter = 7, cost = 1792, time = 11.089, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0027238, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.611, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0034484, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.165, size = (1, 32, 32, 1), loss = 37.999, loss1 = 37.995, loss2 = 0.0045351, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.711, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0053189, lr=0.01
saving outstep 0 and iteration 10
[STATS][L2] iter = 11, cost = 2816, time = 17.258, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0058258, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.839, size = (1, 32, 32, 1), loss = 19.744, loss1 = 19.738, loss2 = 0.006723, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.422, size = (1, 32, 32, 1), loss = 0.0077057, loss1 = 0, loss2 = 0.0077057, lr=0.01
saving outstep 0 and iteration 13
[STATS][L3](First valid attack found!) iter = 13, cost = 3584, time = 20.422, size = (1, 32, 32, 1), loss = 0.007706, loss1 = 0, loss2 = 0.007706
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.514, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00011671, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.047, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00036401, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.568, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00071899, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.077, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.0010302, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.601, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.0016695, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.190, size = (1, 32, 32, 1), loss = 26.855, loss1 = 26.852, loss2 = 0.002317, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.796, size = (1, 32, 32, 1), loss = 19.001, loss1 = 18.997, loss2 = 0.0034668, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.358, size = (1, 32, 32, 1), loss = 19.002, loss1 = 18.997, loss2 = 0.0044995, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 13.911, size = (1, 32, 32, 1), loss = 19.003, loss1 = 18.997, loss2 = 0.0059917, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.487, size = (1, 32, 32, 1), loss = 19.005, loss1 = 18.997, loss2 = 0.007116, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.030, size = (1, 32, 32, 1), loss = 19.006, loss1 = 18.997, loss2 = 0.0083594, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.560, size = (1, 32, 32, 1), loss = 9.8786, loss1 = 9.8688, loss2 = 0.009831, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.090, size = (1, 32, 32, 1), loss = 0.011369, loss1 = 0, loss2 = 0.011369, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 13, cost = 3584, time = 20.090, size = (1, 32, 32, 1), loss = 0.011372, loss1 = 0, loss2 = 0.011372
lhost/replica:0/task:0/device:GPU:0
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  3.183078521748234
l2_distortion between inputs and adv_current  3.183078521748234
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.007705612
perceptual metrics distance between adv_current and img 0.007705612
normalized perceptual metrics distance between adv and img 2.6755597597608965e-05
normalized perceptual metrics distance between adv_current and img 2.6755597597608965e-05
perceptual hash difference is  10
Saving to id13_differ10_True_l23.18_pdistance0.0077056121081113815
[STATS][L1] total = 14, id = 13, time = 44.506, success = True, const = 100.000000, hash_avg=10.15385, distortion = 3.18308, success_rate = 0.929, l2_avg=4.44693, p_avg=0.007772397017106414, iteration_avg=28.23076923076923
b:localhost/replica:0/task:0/device:GPU:0
overall average l2  4.446931979447651
overal average perceptual distance  0.007772397017106414
overal average iterations  28.23076923076923
for image id  14
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.596, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00046585, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.188, size = (1, 32, 32, 1), loss = 66.405, loss1 = 66.404, loss2 = 0.0012384, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.745, size = (1, 32, 32, 1), loss = 53.708, loss1 = 53.705, loss2 = 0.0025418, lr=0.01
saving outstep 0 and iteration 3
[STATS][L2] iter = 4, cost = 1024, time = 6.302, size = (1, 32, 32, 1), loss = 37.999, loss1 = 37.995, loss2 = 0.004018, lr=0.01
saving outstep 0 and iteration 4
[STATS][L2] iter = 5, cost = 1280, time = 7.860, size = (1, 32, 32, 1), loss = 0.0067227, loss1 = 0, loss2 = 0.0067227, lr=0.01
saving outstep 0 and iteration 5
[STATS][L3](First valid attack found!) iter = 5, cost = 1536, time = 7.860, size = (1, 32, 32, 1), loss = 0.0067233, loss1 = 0, loss2 = 0.0067233
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.546, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00052208, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.382, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.0013187, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.961, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0027795, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.502, size = (1, 32, 32, 1), loss = 19.003, loss1 = 18.997, loss2 = 0.0053228, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 8.056, size = (1, 32, 32, 1), loss = 0.0084933, loss1 = 0, loss2 = 0.0084933, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 5, cost = 1536, time = 8.056, size = (1, 32, 32, 1), loss = 0.0084968, loss1 = 0, loss2 = 0.0084968
lica:0/task:0/device:GPU:0
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  1.6027304461848617
l2_distortion between inputs and adv_current  1.6027304461848617
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0067225914
perceptual metrics distance between adv_current and img 0.0067225914
normalized perceptual metrics distance between adv and img 2.334233108235316e-05
normalized perceptual metrics distance between adv_current and img 2.334233108235316e-05
perceptual hash difference is  10
Saving to id14_differ10_True_l21.60_pdistance0.0067225913517177105
[STATS][L1] total = 15, id = 14, time = 19.908, success = True, const = 100.000000, hash_avg=10.14286, distortion = 1.60273, success_rate = 0.933, l2_avg=4.24377, p_avg=0.007697410898150078, iteration_avg=26.642857142857142
overall average l2  4.243774727071738
overal average perceptual distance  0.007697410898150078
overal average iterations  26.642857142857142
for image id  15
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.535, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 4.3334e-05, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.081, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00011409, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.672, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00022498, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.252, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00033559, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.887, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00044994, lr=0.01
saving outstep 0 and iteration 5
[STATS][L2] iter = 6, cost = 1536, time = 9.444, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00068107, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.986, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00097184, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.541, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.0012593, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.094, size = (1, 32, 32, 1), loss = 53.707, loss1 = 53.705, loss2 = 0.0015795, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.675, size = (1, 32, 32, 1), loss = 53.707, loss1 = 53.705, loss2 = 0.002008, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.218, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0023343, lr=0.01
saving outstep 0 and iteration 11
[STATS][L2] iter = 12, cost = 3072, time = 18.793, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0027683, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.390, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0030355, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.003, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0034838, lr=0.01
saving outstep 0 and iteration 14
[STATS][L2] iter = 15, cost = 3840, time = 23.605, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0039894, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.137, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0043996, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.678, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0048198, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.214, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0053143, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.728, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0058599, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.316, size = (1, 32, 32, 1), loss = 19.744, loss1 = 19.738, loss2 = 0.0063452, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.894, size = (1, 32, 32, 1), loss = 0.0069473, loss1 = 0, loss2 = 0.0069473, lr=0.01
saving outstep 0 and iteration 21
[STATS][L3](First valid attack found!) iter = 21, cost = 5632, time = 32.894, size = (1, 32, 32, 1), loss = 0.0069485, loss1 = 0, loss2 = 0.0069485
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.603, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 5.0204e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.152, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00012701, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.700, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00021886, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.235, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00038375, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.773, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00057294, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.297, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00082088, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.933, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.0010896, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.528, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.0014173, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.102, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.001683, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.670, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0020762, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.215, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0025152, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.786, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0028877, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.323, size = (1, 32, 32, 1), loss = 19.001, loss1 = 18.997, loss2 = 0.0034555, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.870, size = (1, 32, 32, 1), loss = 19.001, loss1 = 18.997, loss2 = 0.0038215, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.417, size = (1, 32, 32, 1), loss = 9.8731, loss1 = 9.8688, loss2 = 0.0043621, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.055, size = (1, 32, 32, 1), loss = 9.8735, loss1 = 9.8688, loss2 = 0.0047003, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.631, size = (1, 32, 32, 1), loss = 9.874, loss1 = 9.8688, loss2 = 0.0051907, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.279, size = (1, 32, 32, 1), loss = 9.8743, loss1 = 9.8688, loss2 = 0.0054849, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.876, size = (1, 32, 32, 1), loss = 9.8746, loss1 = 9.8688, loss2 = 0.0058716, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.423, size = (1, 32, 32, 1), loss = 9.8749, loss1 = 9.8688, loss2 = 0.0061156, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.961, size = (1, 32, 32, 1), loss = 9.8753, loss1 = 9.8688, loss2 = 0.0064922, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.500, size = (1, 32, 32, 1), loss = 9.8757, loss1 = 9.8688, loss2 = 0.0069366, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 36.029, size = (1, 32, 32, 1), loss = 0.0075592, loss1 = 0, loss2 = 0.0075592, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 23, cost = 6144, time = 36.029, size = (1, 32, 32, 1), loss = 0.0075589, loss1 = 0, loss2 = 0.0075589
a:0/task:0/device:GPU:0
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  4.270958673529735
l2_distortion between inputs and adv_current  4.270958673529735
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.006947339
perceptual metrics distance between adv_current and img 0.006947339
normalized perceptual metrics distance between adv and img 2.4122705023425322e-05
normalized perceptual metrics distance between adv_current and img 2.4122705023425322e-05
perceptual hash difference is  10
Saving to id15_differ10_True_l24.27_pdistance0.006947339046746492
[STATS][L1] total = 16, id = 15, time = 73.197, success = True, const = 100.000000, hash_avg=10.13333, distortion = 4.27096, success_rate = 0.938, l2_avg=4.24559, p_avg=0.007647406108056505, iteration_avg=26.333333333333332
overall average l2  4.245586990168937
overal average perceptual distance  0.007647406108056505
overal average iterations  26.333333333333332
for image id  16
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.582, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00021948, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.115, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00077084, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.646, size = (1, 32, 32, 1), loss = 66.405, loss1 = 66.404, loss2 = 0.0015855, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.193, size = (1, 32, 32, 1), loss = 66.406, loss1 = 66.404, loss2 = 0.0025791, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.728, size = (1, 32, 32, 1), loss = 66.408, loss1 = 66.404, loss2 = 0.0040032, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.281, size = (1, 32, 32, 1), loss = 66.409, loss1 = 66.404, loss2 = 0.0052153, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.996, size = (1, 32, 32, 1), loss = 66.411, loss1 = 66.404, loss2 = 0.0069538, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.618, size = (1, 32, 32, 1), loss = 53.714, loss1 = 53.705, loss2 = 0.0088137, lr=0.01
saving outstep 0 and iteration 8
[STATS][L2] iter = 9, cost = 2304, time = 14.153, size = (1, 32, 32, 1), loss = 53.716, loss1 = 53.705, loss2 = 0.010563, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.728, size = (1, 32, 32, 1), loss = 53.717, loss1 = 53.705, loss2 = 0.011922, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.273, size = (1, 32, 32, 1), loss = 53.718, loss1 = 53.705, loss2 = 0.013236, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.818, size = (1, 32, 32, 1), loss = 53.72, loss1 = 53.705, loss2 = 0.014999, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.344, size = (1, 32, 32, 1), loss = 38.011, loss1 = 37.995, loss2 = 0.015991, lr=0.01
saving outstep 0 and iteration 13
[STATS][L2] iter = 14, cost = 3584, time = 21.878, size = (1, 32, 32, 1), loss = 38.013, loss1 = 37.995, loss2 = 0.018053, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.414, size = (1, 32, 32, 1), loss = 38.015, loss1 = 37.995, loss2 = 0.019999, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 24.953, size = (1, 32, 32, 1), loss = 38.017, loss1 = 37.995, loss2 = 0.022079, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.503, size = (1, 32, 32, 1), loss = 38.019, loss1 = 37.995, loss2 = 0.024448, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.075, size = (1, 32, 32, 1), loss = 38.022, loss1 = 37.995, loss2 = 0.026663, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.677, size = (1, 32, 32, 1), loss = 19.766, loss1 = 19.738, loss2 = 0.028026, lr=0.01
saving outstep 0 and iteration 19
[STATS][L2] iter = 20, cost = 5120, time = 31.213, size = (1, 32, 32, 1), loss = 19.768, loss1 = 19.738, loss2 = 0.029988, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.753, size = (1, 32, 32, 1), loss = 19.769, loss1 = 19.738, loss2 = 0.031826, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.286, size = (1, 32, 32, 1), loss = 19.772, loss1 = 19.738, loss2 = 0.034174, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 35.823, size = (1, 32, 32, 1), loss = 19.774, loss1 = 19.738, loss2 = 0.036384, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.353, size = (1, 32, 32, 1), loss = 19.777, loss1 = 19.738, loss2 = 0.038995, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 38.878, size = (1, 32, 32, 1), loss = 19.779, loss1 = 19.738, loss2 = 0.041161, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 40.403, size = (1, 32, 32, 1), loss = 19.78, loss1 = 19.738, loss2 = 0.042642, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 41.990, size = (1, 32, 32, 1), loss = 0.044635, loss1 = 0, loss2 = 0.044635, lr=0.01
saving outstep 0 and iteration 27
[STATS][L3](First valid attack found!) iter = 27, cost = 7168, time = 41.990, size = (1, 32, 32, 1), loss = 0.044639, loss1 = 0, loss2 = 0.044639
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.551, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0.00035048, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.122, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.00088, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.655, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.0016531, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.184, size = (1, 32, 32, 1), loss = 33.204, loss1 = 33.202, loss2 = 0.0026559, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.767, size = (1, 32, 32, 1), loss = 33.206, loss1 = 33.202, loss2 = 0.0042725, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.312, size = (1, 32, 32, 1), loss = 33.207, loss1 = 33.202, loss2 = 0.0056218, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.839, size = (1, 32, 32, 1), loss = 33.21, loss1 = 33.202, loss2 = 0.0077905, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.403, size = (1, 32, 32, 1), loss = 26.862, loss1 = 26.852, loss2 = 0.0090853, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.006, size = (1, 32, 32, 1), loss = 26.863, loss1 = 26.852, loss2 = 0.010282, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.601, size = (1, 32, 32, 1), loss = 26.864, loss1 = 26.852, loss2 = 0.011918, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.130, size = (1, 32, 32, 1), loss = 26.867, loss1 = 26.852, loss2 = 0.014163, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.674, size = (1, 32, 32, 1), loss = 26.868, loss1 = 26.852, loss2 = 0.015985, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.227, size = (1, 32, 32, 1), loss = 19.016, loss1 = 18.997, loss2 = 0.018243, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.777, size = (1, 32, 32, 1), loss = 19.018, loss1 = 18.997, loss2 = 0.020352, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.363, size = (1, 32, 32, 1), loss = 19.02, loss1 = 18.997, loss2 = 0.02235, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 24.953, size = (1, 32, 32, 1), loss = 19.022, loss1 = 18.997, loss2 = 0.024611, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.523, size = (1, 32, 32, 1), loss = 9.8959, loss1 = 9.8688, loss2 = 0.027134, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.121, size = (1, 32, 32, 1), loss = 9.8978, loss1 = 9.8688, loss2 = 0.028985, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.674, size = (1, 32, 32, 1), loss = 9.8997, loss1 = 9.8688, loss2 = 0.030923, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.268, size = (1, 32, 32, 1), loss = 9.9018, loss1 = 9.8688, loss2 = 0.033001, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.812, size = (1, 32, 32, 1), loss = 9.9031, loss1 = 9.8688, loss2 = 0.034284, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.359, size = (1, 32, 32, 1), loss = 9.9053, loss1 = 9.8688, loss2 = 0.036516, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 35.877, size = (1, 32, 32, 1), loss = 9.9075, loss1 = 9.8688, loss2 = 0.038783, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.397, size = (1, 32, 32, 1), loss = 9.9091, loss1 = 9.8688, loss2 = 0.040341, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 38.934, size = (1, 32, 32, 1), loss = 9.9116, loss1 = 9.8688, loss2 = 0.04288, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 40.517, size = (1, 32, 32, 1), loss = 9.9124, loss1 = 9.8688, loss2 = 0.043628, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.115, size = (1, 32, 32, 1), loss = 9.9139, loss1 = 9.8688, loss2 = 0.045162, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 43.653, size = (1, 32, 32, 1), loss = 9.9151, loss1 = 9.8688, loss2 = 0.046286, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.197, size = (1, 32, 32, 1), loss = 0.047435, loss1 = 0, loss2 = 0.047435, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 29, cost = 7680, time = 45.197, size = (1, 32, 32, 1), loss = 0.04744, loss1 = 0, loss2 = 0.04744
/device:GPU:0
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  5.557126252538717
l2_distortion between inputs and adv_current  5.557126252538717
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.044635203
perceptual metrics distance between adv_current and img 0.044635203
normalized perceptual metrics distance between adv and img 0.00015498334283216132
normalized perceptual metrics distance between adv_current and img 0.00015498334283216132
perceptual hash difference is  10
Saving to id16_differ10_True_l25.56_pdistance0.04463520273566246
[STATS][L1] total = 17, id = 16, time = 91.695, success = True, const = 100.000000, hash_avg=10.12500, distortion = 5.55713, success_rate = 0.941, l2_avg=4.32756, p_avg=0.009959143397281878, iteration_avg=26.4375
lhost/replica:0/task:0/device:GPU:0
overall average l2  4.327558194067049
overal average perceptual distance  0.009959143397281878
overal average iterations  26.4375
for image id  17
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.520, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 8.8229e-05, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.058, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00018777, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.593, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00032426, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.135, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.0004704, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.660, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00067447, lr=0.01
saving outstep 0 and iteration 5
[STATS][L2] iter = 6, cost = 1536, time = 9.179, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.0008511, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.741, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0011062, lr=0.01
saving outstep 0 and iteration 7
[STATS][L2] iter = 8, cost = 2048, time = 12.372, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0014193, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 13.910, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0017399, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.453, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0019763, lr=0.01
saving outstep 0 and iteration 10
[STATS][L2] iter = 11, cost = 2816, time = 17.094, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0022847, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.649, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.002653, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.261, size = (1, 32, 32, 1), loss = 0.0029374, loss1 = 0, loss2 = 0.0029374, lr=0.01
saving outstep 0 and iteration 13
[STATS][L3](First valid attack found!) iter = 13, cost = 3584, time = 20.261, size = (1, 32, 32, 1), loss = 0.0029374, loss1 = 0, loss2 = 0.0029374
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.731, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 9.6038e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.258, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00021068, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.787, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00037152, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.353, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00056231, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.882, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00070799, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.447, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00099359, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.048, size = (1, 32, 32, 1), loss = 9.87, loss1 = 9.8688, loss2 = 0.0011879, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.662, size = (1, 32, 32, 1), loss = 9.8701, loss1 = 9.8688, loss2 = 0.001363, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.218, size = (1, 32, 32, 1), loss = 9.8703, loss1 = 9.8688, loss2 = 0.0015476, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.772, size = (1, 32, 32, 1), loss = 9.8706, loss1 = 9.8688, loss2 = 0.0018097, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.352, size = (1, 32, 32, 1), loss = 9.8709, loss1 = 9.8688, loss2 = 0.0021628, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.885, size = (1, 32, 32, 1), loss = 9.8713, loss1 = 9.8688, loss2 = 0.0025419, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.452, size = (1, 32, 32, 1), loss = 0.0029155, loss1 = 0, loss2 = 0.0029155, lr=0.01
saving outstep 1 and iteration 13
[STATS][L3](Attack found!) iter = 13, cost = 3584, time = 20.452, size = (1, 32, 32, 1), loss = 0.0029154, loss1 = 0, loss2 = 0.0029154
Device mapping:
imEarly stopping because we found the adversarial example
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  3.523456491830268
l2_distortion between inputs and adv_current  3.523456491830268
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0029153598
perceptual metrics distance between adv_current and img 0.0029153598
normalized perceptual metrics distance between adv and img 1.0122777085699556e-05
normalized perceptual metrics distance between adv_current and img 1.0122777085699556e-05
perceptual hash difference is  10
Saving to id17_differ10_True_l23.52_pdistance0.002915359800681472
[STATS][L1] total = 18, id = 17, time = 44.826, success = True, const = 50.000000, hash_avg=10.11765, distortion = 3.52346, success_rate = 0.944, l2_avg=4.28026, p_avg=0.009544803185717148, iteration_avg=25.705882352941178
overall average l2  4.280258093935474
overal average perceptual distance  0.009544803185717148
overal average iterations  25.705882352941178
for image id  18
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.667, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 2.0837e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.270, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 5.2066e-05, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.837, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 8.886e-05, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.379, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00014236, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.904, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00018996, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.454, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00025203, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.007, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00032033, lr=0.01
saving outstep 0 and iteration 7
[STATS][L2] iter = 8, cost = 2048, time = 12.571, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00039131, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.156, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00046442, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.760, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00054514, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.298, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00063797, lr=0.01
saving outstep 0 and iteration 11
[STATS][L2] iter = 12, cost = 3072, time = 18.859, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00071364, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.399, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0008114, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.941, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00089759, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.499, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00099599, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.033, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0011277, lr=0.01
saving outstep 0 and iteration 16
[STATS][L2] iter = 17, cost = 4352, time = 26.580, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0012356, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.136, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0013275, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.716, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0014318, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.284, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0015693, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.835, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.00169, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.380, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0017816, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 35.924, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0019181, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.509, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0020508, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 39.066, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0022065, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 40.637, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0023469, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.196, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0024792, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 43.711, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.002638, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.233, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0027926, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 46.776, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.002944, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 48.335, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0030676, lr=0.01
[STATS][L2] iter = 32, cost = 8192, time = 49.916, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0032019, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 51.447, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0033614, lr=0.01
[STATS][L2] iter = 34, cost = 8704, time = 52.998, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0035482, lr=0.01
[STATS][L2] iter = 35, cost = 8960, time = 54.532, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0036885, lr=0.01
[STATS][L2] iter = 36, cost = 9216, time = 56.091, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0038642, lr=0.01
[STATS][L2] iter = 37, cost = 9472, time = 57.712, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0040079, lr=0.01
[STATS][L2] iter = 38, cost = 9728, time = 59.246, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0041185, lr=0.01
[STATS][L2] iter = 39, cost = 9984, time = 60.772, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0042237, lr=0.01
[STATS][L2] iter = 40, cost = 10240, time = 62.313, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0043454, lr=0.01
[STATS][L2] iter = 41, cost = 10496, time = 63.904, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0044774, lr=0.01
[STATS][L2] iter = 42, cost = 10752, time = 65.480, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0045794, lr=0.01
[STATS][L2] iter = 43, cost = 11008, time = 67.044, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0046846, lr=0.01
[STATS][L2] iter = 44, cost = 11264, time = 68.580, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0047926, lr=0.01
[STATS][L2] iter = 45, cost = 11520, time = 70.126, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0049239, lr=0.01
[STATS][L2] iter = 46, cost = 11776, time = 71.704, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0050442, lr=0.01
[STATS][L2] iter = 47, cost = 12032, time = 73.276, size = (1, 32, 32, 1), loss = 0.0051503, loss1 = 0, loss2 = 0.0051503, lr=0.01
saving outstep 0 and iteration 47
[STATS][L3](First valid attack found!) iter = 47, cost = 12288, time = 73.276, size = (1, 32, 32, 1), loss = 0.0051519, loss1 = 0, loss2 = 0.0051519
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.595, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 2.2237e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.187, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 5.6333e-05, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.722, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 9.3911e-05, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.261, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00014246, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.795, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00020193, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.545, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00027766, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.098, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00035232, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.731, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00043934, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.260, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.0005252, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.797, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00063201, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.334, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00073461, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.860, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00082325, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.419, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00093392, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.941, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.0010324, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.490, size = (1, 32, 32, 1), loss = 9.8699, loss1 = 9.8688, loss2 = 0.0011469, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.058, size = (1, 32, 32, 1), loss = 9.87, loss1 = 9.8688, loss2 = 0.0012464, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.600, size = (1, 32, 32, 1), loss = 9.8701, loss1 = 9.8688, loss2 = 0.0013441, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.124, size = (1, 32, 32, 1), loss = 9.8702, loss1 = 9.8688, loss2 = 0.001436, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.670, size = (1, 32, 32, 1), loss = 9.8703, loss1 = 9.8688, loss2 = 0.0015631, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.223, size = (1, 32, 32, 1), loss = 9.8705, loss1 = 9.8688, loss2 = 0.0016915, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.769, size = (1, 32, 32, 1), loss = 9.8706, loss1 = 9.8688, loss2 = 0.0017981, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.313, size = (1, 32, 32, 1), loss = 9.8707, loss1 = 9.8688, loss2 = 0.0019058, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 35.874, size = (1, 32, 32, 1), loss = 9.8708, loss1 = 9.8688, loss2 = 0.0020311, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.459, size = (1, 32, 32, 1), loss = 9.8709, loss1 = 9.8688, loss2 = 0.0021778, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 39.066, size = (1, 32, 32, 1), loss = 9.8711, loss1 = 9.8688, loss2 = 0.0023, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 40.639, size = (1, 32, 32, 1), loss = 9.8712, loss1 = 9.8688, loss2 = 0.0024247, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.194, size = (1, 32, 32, 1), loss = 9.8713, loss1 = 9.8688, loss2 = 0.0025609, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 43.733, size = (1, 32, 32, 1), loss = 9.8715, loss1 = 9.8688, loss2 = 0.0027003, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.261, size = (1, 32, 32, 1), loss = 9.8716, loss1 = 9.8688, loss2 = 0.00284, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 46.786, size = (1, 32, 32, 1), loss = 9.8717, loss1 = 9.8688, loss2 = 0.0029506, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 48.317, size = (1, 32, 32, 1), loss = 9.8718, loss1 = 9.8688, loss2 = 0.0030609, lr=0.01
[STATS][L2] iter = 32, cost = 8192, time = 49.853, size = (1, 32, 32, 1), loss = 9.872, loss1 = 9.8688, loss2 = 0.0031866, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 51.395, size = (1, 32, 32, 1), loss = 9.8721, loss1 = 9.8688, loss2 = 0.0033034, lr=0.01
[STATS][L2] iter = 34, cost = 8704, time = 53.001, size = (1, 32, 32, 1), loss = 9.8722, loss1 = 9.8688, loss2 = 0.0034235, lr=0.01
[STATS][L2] iter = 35, cost = 8960, time = 54.640, size = (1, 32, 32, 1), loss = 9.8723, loss1 = 9.8688, loss2 = 0.003541, lr=0.01
[STATS][L2] iter = 36, cost = 9216, time = 56.189, size = (1, 32, 32, 1), loss = 9.8725, loss1 = 9.8688, loss2 = 0.0036964, lr=0.01
[STATS][L2] iter = 37, cost = 9472, time = 57.771, size = (1, 32, 32, 1), loss = 9.8726, loss1 = 9.8688, loss2 = 0.003844, lr=0.01
[STATS][L2] iter = 38, cost = 9728, time = 59.312, size = (1, 32, 32, 1), loss = 9.8727, loss1 = 9.8688, loss2 = 0.0039742, lr=0.01
[STATS][L2] iter = 39, cost = 9984, time = 60.885, size = (1, 32, 32, 1), loss = 0.0041093, loss1 = 0, loss2 = 0.0041093, lr=0.01
saving outstep 1 and iteration 39
[STATS][L3](Attack found!) iter = 39, cost = 10240, time = 60.885, size = (1, 32, 32, 1), loss = 0.0041105, loss1 = 0, loss2 = 0.0041105
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  6.317370568809082
l2_distortion between inputs and adv_current  6.317370568809082
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.004109362
perceptual metrics distance between adv_current and img 0.004109362
normalized perceptual metrics distance between adv and img 1.4268618542701006e-05
normalized perceptual metrics distance between adv_current and img 1.4268618542701006e-05
perceptual hash difference is  10
Saving to id18_differ10_True_l26.32_pdistance0.00410936214029789
[STATS][L1] total = 19, id = 18, time = 139.082, success = True, const = 50.000000, hash_avg=10.11111, distortion = 6.31737, success_rate = 0.947, l2_avg=4.39343, p_avg=0.009242834238749411, iteration_avg=26.944444444444443
overall average l2  4.39343100920623
overal average perceptual distance  0.009242834238749411
overal average iterations  26.944444444444443
for image id  19
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.598, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 4.4469e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.228, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00010806, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.779, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00019137, lr=0.01
saving outstep 0 and iteration 3
[STATS][L2] iter = 4, cost = 1024, time = 6.323, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00028795, lr=0.01
saving outstep 0 and iteration 4
[STATS][L2] iter = 5, cost = 1280, time = 7.854, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00039608, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.488, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00054071, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.131, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00071801, lr=0.01
saving outstep 0 and iteration 7
[STATS][L2] iter = 8, cost = 2048, time = 12.720, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0008655, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.275, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0010448, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.850, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0012262, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.419, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0014206, lr=0.01
saving outstep 0 and iteration 11
[STATS][L2] iter = 12, cost = 3072, time = 19.045, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0016189, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.598, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0018326, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.152, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0020227, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.733, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0023199, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.257, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0025517, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.824, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.002775, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.361, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0029998, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.986, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0032033, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.598, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0034153, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 33.165, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.003669, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.750, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0038982, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 36.363, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0041523, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.979, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0043819, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 39.544, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0046498, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 41.067, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0049625, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.642, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0052475, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 44.231, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0055226, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.792, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0057868, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 47.357, size = (1, 32, 32, 1), loss = 19.744, loss1 = 19.738, loss2 = 0.0060863, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 48.888, size = (1, 32, 32, 1), loss = 19.744, loss1 = 19.738, loss2 = 0.0062913, lr=0.01
[STATS][L2] iter = 32, cost = 8192, time = 50.425, size = (1, 32, 32, 1), loss = 19.744, loss1 = 19.738, loss2 = 0.0065579, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 51.998, size = (1, 32, 32, 1), loss = 0.0068351, loss1 = 0, loss2 = 0.0068351, lr=0.01
saving outstep 0 and iteration 33
[STATS][L3](First valid attack found!) iter = 33, cost = 8704, time = 51.998, size = (1, 32, 32, 1), loss = 0.0068348, loss1 = 0, loss2 = 0.0068348
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.629, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 5.0349e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.183, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00011446, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.722, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00021002, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.351, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00032729, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.883, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00044963, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.631, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00054403, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.185, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00065896, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.712, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00080841, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.228, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00094054, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.766, size = (1, 32, 32, 1), loss = 9.8698, loss1 = 9.8688, loss2 = 0.0010726, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.337, size = (1, 32, 32, 1), loss = 9.87, loss1 = 9.8688, loss2 = 0.0012267, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.900, size = (1, 32, 32, 1), loss = 9.8702, loss1 = 9.8688, loss2 = 0.0013962, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.481, size = (1, 32, 32, 1), loss = 9.8704, loss1 = 9.8688, loss2 = 0.0016276, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.020, size = (1, 32, 32, 1), loss = 9.8706, loss1 = 9.8688, loss2 = 0.0017935, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.560, size = (1, 32, 32, 1), loss = 9.8708, loss1 = 9.8688, loss2 = 0.0020063, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.085, size = (1, 32, 32, 1), loss = 9.871, loss1 = 9.8688, loss2 = 0.0022299, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.682, size = (1, 32, 32, 1), loss = 9.8712, loss1 = 9.8688, loss2 = 0.0024658, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.197, size = (1, 32, 32, 1), loss = 9.8715, loss1 = 9.8688, loss2 = 0.0027305, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.735, size = (1, 32, 32, 1), loss = 9.8717, loss1 = 9.8688, loss2 = 0.0029388, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.342, size = (1, 32, 32, 1), loss = 9.8719, loss1 = 9.8688, loss2 = 0.0031467, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.920, size = (1, 32, 32, 1), loss = 9.8721, loss1 = 9.8688, loss2 = 0.0033566, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.694, size = (1, 32, 32, 1), loss = 9.8723, loss1 = 9.8688, loss2 = 0.0035563, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 36.254, size = (1, 32, 32, 1), loss = 9.8725, loss1 = 9.8688, loss2 = 0.0037796, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.804, size = (1, 32, 32, 1), loss = 9.8729, loss1 = 9.8688, loss2 = 0.0040948, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 39.381, size = (1, 32, 32, 1), loss = 9.8731, loss1 = 9.8688, loss2 = 0.0043608, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 40.903, size = (1, 32, 32, 1), loss = 9.8734, loss1 = 9.8688, loss2 = 0.0046025, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.439, size = (1, 32, 32, 1), loss = 9.8737, loss1 = 9.8688, loss2 = 0.0049157, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 44.242, size = (1, 32, 32, 1), loss = 9.8739, loss1 = 9.8688, loss2 = 0.0051766, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.853, size = (1, 32, 32, 1), loss = 9.8742, loss1 = 9.8688, loss2 = 0.0054035, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 47.479, size = (1, 32, 32, 1), loss = 0.0056846, loss1 = 0, loss2 = 0.0056846, lr=0.01
saving outstep 1 and iteration 30
[STATS][L3](Attack found!) iter = 30, cost = 7936, time = 47.479, size = (1, 32, 32, 1), loss = 0.0056862, loss1 = 0, loss2 = 0.0056862
evice:GPU:0
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  4.956597695199208
l2_distortion between inputs and adv_current  4.956597695199208
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.00568482
perceptual metrics distance between adv_current and img 0.00568482
normalized perceptual metrics distance between adv and img 1.9738958346553976e-05
normalized perceptual metrics distance between adv_current and img 1.9738958346553976e-05
perceptual hash difference is  10
Saving to id19_differ10_True_l24.96_pdistance0.005684820003807545
[STATS][L1] total = 20, id = 19, time = 104.030, success = True, const = 50.000000, hash_avg=10.10526, distortion = 4.95660, success_rate = 0.950, l2_avg=4.42307, p_avg=0.009055570331647209, iteration_avg=27.31578947368421
lica:0/task:0/device:GPU:0
overall average l2  4.423071361100598
overal average perceptual distance  0.009055570331647209
overal average iterations  27.31578947368421
for image id  20
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.536, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 4.2141e-05, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.067, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 9.427e-05, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.610, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00016452, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.213, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00024411, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.942, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00032968, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.721, size = (1, 32, 32, 1), loss = 37.995, loss1 = 37.995, loss2 = 0.00044075, lr=0.01
saving outstep 0 and iteration 6
[STATS][L2] iter = 7, cost = 1792, time = 11.309, size = (1, 32, 32, 1), loss = 37.995, loss1 = 37.995, loss2 = 0.00054688, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 13.032, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00065717, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.574, size = (1, 32, 32, 1), loss = 19.738, loss1 = 19.738, loss2 = 0.00081689, lr=0.01
saving outstep 0 and iteration 9
[STATS][L2] iter = 10, cost = 2560, time = 16.116, size = (1, 32, 32, 1), loss = 19.738, loss1 = 19.738, loss2 = 0.00094344, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.636, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.001105, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 19.168, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.001225, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.765, size = (1, 32, 32, 1), loss = 0.0014074, loss1 = 0, loss2 = 0.0014074, lr=0.01
saving outstep 0 and iteration 13
[STATS][L3](First valid attack found!) iter = 13, cost = 3584, time = 20.765, size = (1, 32, 32, 1), loss = 0.0014071, loss1 = 0, loss2 = 0.0014071
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.526, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 4.1041e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.064, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00010396, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.647, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.0001906, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.281, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00028461, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.828, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00039597, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.372, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00047704, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.914, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00056627, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.441, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00065841, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.005, size = (1, 32, 32, 1), loss = 9.8696, loss1 = 9.8688, loss2 = 0.00078794, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.541, size = (1, 32, 32, 1), loss = 9.8697, loss1 = 9.8688, loss2 = 0.00093594, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.087, size = (1, 32, 32, 1), loss = 9.8698, loss1 = 9.8688, loss2 = 0.0010718, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.658, size = (1, 32, 32, 1), loss = 9.87, loss1 = 9.8688, loss2 = 0.0011976, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.331, size = (1, 32, 32, 1), loss = 9.8701, loss1 = 9.8688, loss2 = 0.0013393, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.876, size = (1, 32, 32, 1), loss = 0.0015438, loss1 = 0, loss2 = 0.0015438, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 14, cost = 3840, time = 21.876, size = (1, 32, 32, 1), loss = 0.0015438, loss1 = 0, loss2 = 0.0015438
GPU:0
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  3.0792008940563287
l2_distortion between inputs and adv_current  3.0792008940563287
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0014075583
perceptual metrics distance between adv_current and img 0.0014075583
normalized perceptual metrics distance between adv and img 4.8873553168959916e-06
normalized perceptual metrics distance between adv_current and img 4.8873553168959916e-06
perceptual hash difference is  10
Saving to id20_differ10_True_l23.08_pdistance0.0014075583312660456
[STATS][L1] total = 21, id = 20, time = 46.846, success = True, const = 100.000000, hash_avg=10.10000, distortion = 3.07920, success_rate = 0.952, l2_avg=4.35588, p_avg=0.00867316973162815, iteration_avg=26.65
U:0
overall average l2  4.355877837748384
overal average perceptual distance  0.00867316973162815
overal average iterations  26.65
for image id  21
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.528, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00012867, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.078, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00031611, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.628, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00055577, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.203, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.0010943, lr=0.01
saving outstep 0 and iteration 4
[STATS][L2] iter = 5, cost = 1280, time = 7.772, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0016561, lr=0.01
saving outstep 0 and iteration 5
[STATS][L2] iter = 6, cost = 1536, time = 9.326, size = (1, 32, 32, 1), loss = 0.0021808, loss1 = 0, loss2 = 0.0021808, lr=0.01
saving outstep 0 and iteration 6
[STATS][L3](First valid attack found!) iter = 6, cost = 1792, time = 9.326, size = (1, 32, 32, 1), loss = 0.0021809, loss1 = 0, loss2 = 0.0021809
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.569, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00010685, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.314, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00029468, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.886, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.0005359, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.418, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00086051, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 8.012, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0011282, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.662, size = (1, 32, 32, 1), loss = 0.0015586, loss1 = 0, loss2 = 0.0015586, lr=0.01
saving outstep 1 and iteration 6
[STATS][L3](Attack found!) iter = 6, cost = 1792, time = 9.662, size = (1, 32, 32, 1), loss = 0.0015587, loss1 = 0, loss2 = 0.0015587
k:0/device:GPU:0
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  1.7728648422536704
l2_distortion between inputs and adv_current  1.7728648422536704
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0015584887
perceptual metrics distance between adv_current and img 0.0015584887
normalized perceptual metrics distance between adv and img 5.411419099093311e-06
normalized perceptual metrics distance between adv_current and img 5.411419099093311e-06
perceptual hash difference is  10
Saving to id21_differ10_True_l21.77_pdistance0.0015584887005388737
[STATS][L1] total = 22, id = 21, time = 23.094, success = True, const = 50.000000, hash_avg=10.09524, distortion = 1.77286, success_rate = 0.955, l2_avg=4.23288, p_avg=0.008334375396814375, iteration_avg=25.714285714285715
ioverall average hash  10.095238095238095
overall average l2  4.232877218915302
overal average perceptual distance  0.008334375396814375
overal average iterations  25.714285714285715
for image id  22
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.521, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 4.1972e-05, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.072, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00011077, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.637, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00018525, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.245, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.0002677, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.792, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00038116, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.382, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00052658, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.964, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0006696, lr=0.01
saving outstep 0 and iteration 7
[STATS][L2] iter = 8, cost = 2048, time = 12.508, size = (1, 32, 32, 1), loss = 19.738, loss1 = 19.738, loss2 = 0.00081178, lr=0.01
saving outstep 0 and iteration 8
[STATS][L2] iter = 9, cost = 2304, time = 14.054, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.00098203, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.587, size = (1, 32, 32, 1), loss = 0.0011649, loss1 = 0, loss2 = 0.0011649, lr=0.01
saving outstep 0 and iteration 10
[STATS][L3](First valid attack found!) iter = 10, cost = 2816, time = 15.587, size = (1, 32, 32, 1), loss = 0.0011638, loss1 = 0, loss2 = 0.0011638
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.531, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 4.4361e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.098, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00010651, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.690, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00019366, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.246, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00030668, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.809, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00044505, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.319, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00060209, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.855, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00073787, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.384, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00089011, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 13.896, size = (1, 32, 32, 1), loss = 9.8699, loss1 = 9.8688, loss2 = 0.0010954, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.471, size = (1, 32, 32, 1), loss = 0.0012761, loss1 = 0, loss2 = 0.0012761, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 10, cost = 2816, time = 15.471, size = (1, 32, 32, 1), loss = 0.0012764, loss1 = 0, loss2 = 0.0012764
Device mapping:
iEarly stopping because we found the adversarial example
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  2.468480124662009
l2_distortion between inputs and adv_current  2.468480124662009
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.001165022
perceptual metrics distance between adv_current and img 0.001165022
normalized perceptual metrics distance between adv and img 4.045215367417161e-06
normalized perceptual metrics distance between adv_current and img 4.045215367417161e-06
perceptual hash difference is  10
Saving to id22_differ10_True_l22.47_pdistance0.0011650220258161426
[STATS][L1] total = 23, id = 22, time = 35.249, success = True, const = 100.000000, hash_avg=10.09091, distortion = 2.46848, success_rate = 0.957, l2_avg=4.15268, p_avg=0.008008495698132638, iteration_avg=25.045454545454547
impoverall average hash  10.090909090909092
overall average l2  4.152677350994698
overal average perceptual distance  0.008008495698132638
overal average iterations  25.045454545454547
for image id  23
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.571, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 2.5429e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.107, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 6.1062e-05, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.639, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00011211, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.209, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00017225, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.726, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00023943, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.289, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00030475, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.844, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00039405, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.434, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.0004658, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 13.988, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00055193, lr=0.01
saving outstep 0 and iteration 9
[STATS][L2] iter = 10, cost = 2560, time = 15.585, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.0006386, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.162, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00073688, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.690, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00084658, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.207, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00093493, lr=0.01
saving outstep 0 and iteration 13
[STATS][L2] iter = 14, cost = 3584, time = 21.744, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0010583, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.332, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0011694, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 24.930, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0012716, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.641, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0013808, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.175, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.001528, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.685, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0016698, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.211, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0018224, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.750, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0019515, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.291, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0020828, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 35.829, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0022125, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.384, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0023592, lr=0.01
saving outstep 0 and iteration 24
[STATS][L2] iter = 25, cost = 6400, time = 39.042, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0025025, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 40.572, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0026552, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.099, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0028181, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 43.670, size = (1, 32, 32, 1), loss = 0.0029713, loss1 = 0, loss2 = 0.0029713, lr=0.01
saving outstep 0 and iteration 28
[STATS][L3](First valid attack found!) iter = 28, cost = 7424, time = 43.670, size = (1, 32, 32, 1), loss = 0.0029707, loss1 = 0, loss2 = 0.0029707
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.536, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 2.5911e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.119, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 6.351e-05, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.690, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00010512, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.273, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00016447, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.847, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00023572, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.392, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00030512, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.925, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.0003849, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.452, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00046755, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 13.992, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00054337, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.569, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.0006302, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.104, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00074226, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.679, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00082538, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.265, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00093266, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.115, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.001028, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.663, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0011316, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.301, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0012499, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.874, size = (1, 32, 32, 1), loss = 9.8701, loss1 = 9.8688, loss2 = 0.0013782, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.423, size = (1, 32, 32, 1), loss = 9.8702, loss1 = 9.8688, loss2 = 0.0014792, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.955, size = (1, 32, 32, 1), loss = 9.8704, loss1 = 9.8688, loss2 = 0.0015851, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.499, size = (1, 32, 32, 1), loss = 9.8705, loss1 = 9.8688, loss2 = 0.0016917, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 33.039, size = (1, 32, 32, 1), loss = 9.8706, loss1 = 9.8688, loss2 = 0.0018055, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.627, size = (1, 32, 32, 1), loss = 9.8707, loss1 = 9.8688, loss2 = 0.0019093, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 36.206, size = (1, 32, 32, 1), loss = 9.8708, loss1 = 9.8688, loss2 = 0.0020407, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.783, size = (1, 32, 32, 1), loss = 9.8709, loss1 = 9.8688, loss2 = 0.002148, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 39.423, size = (1, 32, 32, 1), loss = 0.0022474, loss1 = 0, loss2 = 0.0022474, lr=0.01
saving outstep 1 and iteration 25
[STATS][L3](Attack found!) iter = 25, cost = 6656, time = 39.423, size = (1, 32, 32, 1), loss = 0.0022484, loss1 = 0, loss2 = 0.0022484
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  5.4812825217600425
l2_distortion between inputs and adv_current  5.4812825217600425
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0022477864
perceptual metrics distance between adv_current and img 0.0022477864
normalized perceptual metrics distance between adv and img 7.804813827129288e-06
normalized perceptual metrics distance between adv_current and img 7.804813827129288e-06
perceptual hash difference is  10
Saving to id23_differ10_True_l25.48_pdistance0.002247786382213235
[STATS][L1] total = 24, id = 23, time = 87.669, success = True, const = 50.000000, hash_avg=10.08696, distortion = 5.48128, success_rate = 0.958, l2_avg=4.21044, p_avg=0.007758030075701358, iteration_avg=25.217391304347824
ocalhost/replica:0/task:0/device:GPU:0
impoverall average hash  10.08695652173913
overall average l2  4.210442793201887
overal average perceptual distance  0.007758030075701358
overal average iterations  25.217391304347824
for image id  24
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.531, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 8.9019e-05, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.133, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00020152, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.724, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00035291, lr=0.01
saving outstep 0 and iteration 3
[STATS][L2] iter = 4, cost = 1024, time = 6.359, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00055764, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.911, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00073273, lr=0.01
saving outstep 0 and iteration 5
[STATS][L2] iter = 6, cost = 1536, time = 9.553, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00097745, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.157, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.001267, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.740, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0015722, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.326, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0018317, lr=0.01
saving outstep 0 and iteration 9
[STATS][L2] iter = 10, cost = 2560, time = 15.876, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0021978, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.430, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0025678, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.989, size = (1, 32, 32, 1), loss = 0.0028599, loss1 = 0, loss2 = 0.0028599, lr=0.01
saving outstep 0 and iteration 12
[STATS][L3](First valid attack found!) iter = 12, cost = 3328, time = 18.989, size = (1, 32, 32, 1), loss = 0.0028605, loss1 = 0, loss2 = 0.0028605
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.546, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 8.6989e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.080, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.0002041, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.644, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00034806, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.196, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00050759, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.761, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00070893, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.352, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00095175, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.900, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0012148, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.722, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0014723, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.323, size = (1, 32, 32, 1), loss = 9.8706, loss1 = 9.8688, loss2 = 0.0017878, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.875, size = (1, 32, 32, 1), loss = 9.8708, loss1 = 9.8688, loss2 = 0.0019975, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.400, size = (1, 32, 32, 1), loss = 9.8711, loss1 = 9.8688, loss2 = 0.0023141, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.950, size = (1, 32, 32, 1), loss = 9.8714, loss1 = 9.8688, loss2 = 0.0026396, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.497, size = (1, 32, 32, 1), loss = 0.0030343, loss1 = 0, loss2 = 0.0030343, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 13, cost = 3584, time = 20.497, size = (1, 32, 32, 1), loss = 0.0030363, loss1 = 0, loss2 = 0.0030363
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  2.620234866739621
l2_distortion between inputs and adv_current  2.620234866739621
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0028601268
perceptual metrics distance between adv_current and img 0.0028601268
normalized perceptual metrics distance between adv and img 9.930995778025439e-06
normalized perceptual metrics distance between adv_current and img 9.930995778025439e-06
perceptual hash difference is  10
Saving to id24_differ10_True_l22.62_pdistance0.0028601267840713263
[STATS][L1] total = 25, id = 24, time = 43.908, success = True, const = 100.000000, hash_avg=10.08333, distortion = 2.62023, success_rate = 0.960, l2_avg=4.14418, p_avg=0.00755395077188344, iteration_avg=24.708333333333332
overall average l2  4.144184129599292
overal average perceptual distance  0.00755395077188344
overal average iterations  24.708333333333332
for image id  25
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.560, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 5.3314e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.115, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00013015, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.665, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00024983, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.266, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00038544, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.810, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00050825, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.353, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00074703, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.892, size = (1, 32, 32, 1), loss = 66.405, loss1 = 66.404, loss2 = 0.0010218, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.535, size = (1, 32, 32, 1), loss = 66.405, loss1 = 66.404, loss2 = 0.0013017, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.099, size = (1, 32, 32, 1), loss = 53.707, loss1 = 53.705, loss2 = 0.0016365, lr=0.01
saving outstep 0 and iteration 9
[STATS][L2] iter = 10, cost = 2560, time = 15.674, size = (1, 32, 32, 1), loss = 53.707, loss1 = 53.705, loss2 = 0.0019499, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.203, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0022188, lr=0.01
saving outstep 0 and iteration 11
[STATS][L2] iter = 12, cost = 3072, time = 18.736, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0024834, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.272, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0028609, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.896, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0031373, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.411, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.003567, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 24.934, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0041169, lr=0.01
saving outstep 0 and iteration 16
[STATS][L2] iter = 17, cost = 4352, time = 26.461, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0045839, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.031, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.004918, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.643, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0052957, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.203, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0055885, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.746, size = (1, 32, 32, 1), loss = 19.744, loss1 = 19.738, loss2 = 0.0060904, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.272, size = (1, 32, 32, 1), loss = 19.744, loss1 = 19.738, loss2 = 0.006584, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 35.832, size = (1, 32, 32, 1), loss = 19.745, loss1 = 19.738, loss2 = 0.0069793, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.376, size = (1, 32, 32, 1), loss = 19.745, loss1 = 19.738, loss2 = 0.0074955, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 38.922, size = (1, 32, 32, 1), loss = 19.746, loss1 = 19.738, loss2 = 0.008015, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 40.524, size = (1, 32, 32, 1), loss = 19.746, loss1 = 19.738, loss2 = 0.00853, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.162, size = (1, 32, 32, 1), loss = 19.747, loss1 = 19.738, loss2 = 0.0092324, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 43.781, size = (1, 32, 32, 1), loss = 19.747, loss1 = 19.738, loss2 = 0.0098188, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.363, size = (1, 32, 32, 1), loss = 19.748, loss1 = 19.738, loss2 = 0.010244, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 47.123, size = (1, 32, 32, 1), loss = 19.748, loss1 = 19.738, loss2 = 0.010756, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 48.665, size = (1, 32, 32, 1), loss = 19.749, loss1 = 19.738, loss2 = 0.011301, lr=0.01
[STATS][L2] iter = 32, cost = 8192, time = 50.205, size = (1, 32, 32, 1), loss = 19.75, loss1 = 19.738, loss2 = 0.01206, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 51.743, size = (1, 32, 32, 1), loss = 19.75, loss1 = 19.738, loss2 = 0.012445, lr=0.01
[STATS][L2] iter = 34, cost = 8704, time = 53.265, size = (1, 32, 32, 1), loss = 19.75, loss1 = 19.738, loss2 = 0.012901, lr=0.01
[STATS][L2] iter = 35, cost = 8960, time = 54.789, size = (1, 32, 32, 1), loss = 19.751, loss1 = 19.738, loss2 = 0.013332, lr=0.01
[STATS][L2] iter = 36, cost = 9216, time = 56.350, size = (1, 32, 32, 1), loss = 19.751, loss1 = 19.738, loss2 = 0.013856, lr=0.01
[STATS][L2] iter = 37, cost = 9472, time = 57.896, size = (1, 32, 32, 1), loss = 0.014423, loss1 = 0, loss2 = 0.014423, lr=0.01
saving outstep 0 and iteration 37
[STATS][L3](First valid attack found!) iter = 37, cost = 9728, time = 57.896, size = (1, 32, 32, 1), loss = 0.014428, loss1 = 0, loss2 = 0.014428
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.614, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 6.4711e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.174, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00016319, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.709, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00032037, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.239, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00044963, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.798, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00059444, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.311, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.00082681, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.870, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.0011058, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.466, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.0014167, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.011, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.0016704, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.556, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0020794, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.096, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0026606, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.619, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0030457, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.150, size = (1, 32, 32, 1), loss = 9.8724, loss1 = 9.8688, loss2 = 0.003585, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.669, size = (1, 32, 32, 1), loss = 9.873, loss1 = 9.8688, loss2 = 0.0041859, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.203, size = (1, 32, 32, 1), loss = 9.8736, loss1 = 9.8688, loss2 = 0.0048591, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 24.772, size = (1, 32, 32, 1), loss = 9.8741, loss1 = 9.8688, loss2 = 0.0053368, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.361, size = (1, 32, 32, 1), loss = 9.8746, loss1 = 9.8688, loss2 = 0.0058382, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 27.964, size = (1, 32, 32, 1), loss = 9.8751, loss1 = 9.8688, loss2 = 0.0063659, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.491, size = (1, 32, 32, 1), loss = 9.8759, loss1 = 9.8688, loss2 = 0.0070901, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.033, size = (1, 32, 32, 1), loss = 9.8764, loss1 = 9.8688, loss2 = 0.0076262, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.570, size = (1, 32, 32, 1), loss = 9.8769, loss1 = 9.8688, loss2 = 0.008116, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.115, size = (1, 32, 32, 1), loss = 9.8774, loss1 = 9.8688, loss2 = 0.0085913, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 35.652, size = (1, 32, 32, 1), loss = 9.8777, loss1 = 9.8688, loss2 = 0.008972, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.230, size = (1, 32, 32, 1), loss = 9.8784, loss1 = 9.8688, loss2 = 0.0096678, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 38.805, size = (1, 32, 32, 1), loss = 9.8789, loss1 = 9.8688, loss2 = 0.010103, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 40.378, size = (1, 32, 32, 1), loss = 9.8796, loss1 = 9.8688, loss2 = 0.010866, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 41.914, size = (1, 32, 32, 1), loss = 9.8803, loss1 = 9.8688, loss2 = 0.011545, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 43.442, size = (1, 32, 32, 1), loss = 9.8812, loss1 = 9.8688, loss2 = 0.0124, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 44.978, size = (1, 32, 32, 1), loss = 9.8817, loss1 = 9.8688, loss2 = 0.012921, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 46.533, size = (1, 32, 32, 1), loss = 9.8824, loss1 = 9.8688, loss2 = 0.013645, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 48.136, size = (1, 32, 32, 1), loss = 9.8829, loss1 = 9.8688, loss2 = 0.014166, lr=0.01
[STATS][L2] iter = 32, cost = 8192, time = 49.672, size = (1, 32, 32, 1), loss = 9.8835, loss1 = 9.8688, loss2 = 0.014767, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 51.231, size = (1, 32, 32, 1), loss = 9.8842, loss1 = 9.8688, loss2 = 0.015426, lr=0.01
[STATS][L2] iter = 34, cost = 8704, time = 52.752, size = (1, 32, 32, 1), loss = 9.8848, loss1 = 9.8688, loss2 = 0.016048, lr=0.01
[STATS][L2] iter = 35, cost = 8960, time = 54.337, size = (1, 32, 32, 1), loss = 9.8854, loss1 = 9.8688, loss2 = 0.016624, lr=0.01
[STATS][L2] iter = 36, cost = 9216, time = 55.900, size = (1, 32, 32, 1), loss = 9.8859, loss1 = 9.8688, loss2 = 0.017126, lr=0.01
[STATS][L2] iter = 37, cost = 9472, time = 57.448, size = (1, 32, 32, 1), loss = 0.017442, loss1 = 0, loss2 = 0.017442, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 37, cost = 9728, time = 57.448, size = (1, 32, 32, 1), loss = 0.017445, loss1 = 0, loss2 = 0.017445
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  5.801947553929726
l2_distortion between inputs and adv_current  5.801947553929726
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0144227315
perceptual metrics distance between adv_current and img 0.0144227315
normalized perceptual metrics distance between adv and img 5.007892872931229e-05
normalized perceptual metrics distance between adv_current and img 5.007892872931229e-05
perceptual hash difference is  10
Saving to id25_differ10_True_l25.80_pdistance0.014422731474041939
[STATS][L1] total = 26, id = 25, time = 120.222, success = True, const = 100.000000, hash_avg=10.08000, distortion = 5.80195, success_rate = 0.962, l2_avg=4.21049, p_avg=0.007828701999969781, iteration_avg=25.24
0/device:GPU:0
overall average l2  4.21049466657251
overal average perceptual distance  0.007828701999969781
overal average iterations  25.24
for image id  26
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.539, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.0001302, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.072, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00036528, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.643, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00055854, lr=0.01
saving outstep 0 and iteration 3
[STATS][L2] iter = 4, cost = 1024, time = 6.190, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00080446, lr=0.01
saving outstep 0 and iteration 4
[STATS][L2] iter = 5, cost = 1280, time = 7.776, size = (1, 32, 32, 1), loss = 0.0011561, loss1 = 0, loss2 = 0.0011561, lr=0.01
saving outstep 0 and iteration 5
[STATS][L3](First valid attack found!) iter = 5, cost = 1536, time = 7.776, size = (1, 32, 32, 1), loss = 0.0011564, loss1 = 0, loss2 = 0.0011564
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.540, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00012217, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.099, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.0003321, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.626, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00059188, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.162, size = (1, 32, 32, 1), loss = 9.8697, loss1 = 9.8688, loss2 = 0.00090089, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.689, size = (1, 32, 32, 1), loss = 9.87, loss1 = 9.8688, loss2 = 0.0012358, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.289, size = (1, 32, 32, 1), loss = 0.0016386, loss1 = 0, loss2 = 0.0016386, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 6, cost = 1792, time = 9.289, size = (1, 32, 32, 1), loss = 0.0016387, loss1 = 0, loss2 = 0.0016387
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  1.3626322575465728
l2_distortion between inputs and adv_current  1.3626322575465728
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0011560037
perceptual metrics distance between adv_current and img 0.0011560037
normalized perceptual metrics distance between adv and img 4.013901666945054e-06
normalized perceptual metrics distance between adv_current and img 4.013901666945054e-06
perceptual hash difference is  10
Saving to id26_differ10_True_l21.36_pdistance0.0011560036800801754
[STATS][L1] total = 27, id = 26, time = 21.402, success = True, const = 100.000000, hash_avg=10.07692, distortion = 1.36263, success_rate = 0.963, l2_avg=4.10096, p_avg=0.007572059756897103, iteration_avg=24.5
ica:0/task:0/device:GPU:0
overall average l2  4.100961496994589
overal average perceptual distance  0.007572059756897103
overal average iterations  24.5
for image id  27
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.596, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 9.8556e-05, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.186, size = (1, 32, 32, 1), loss = 37.995, loss1 = 37.995, loss2 = 0.00023996, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.774, size = (1, 32, 32, 1), loss = 37.995, loss1 = 37.995, loss2 = 0.00041256, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.299, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0006159, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.918, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00080283, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.506, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0011018, lr=0.01
saving outstep 0 and iteration 6
[STATS][L2] iter = 7, cost = 1792, time = 11.130, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0013783, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.696, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0016631, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.291, size = (1, 32, 32, 1), loss = 0.0019573, loss1 = 0, loss2 = 0.0019573, lr=0.01
saving outstep 0 and iteration 9
[STATS][L3](First valid attack found!) iter = 9, cost = 2560, time = 14.291, size = (1, 32, 32, 1), loss = 0.0019571, loss1 = 0, loss2 = 0.0019571
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.546, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 8.9894e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.143, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00025764, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.724, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00040065, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.295, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00061313, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.873, size = (1, 32, 32, 1), loss = 9.8696, loss1 = 9.8688, loss2 = 0.00084737, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.679, size = (1, 32, 32, 1), loss = 9.8699, loss1 = 9.8688, loss2 = 0.0011036, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.235, size = (1, 32, 32, 1), loss = 9.8701, loss1 = 9.8688, loss2 = 0.0013561, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.789, size = (1, 32, 32, 1), loss = 9.8704, loss1 = 9.8688, loss2 = 0.0016436, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.377, size = (1, 32, 32, 1), loss = 0.0019348, loss1 = 0, loss2 = 0.0019348, lr=0.01
saving outstep 1 and iteration 9
[STATS][L3](Attack found!) iter = 9, cost = 2560, time = 14.377, size = (1, 32, 32, 1), loss = 0.001936, loss1 = 0, loss2 = 0.001936
:0/task:0/device:GPU:0
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  2.331520389537766
l2_distortion between inputs and adv_current  2.331520389537766
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0019346911
perceptual metrics distance between adv_current and img 0.0019346911
normalized perceptual metrics distance between adv and img 6.717677428645806e-06
normalized perceptual metrics distance between adv_current and img 6.717677428645806e-06
perceptual hash difference is  10
Saving to id27_differ10_True_l22.33_pdistance0.0019346910994499922
[STATS][L1] total = 28, id = 27, time = 33.093, success = True, const = 50.000000, hash_avg=10.07407, distortion = 2.33152, success_rate = 0.964, l2_avg=4.03543, p_avg=0.007363268325139803, iteration_avg=23.962962962962962
PU:0
overall average l2  4.035426641162855
overal average perceptual distance  0.007363268325139803
overal average iterations  23.962962962962962
for image id  28
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.548, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00017669, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.140, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00042944, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.708, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00075811, lr=0.01
saving outstep 0 and iteration 3
[STATS][L2] iter = 4, cost = 1024, time = 6.257, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0012281, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.799, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0017779, lr=0.01
saving outstep 0 and iteration 5
[STATS][L2] iter = 6, cost = 1536, time = 9.340, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0024268, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.889, size = (1, 32, 32, 1), loss = 0.0032334, loss1 = 0, loss2 = 0.0032334, lr=0.01
saving outstep 0 and iteration 7
[STATS][L3](First valid attack found!) iter = 7, cost = 2048, time = 10.889, size = (1, 32, 32, 1), loss = 0.0032328, loss1 = 0, loss2 = 0.0032328
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.538, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.0001785, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.094, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00047738, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.657, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00080666, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.223, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0011659, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.748, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0017013, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.297, size = (1, 32, 32, 1), loss = 9.8709, loss1 = 9.8688, loss2 = 0.0021476, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.958, size = (1, 32, 32, 1), loss = 9.8717, loss1 = 9.8688, loss2 = 0.0029713, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.530, size = (1, 32, 32, 1), loss = 0.0040127, loss1 = 0, loss2 = 0.0040127, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 8, cost = 2304, time = 12.530, size = (1, 32, 32, 1), loss = 0.0040111, loss1 = 0, loss2 = 0.0040111
0/device:GPU:0
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  2.16377586774976
l2_distortion between inputs and adv_current  2.16377586774976
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0032334472
perceptual metrics distance between adv_current and img 0.0032334472
normalized perceptual metrics distance between adv and img 1.1227247240539226e-05
normalized perceptual metrics distance between adv_current and img 1.1227247240539226e-05
perceptual hash difference is  10
Saving to id28_differ10_True_l22.16_pdistance0.003233447205275297
[STATS][L1] total = 29, id = 28, time = 27.718, success = True, const = 100.000000, hash_avg=10.07143, distortion = 2.16378, success_rate = 0.966, l2_avg=3.96858, p_avg=0.007215774713716071, iteration_avg=23.392857142857142
overall average l2  3.968581970683816
overal average perceptual distance  0.007215774713716071
overal average iterations  23.392857142857142
for image id  29
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.627, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00011846, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.162, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00036583, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.697, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00066735, lr=0.01
saving outstep 0 and iteration 3
[STATS][L2] iter = 4, cost = 1024, time = 6.254, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0011153, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.773, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0014728, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.307, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0020101, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.900, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0027374, lr=0.01
saving outstep 0 and iteration 7
[STATS][L2] iter = 8, cost = 2048, time = 12.481, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0036713, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.119, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0049513, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.695, size = (1, 32, 32, 1), loss = 19.744, loss1 = 19.738, loss2 = 0.0059683, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.223, size = (1, 32, 32, 1), loss = 19.745, loss1 = 19.738, loss2 = 0.0072918, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.755, size = (1, 32, 32, 1), loss = 19.745, loss1 = 19.738, loss2 = 0.0077856, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.284, size = (1, 32, 32, 1), loss = 0.0086379, loss1 = 0, loss2 = 0.0086379, lr=0.01
saving outstep 0 and iteration 13
[STATS][L3](First valid attack found!) iter = 13, cost = 3584, time = 20.284, size = (1, 32, 32, 1), loss = 0.0086313, loss1 = 0, loss2 = 0.0086313
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.530, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00012234, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.076, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00027858, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.679, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00055158, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.370, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00098318, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.939, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0015919, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.480, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0023837, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.017, size = (1, 32, 32, 1), loss = 9.8719, loss1 = 9.8688, loss2 = 0.0031495, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.602, size = (1, 32, 32, 1), loss = 9.8728, loss1 = 9.8688, loss2 = 0.0040148, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.151, size = (1, 32, 32, 1), loss = 9.8739, loss1 = 9.8688, loss2 = 0.0051361, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.686, size = (1, 32, 32, 1), loss = 9.8752, loss1 = 9.8688, loss2 = 0.0064229, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.222, size = (1, 32, 32, 1), loss = 9.8762, loss1 = 9.8688, loss2 = 0.0073952, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.789, size = (1, 32, 32, 1), loss = 9.8771, loss1 = 9.8688, loss2 = 0.0083084, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.442, size = (1, 32, 32, 1), loss = 0.0093625, loss1 = 0, loss2 = 0.0093625, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 13, cost = 3584, time = 20.442, size = (1, 32, 32, 1), loss = 0.0093599, loss1 = 0, loss2 = 0.0093599
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  3.1594257634853573
l2_distortion between inputs and adv_current  3.1594257634853573
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.008637883
perceptual metrics distance between adv_current and img 0.008637883
normalized perceptual metrics distance between adv and img 2.999264850384659e-05
normalized perceptual metrics distance between adv_current and img 2.999264850384659e-05
perceptual hash difference is  10
Saving to id29_differ10_True_l23.16_pdistance0.008637882769107819
[STATS][L1] total = 30, id = 29, time = 45.283, success = True, const = 100.000000, hash_avg=10.06897, distortion = 3.15943, success_rate = 0.967, l2_avg=3.94068, p_avg=0.007264812922522682, iteration_avg=23.06896551724138
overall average l2  3.940680032504559
overal average perceptual distance  0.007264812922522682
overal average iterations  23.06896551724138
for image id  30
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.548, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 5.2986e-05, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.082, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00012795, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.628, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00021208, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.167, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00030722, lr=0.01
saving outstep 0 and iteration 4
[STATS][L2] iter = 5, cost = 1280, time = 7.725, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00042039, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.338, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00052973, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.915, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00066103, lr=0.01
saving outstep 0 and iteration 7
[STATS][L2] iter = 8, cost = 2048, time = 12.466, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00080338, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.065, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00094525, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.673, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0010999, lr=0.01
saving outstep 0 and iteration 10
[STATS][L2] iter = 11, cost = 2816, time = 17.195, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0012862, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.718, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0014589, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.262, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0016559, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.845, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0018357, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.454, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0020872, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 24.992, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0023083, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.546, size = (1, 32, 32, 1), loss = 0.0025464, loss1 = 0, loss2 = 0.0025464, lr=0.01
saving outstep 0 and iteration 17
[STATS][L3](First valid attack found!) iter = 17, cost = 4608, time = 26.546, size = (1, 32, 32, 1), loss = 0.002547, loss1 = 0, loss2 = 0.002547
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.781, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 5.3463e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.539, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00011694, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 5.082, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.0002042, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.672, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00030949, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 8.230, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.0004327, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.796, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00059398, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.327, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00073197, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.883, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00085225, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.425, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.0010399, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.989, size = (1, 32, 32, 1), loss = 9.87, loss1 = 9.8688, loss2 = 0.0012062, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.526, size = (1, 32, 32, 1), loss = 9.8701, loss1 = 9.8688, loss2 = 0.0013712, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 19.115, size = (1, 32, 32, 1), loss = 9.8704, loss1 = 9.8688, loss2 = 0.0016188, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.754, size = (1, 32, 32, 1), loss = 9.8706, loss1 = 9.8688, loss2 = 0.0018385, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.318, size = (1, 32, 32, 1), loss = 9.8708, loss1 = 9.8688, loss2 = 0.0020715, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.863, size = (1, 32, 32, 1), loss = 9.871, loss1 = 9.8688, loss2 = 0.0022799, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.414, size = (1, 32, 32, 1), loss = 9.8713, loss1 = 9.8688, loss2 = 0.0025711, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.963, size = (1, 32, 32, 1), loss = 0.0028642, loss1 = 0, loss2 = 0.0028642, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 17, cost = 4608, time = 26.963, size = (1, 32, 32, 1), loss = 0.0028645, loss1 = 0, loss2 = 0.0028645
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  4.011753323275057
l2_distortion between inputs and adv_current  4.011753323275057
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0025463286
perceptual metrics distance between adv_current and img 0.0025463286
normalized perceptual metrics distance between adv and img 8.841418699982265e-06
normalized perceptual metrics distance between adv_current and img 8.841418699982265e-06
perceptual hash difference is  10
Saving to id30_differ10_True_l24.01_pdistance0.0025463285855948925
[STATS][L1] total = 31, id = 30, time = 58.104, success = True, const = 100.000000, hash_avg=10.06667, distortion = 4.01175, success_rate = 0.968, l2_avg=3.94305, p_avg=0.007107530111291756, iteration_avg=22.9
overall average l2  3.943049142196909
overal average perceptual distance  0.007107530111291756
overal average iterations  22.9
for image id  31
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.576, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 9.7871e-05, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.129, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00021785, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.705, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00038522, lr=0.01
saving outstep 0 and iteration 3
[STATS][L2] iter = 4, cost = 1024, time = 6.248, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.0005409, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.800, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.0007713, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.372, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00094379, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.971, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.0011715, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.560, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0015086, lr=0.01
saving outstep 0 and iteration 8
[STATS][L2] iter = 9, cost = 2304, time = 14.091, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0018263, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.697, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0021294, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.271, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0026337, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.843, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0030736, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.377, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.003433, lr=0.01
saving outstep 0 and iteration 13
[STATS][L2] iter = 14, cost = 3584, time = 21.904, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0038736, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.437, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0042379, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 24.982, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.004714, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.507, size = (1, 32, 32, 1), loss = 0.0050979, loss1 = 0, loss2 = 0.0050979, lr=0.01
saving outstep 0 and iteration 17
[STATS][L3](First valid attack found!) iter = 17, cost = 4608, time = 26.507, size = (1, 32, 32, 1), loss = 0.0050987, loss1 = 0, loss2 = 0.0050987
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.611, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.0001065, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.195, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00027001, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.812, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00041846, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.363, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.000611, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.907, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00087232, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.438, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.0010577, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.966, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.001342, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.495, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0016466, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.017, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0019643, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.551, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0024272, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.126, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0029734, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.708, size = (1, 32, 32, 1), loss = 9.8721, loss1 = 9.8688, loss2 = 0.0033144, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.240, size = (1, 32, 32, 1), loss = 9.8724, loss1 = 9.8688, loss2 = 0.0036704, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.770, size = (1, 32, 32, 1), loss = 9.8729, loss1 = 9.8688, loss2 = 0.0041194, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.379, size = (1, 32, 32, 1), loss = 9.8734, loss1 = 9.8688, loss2 = 0.0046317, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 24.916, size = (1, 32, 32, 1), loss = 9.8737, loss1 = 9.8688, loss2 = 0.0049398, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.459, size = (1, 32, 32, 1), loss = 9.874, loss1 = 9.8688, loss2 = 0.0051912, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 27.980, size = (1, 32, 32, 1), loss = 9.8744, loss1 = 9.8688, loss2 = 0.0056492, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.550, size = (1, 32, 32, 1), loss = 9.8749, loss1 = 9.8688, loss2 = 0.0061163, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.115, size = (1, 32, 32, 1), loss = 0.0065608, loss1 = 0, loss2 = 0.0065608, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 20, cost = 5376, time = 31.115, size = (1, 32, 32, 1), loss = 0.0065633, loss1 = 0, loss2 = 0.0065633
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  3.7948043356062287
l2_distortion between inputs and adv_current  3.7948043356062287
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0050977604
perceptual metrics distance between adv_current and img 0.0050977604
normalized perceptual metrics distance between adv and img 1.7700556782074273e-05
normalized perceptual metrics distance between adv_current and img 1.7700556782074273e-05
perceptual hash difference is  10
Saving to id31_differ10_True_l23.79_pdistance0.0050977603532373905
[STATS][L1] total = 32, id = 31, time = 62.280, success = True, const = 100.000000, hash_avg=10.06452, distortion = 3.79480, success_rate = 0.969, l2_avg=3.93827, p_avg=0.007042698828773873, iteration_avg=22.741935483870968
ice:GPU:0
overall average l2  3.9382670516617257
overal average perceptual distance  0.007042698828773873
overal average iterations  22.741935483870968
for image id  32
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.554, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 6.9436e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.100, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00014359, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.618, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00028717, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.144, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00043607, lr=0.01
saving outstep 0 and iteration 4
[STATS][L2] iter = 5, cost = 1280, time = 7.702, size = (1, 32, 32, 1), loss = 19.738, loss1 = 19.738, loss2 = 0.00063874, lr=0.01
saving outstep 0 and iteration 5
[STATS][L2] iter = 6, cost = 1536, time = 9.262, size = (1, 32, 32, 1), loss = 19.738, loss1 = 19.738, loss2 = 0.00076035, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.849, size = (1, 32, 32, 1), loss = 0.0010218, loss1 = 0, loss2 = 0.0010218, lr=0.01
saving outstep 0 and iteration 7
[STATS][L3](First valid attack found!) iter = 7, cost = 2048, time = 10.849, size = (1, 32, 32, 1), loss = 0.0010222, loss1 = 0, loss2 = 0.0010222
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.641, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 6.6541e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.239, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00013493, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.780, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00024587, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.317, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00041393, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.855, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00061977, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.410, size = (1, 32, 32, 1), loss = 9.8697, loss1 = 9.8688, loss2 = 0.00091924, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.982, size = (1, 32, 32, 1), loss = 0.0011889, loss1 = 0, loss2 = 0.0011889, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 7, cost = 2048, time = 10.982, size = (1, 32, 32, 1), loss = 0.0011892, loss1 = 0, loss2 = 0.0011892
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  1.955591224853943
l2_distortion between inputs and adv_current  1.955591224853943
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0010217554
perceptual metrics distance between adv_current and img 0.0010217554
normalized perceptual metrics distance between adv and img 3.547761783314248e-06
normalized perceptual metrics distance between adv_current and img 3.547761783314248e-06
perceptual hash difference is  10
Saving to id32_differ10_True_l21.96_pdistance0.0010217553935945034
[STATS][L1] total = 33, id = 32, time = 26.308, success = True, const = 100.000000, hash_avg=10.06250, distortion = 1.95559, success_rate = 0.970, l2_avg=3.87631, p_avg=0.006854544346424518, iteration_avg=22.28125
k:0/device:GPU:0
overall average l2  3.8763084320739827
overal average perceptual distance  0.006854544346424518
overal average iterations  22.28125
for image id  33
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.523, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 2.677e-05, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.111, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 7.0686e-05, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.715, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00011765, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.275, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00017378, lr=0.01
saving outstep 0 and iteration 4
[STATS][L2] iter = 5, cost = 1280, time = 7.841, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00023468, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.388, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00029986, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.957, size = (1, 32, 32, 1), loss = 37.995, loss1 = 37.995, loss2 = 0.00037921, lr=0.01
saving outstep 0 and iteration 7
[STATS][L2] iter = 8, cost = 2048, time = 12.489, size = (1, 32, 32, 1), loss = 37.995, loss1 = 37.995, loss2 = 0.00046686, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.040, size = (1, 32, 32, 1), loss = 19.738, loss1 = 19.738, loss2 = 0.00056106, lr=0.01
saving outstep 0 and iteration 9
[STATS][L2] iter = 10, cost = 2560, time = 15.627, size = (1, 32, 32, 1), loss = 19.738, loss1 = 19.738, loss2 = 0.0006545, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.194, size = (1, 32, 32, 1), loss = 0.00077896, loss1 = 0, loss2 = 0.00077896, lr=0.01
saving outstep 0 and iteration 11
[STATS][L3](First valid attack found!) iter = 11, cost = 3072, time = 17.194, size = (1, 32, 32, 1), loss = 0.00077985, loss1 = 0, loss2 = 0.00077985
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.582, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 2.7409e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.211, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 6.3879e-05, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.756, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00010898, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.360, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00015419, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.892, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00021688, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.418, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00028921, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.942, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00035769, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.587, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00044423, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.288, size = (1, 32, 32, 1), loss = 9.8693, loss1 = 9.8688, loss2 = 0.00052328, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.886, size = (1, 32, 32, 1), loss = 9.8694, loss1 = 9.8688, loss2 = 0.00061194, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.500, size = (1, 32, 32, 1), loss = 9.8695, loss1 = 9.8688, loss2 = 0.00071341, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 19.048, size = (1, 32, 32, 1), loss = 0.00082325, loss1 = 0, loss2 = 0.00082325, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 12, cost = 3328, time = 19.048, size = (1, 32, 32, 1), loss = 0.00082383, loss1 = 0, loss2 = 0.00082383
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  2.818533478781142
l2_distortion between inputs and adv_current  2.818533478781142
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0007789751
perceptual metrics distance between adv_current and img 0.0007789751
normalized perceptual metrics distance between adv and img 2.704774588993233e-06
normalized perceptual metrics distance between adv_current and img 2.704774588993233e-06
perceptual hash difference is  10
Saving to id33_differ10_True_l22.82_pdistance0.0007789750816300511
[STATS][L1] total = 34, id = 33, time = 40.912, success = True, const = 100.000000, hash_avg=10.06061, distortion = 2.81853, success_rate = 0.971, l2_avg=3.84425, p_avg=0.006670436186885292, iteration_avg=21.96969696969697
ica:0/task:0/device:GPU:0
overall average l2  3.8442546456105635
overal average perceptual distance  0.006670436186885292
overal average iterations  21.96969696969697
for image id  34
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.518, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 4.7497e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.065, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00010839, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.628, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00019796, lr=0.01
saving outstep 0 and iteration 3
[STATS][L2] iter = 4, cost = 1024, time = 6.233, size = (1, 32, 32, 1), loss = 37.995, loss1 = 37.995, loss2 = 0.0003148, lr=0.01
saving outstep 0 and iteration 4
[STATS][L2] iter = 5, cost = 1280, time = 7.824, size = (1, 32, 32, 1), loss = 19.738, loss1 = 19.738, loss2 = 0.00041336, lr=0.01
saving outstep 0 and iteration 5
[STATS][L2] iter = 6, cost = 1536, time = 9.376, size = (1, 32, 32, 1), loss = 19.738, loss1 = 19.738, loss2 = 0.00056576, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.920, size = (1, 32, 32, 1), loss = 19.738, loss1 = 19.738, loss2 = 0.00069988, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.475, size = (1, 32, 32, 1), loss = 19.738, loss1 = 19.738, loss2 = 0.00082721, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.060, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.00099861, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.592, size = (1, 32, 32, 1), loss = 0.0011802, loss1 = 0, loss2 = 0.0011802, lr=0.01
saving outstep 0 and iteration 10
[STATS][L3](First valid attack found!) iter = 10, cost = 2816, time = 15.592, size = (1, 32, 32, 1), loss = 0.0011802, loss1 = 0, loss2 = 0.0011802
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.604, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 4.7042e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.186, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00012469, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.742, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00021689, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.284, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00033759, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.835, size = (1, 32, 32, 1), loss = 9.8692, loss1 = 9.8688, loss2 = 0.00044654, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.385, size = (1, 32, 32, 1), loss = 9.8693, loss1 = 9.8688, loss2 = 0.00055319, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.935, size = (1, 32, 32, 1), loss = 9.8695, loss1 = 9.8688, loss2 = 0.00071431, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.471, size = (1, 32, 32, 1), loss = 9.8696, loss1 = 9.8688, loss2 = 0.00083717, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.025, size = (1, 32, 32, 1), loss = 9.8697, loss1 = 9.8688, loss2 = 0.00093893, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.593, size = (1, 32, 32, 1), loss = 9.8699, loss1 = 9.8688, loss2 = 0.0010925, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.173, size = (1, 32, 32, 1), loss = 9.87, loss1 = 9.8688, loss2 = 0.0012299, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.716, size = (1, 32, 32, 1), loss = 9.8702, loss1 = 9.8688, loss2 = 0.0013938, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.302, size = (1, 32, 32, 1), loss = 0.0015543, loss1 = 0, loss2 = 0.0015543, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 13, cost = 3584, time = 20.302, size = (1, 32, 32, 1), loss = 0.0015545, loss1 = 0, loss2 = 0.0015545
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  2.438179620774287
l2_distortion between inputs and adv_current  2.438179620774287
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0011799195
perceptual metrics distance between adv_current and img 0.0011799195
normalized perceptual metrics distance between adv and img 4.096942575415596e-06
normalized perceptual metrics distance between adv_current and img 4.096942575415596e-06
perceptual hash difference is  10
Saving to id34_differ10_True_l22.44_pdistance0.0011799194617196918
[STATS][L1] total = 35, id = 34, time = 40.478, success = True, const = 100.000000, hash_avg=10.05882, distortion = 2.43818, success_rate = 0.971, l2_avg=3.80290, p_avg=0.00650895040085101, iteration_avg=21.647058823529413
overall average l2  3.8028994978212616
overal average perceptual distance  0.00650895040085101
overal average iterations  21.647058823529413
for image id  35
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.604, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.0001934, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.325, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00040437, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.928, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00061998, lr=0.01
saving outstep 0 and iteration 3
[STATS][L2] iter = 4, cost = 1024, time = 6.556, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00094051, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 8.120, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0013235, lr=0.01
saving outstep 0 and iteration 5
[STATS][L2] iter = 6, cost = 1536, time = 9.647, size = (1, 32, 32, 1), loss = 0.0017248, loss1 = 0, loss2 = 0.0017248, lr=0.01
saving outstep 0 and iteration 6
[STATS][L3](First valid attack found!) iter = 6, cost = 1792, time = 9.647, size = (1, 32, 32, 1), loss = 0.0017236, loss1 = 0, loss2 = 0.0017236
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.531, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00018119, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.101, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00040925, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.660, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00071296, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.372, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0010761, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.935, size = (1, 32, 32, 1), loss = 9.8702, loss1 = 9.8688, loss2 = 0.0013843, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.491, size = (1, 32, 32, 1), loss = 0.0018648, loss1 = 0, loss2 = 0.0018648, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 6, cost = 1792, time = 9.491, size = (1, 32, 32, 1), loss = 0.001866, loss1 = 0, loss2 = 0.001866
replica:0/task:0/device:GPU:0
Device mapping:
iEarly stopping because we found the adversarial example
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  1.9570962709270672
l2_distortion between inputs and adv_current  1.9570962709270672
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0017249605
perceptual metrics distance between adv_current and img 0.0017249605
normalized perceptual metrics distance between adv and img 5.989446233595825e-06
normalized perceptual metrics distance between adv_current and img 5.989446233595825e-06
perceptual hash difference is  10
Saving to id35_differ10_True_l21.96_pdistance0.0017249605152755976
[STATS][L1] total = 36, id = 35, time = 23.762, success = True, const = 100.000000, hash_avg=10.05714, distortion = 1.95710, success_rate = 0.972, l2_avg=3.75016, p_avg=0.006372264975548855, iteration_avg=21.228571428571428
overall average l2  3.750162262767141
overal average perceptual distance  0.006372264975548855
overal average iterations  21.228571428571428
for image id  36
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.599, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00026611, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.150, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.001099, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.719, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0027398, lr=0.01
saving outstep 0 and iteration 3
[STATS][L2] iter = 4, cost = 1024, time = 6.384, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0050165, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.948, size = (1, 32, 32, 1), loss = 0.0078256, loss1 = 0, loss2 = 0.0078256, lr=0.01
saving outstep 0 and iteration 5
[STATS][L3](First valid attack found!) iter = 5, cost = 1536, time = 7.948, size = (1, 32, 32, 1), loss = 0.0078243, loss1 = 0, loss2 = 0.0078243
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.577, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00034622, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.128, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.0011796, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.674, size = (1, 32, 32, 1), loss = 9.8715, loss1 = 9.8688, loss2 = 0.0027398, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.209, size = (1, 32, 32, 1), loss = 9.8739, loss1 = 9.8688, loss2 = 0.0051318, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.763, size = (1, 32, 32, 1), loss = 0.0081062, loss1 = 0, loss2 = 0.0081062, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 5, cost = 1536, time = 7.763, size = (1, 32, 32, 1), loss = 0.008106, loss1 = 0, loss2 = 0.008106
eplica:0/task:0/device:GPU:0
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  1.5470344559489497
l2_distortion between inputs and adv_current  1.5470344559489497
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.007825468
perceptual metrics distance between adv_current and img 0.007825468
normalized perceptual metrics distance between adv and img 2.7171762970586617e-05
normalized perceptual metrics distance between adv_current and img 2.7171762970586617e-05
perceptual hash difference is  12
Saving to id36_differ12_True_l21.55_pdistance0.007825467735528946
[STATS][L1] total = 37, id = 36, time = 20.491, success = True, const = 100.000000, hash_avg=10.11111, distortion = 1.54703, success_rate = 0.973, l2_avg=3.68896, p_avg=0.006412631718881635, iteration_avg=20.805555555555557
evice:GPU:0
overall average l2  3.6889642681333026
overal average perceptual distance  0.006412631718881635
overal average iterations  20.805555555555557
for image id  37
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.562, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 3.3715e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.204, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 8.6129e-05, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.781, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00015583, lr=0.01
saving outstep 0 and iteration 3
[STATS][L2] iter = 4, cost = 1024, time = 6.344, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00024191, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.879, size = (1, 32, 32, 1), loss = 37.995, loss1 = 37.995, loss2 = 0.00034136, lr=0.01
saving outstep 0 and iteration 5
[STATS][L2] iter = 6, cost = 1536, time = 9.416, size = (1, 32, 32, 1), loss = 37.995, loss1 = 37.995, loss2 = 0.00044354, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.996, size = (1, 32, 32, 1), loss = 37.995, loss1 = 37.995, loss2 = 0.00055085, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.585, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00066239, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.217, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00078479, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.820, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00090401, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.430, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0010323, lr=0.01
saving outstep 0 and iteration 11
[STATS][L2] iter = 12, cost = 3072, time = 18.999, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0011583, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.581, size = (1, 32, 32, 1), loss = 0.0013042, loss1 = 0, loss2 = 0.0013042, lr=0.01
saving outstep 0 and iteration 13
[STATS][L3](First valid attack found!) iter = 13, cost = 3584, time = 20.581, size = (1, 32, 32, 1), loss = 0.0013038, loss1 = 0, loss2 = 0.0013038
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.547, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 3.7981e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.088, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 8.9243e-05, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.666, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00016541, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.249, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00023869, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.835, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00033382, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.482, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.0004406, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.029, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00056529, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.639, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00067196, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.167, size = (1, 32, 32, 1), loss = 9.8696, loss1 = 9.8688, loss2 = 0.00079838, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.772, size = (1, 32, 32, 1), loss = 9.8697, loss1 = 9.8688, loss2 = 0.00091449, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.287, size = (1, 32, 32, 1), loss = 9.8698, loss1 = 9.8688, loss2 = 0.0010695, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.889, size = (1, 32, 32, 1), loss = 9.87, loss1 = 9.8688, loss2 = 0.0012246, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.498, size = (1, 32, 32, 1), loss = 9.8702, loss1 = 9.8688, loss2 = 0.0013982, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.078, size = (1, 32, 32, 1), loss = 9.8703, loss1 = 9.8688, loss2 = 0.0015833, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.629, size = (1, 32, 32, 1), loss = 0.0017604, loss1 = 0, loss2 = 0.0017604, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 15, cost = 4096, time = 23.629, size = (1, 32, 32, 1), loss = 0.0017606, loss1 = 0, loss2 = 0.0017606
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  2.8717566834115758
l2_distortion between inputs and adv_current  2.8717566834115758
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0013041529
perceptual metrics distance between adv_current and img 0.0013041529
normalized perceptual metrics distance between adv and img 4.528308636508882e-06
normalized perceptual metrics distance between adv_current and img 4.528308636508882e-06
perceptual hash difference is  10
Saving to id37_differ10_True_l22.87_pdistance0.001304152887314558
[STATS][L1] total = 38, id = 37, time = 49.056, success = True, const = 100.000000, hash_avg=10.10811, distortion = 2.87176, success_rate = 0.974, l2_avg=3.66688, p_avg=0.006274564723433876, iteration_avg=20.62162162162162
lica:0/task:0/device:GPU:0
overall average l2  3.666877576654337
overal average perceptual distance  0.006274564723433876
overal average iterations  20.62162162162162
for image id  38
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.526, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 2.6606e-05, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.076, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 6.8856e-05, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.647, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00011734, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.266, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00017008, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.831, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00023449, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.387, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00029681, lr=0.01
saving outstep 0 and iteration 6
[STATS][L2] iter = 7, cost = 1792, time = 10.956, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00039018, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.509, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00047448, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.049, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00059375, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.584, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00070897, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.156, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00081331, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.728, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00092766, lr=0.01
saving outstep 0 and iteration 12
[STATS][L2] iter = 13, cost = 3328, time = 20.396, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0010612, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.021, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0011972, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.703, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0013614, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.328, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0015317, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.875, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0016594, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.408, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0018761, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.967, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0020218, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.552, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.002199, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 33.100, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0023829, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.675, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0025303, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 36.231, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0026982, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.778, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0028985, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 39.293, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0030377, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 40.836, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0032236, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.379, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0034317, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 43.930, size = (1, 32, 32, 1), loss = 37.999, loss1 = 37.995, loss2 = 0.0036204, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.499, size = (1, 32, 32, 1), loss = 37.999, loss1 = 37.995, loss2 = 0.0037796, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 47.051, size = (1, 32, 32, 1), loss = 37.999, loss1 = 37.995, loss2 = 0.003921, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 48.607, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0040407, lr=0.01
saving outstep 0 and iteration 31
[STATS][L2] iter = 32, cost = 8192, time = 50.161, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0041917, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 51.715, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.004393, lr=0.01
[STATS][L2] iter = 34, cost = 8704, time = 53.259, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0045905, lr=0.01
[STATS][L2] iter = 35, cost = 8960, time = 54.799, size = (1, 32, 32, 1), loss = 19.742, loss1 = 19.738, loss2 = 0.0048071, lr=0.01
[STATS][L2] iter = 36, cost = 9216, time = 56.335, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0049697, lr=0.01
[STATS][L2] iter = 37, cost = 9472, time = 57.871, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0051615, lr=0.01
[STATS][L2] iter = 38, cost = 9728, time = 59.452, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0053461, lr=0.01
[STATS][L2] iter = 39, cost = 9984, time = 61.085, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0055491, lr=0.01
[STATS][L2] iter = 40, cost = 10240, time = 62.669, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.005761, lr=0.01
[STATS][L2] iter = 41, cost = 10496, time = 64.229, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0059284, lr=0.01
[STATS][L2] iter = 42, cost = 10752, time = 65.787, size = (1, 32, 32, 1), loss = 19.744, loss1 = 19.738, loss2 = 0.0061193, lr=0.01
[STATS][L2] iter = 43, cost = 11008, time = 67.353, size = (1, 32, 32, 1), loss = 19.744, loss1 = 19.738, loss2 = 0.006323, lr=0.01
[STATS][L2] iter = 44, cost = 11264, time = 68.875, size = (1, 32, 32, 1), loss = 19.744, loss1 = 19.738, loss2 = 0.0064899, lr=0.01
[STATS][L2] iter = 45, cost = 11520, time = 70.465, size = (1, 32, 32, 1), loss = 19.744, loss1 = 19.738, loss2 = 0.0066673, lr=0.01
[STATS][L2] iter = 46, cost = 11776, time = 72.016, size = (1, 32, 32, 1), loss = 19.744, loss1 = 19.738, loss2 = 0.0068598, lr=0.01
[STATS][L2] iter = 47, cost = 12032, time = 73.801, size = (1, 32, 32, 1), loss = 19.745, loss1 = 19.738, loss2 = 0.0070775, lr=0.01
[STATS][L2] iter = 48, cost = 12288, time = 75.541, size = (1, 32, 32, 1), loss = 19.745, loss1 = 19.738, loss2 = 0.007253, lr=0.01
[STATS][L2] iter = 49, cost = 12544, time = 77.106, size = (1, 32, 32, 1), loss = 19.745, loss1 = 19.738, loss2 = 0.0074771, lr=0.01
[STATS][L2] iter = 50, cost = 12800, time = 78.723, size = (1, 32, 32, 1), loss = 19.745, loss1 = 19.738, loss2 = 0.0076629, lr=0.01
[STATS][L2] iter = 51, cost = 13056, time = 80.301, size = (1, 32, 32, 1), loss = 0.0078595, loss1 = 0, loss2 = 0.0078595, lr=0.01
saving outstep 0 and iteration 51
[STATS][L3](First valid attack found!) iter = 51, cost = 13312, time = 80.301, size = (1, 32, 32, 1), loss = 0.0078581, loss1 = 0, loss2 = 0.0078581
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.542, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 2.8061e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.268, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 6.4865e-05, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.832, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00011174, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.419, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00018289, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.999, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00027013, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.561, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00033911, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.130, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00043259, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.738, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00050202, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.270, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00060109, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.795, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00072083, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.319, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.0008018, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.901, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00092658, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.470, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0010797, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.061, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.001218, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.609, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0013582, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.153, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0015028, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.801, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0016694, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.363, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0018039, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.926, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0019854, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.454, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0021533, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 33.026, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0023233, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.656, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0025064, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 36.286, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0026557, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.908, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0028352, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 39.503, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0030126, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 41.060, size = (1, 32, 32, 1), loss = 19.001, loss1 = 18.997, loss2 = 0.0031701, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.617, size = (1, 32, 32, 1), loss = 9.8721, loss1 = 9.8688, loss2 = 0.0033166, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 44.155, size = (1, 32, 32, 1), loss = 9.8722, loss1 = 9.8688, loss2 = 0.0034812, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.810, size = (1, 32, 32, 1), loss = 9.8724, loss1 = 9.8688, loss2 = 0.0036514, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 47.383, size = (1, 32, 32, 1), loss = 9.8726, loss1 = 9.8688, loss2 = 0.0038446, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 48.955, size = (1, 32, 32, 1), loss = 9.8728, loss1 = 9.8688, loss2 = 0.0040085, lr=0.01
[STATS][L2] iter = 32, cost = 8192, time = 50.679, size = (1, 32, 32, 1), loss = 9.873, loss1 = 9.8688, loss2 = 0.0042002, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 52.227, size = (1, 32, 32, 1), loss = 9.8731, loss1 = 9.8688, loss2 = 0.0043718, lr=0.01
[STATS][L2] iter = 34, cost = 8704, time = 53.799, size = (1, 32, 32, 1), loss = 9.8734, loss1 = 9.8688, loss2 = 0.0046039, lr=0.01
[STATS][L2] iter = 35, cost = 8960, time = 55.329, size = (1, 32, 32, 1), loss = 9.8736, loss1 = 9.8688, loss2 = 0.0048053, lr=0.01
[STATS][L2] iter = 36, cost = 9216, time = 56.847, size = (1, 32, 32, 1), loss = 9.8738, loss1 = 9.8688, loss2 = 0.0049891, lr=0.01
[STATS][L2] iter = 37, cost = 9472, time = 58.377, size = (1, 32, 32, 1), loss = 9.874, loss1 = 9.8688, loss2 = 0.0052179, lr=0.01
[STATS][L2] iter = 38, cost = 9728, time = 59.892, size = (1, 32, 32, 1), loss = 9.8742, loss1 = 9.8688, loss2 = 0.0054097, lr=0.01
[STATS][L2] iter = 39, cost = 9984, time = 61.450, size = (1, 32, 32, 1), loss = 9.8743, loss1 = 9.8688, loss2 = 0.0055769, lr=0.01
[STATS][L2] iter = 40, cost = 10240, time = 63.175, size = (1, 32, 32, 1), loss = 0.0056911, loss1 = 0, loss2 = 0.0056911, lr=0.01
saving outstep 1 and iteration 40
[STATS][L3](Attack found!) iter = 40, cost = 10496, time = 63.175, size = (1, 32, 32, 1), loss = 0.0056924, loss1 = 0, loss2 = 0.0056924
PU:0
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  6.833926369586015
l2_distortion between inputs and adv_current  6.833926369586015
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0056910436
perceptual metrics distance between adv_current and img 0.0056910436
normalized perceptual metrics distance between adv and img 1.97605679406681e-05
normalized perceptual metrics distance between adv_current and img 1.97605679406681e-05
perceptual hash difference is  10
Saving to id38_differ10_True_l26.83_pdistance0.005691043566912413
[STATS][L1] total = 39, id = 38, time = 148.799, success = True, const = 50.000000, hash_avg=10.10526, distortion = 6.83393, success_rate = 0.974, l2_avg=3.75022, p_avg=0.006259208903525416, iteration_avg=21.44736842105263
0
overall average l2  3.7502209659420127
overal average perceptual distance  0.006259208903525416
overal average iterations  21.44736842105263
for image id  39
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.537, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00010295, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.054, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00023746, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.602, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00043891, lr=0.01
saving outstep 0 and iteration 3
[STATS][L2] iter = 4, cost = 1024, time = 6.194, size = (1, 32, 32, 1), loss = 19.738, loss1 = 19.738, loss2 = 0.00063328, lr=0.01
saving outstep 0 and iteration 4
[STATS][L2] iter = 5, cost = 1280, time = 7.872, size = (1, 32, 32, 1), loss = 19.738, loss1 = 19.738, loss2 = 0.0008938, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.506, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0011703, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.061, size = (1, 32, 32, 1), loss = 0.0014683, loss1 = 0, loss2 = 0.0014683, lr=0.01
saving outstep 0 and iteration 7
[STATS][L3](First valid attack found!) iter = 7, cost = 2048, time = 11.061, size = (1, 32, 32, 1), loss = 0.0014661, loss1 = 0, loss2 = 0.0014661
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.553, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0.00013157, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.089, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.0002745, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.659, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00044141, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.198, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00065192, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.753, size = (1, 32, 32, 1), loss = 9.8696, loss1 = 9.8688, loss2 = 0.00087214, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.379, size = (1, 32, 32, 1), loss = 9.87, loss1 = 9.8688, loss2 = 0.0011954, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.927, size = (1, 32, 32, 1), loss = 9.8702, loss1 = 9.8688, loss2 = 0.0014426, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.618, size = (1, 32, 32, 1), loss = 0.0017352, loss1 = 0, loss2 = 0.0017352, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 8, cost = 2304, time = 12.618, size = (1, 32, 32, 1), loss = 0.0017338, loss1 = 0, loss2 = 0.0017338
host/replica:0/task:0/device:GPU:0
Device mapping:
iEarly stopping because we found the adversarial example
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  1.902415326323821
l2_distortion between inputs and adv_current  1.902415326323821
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0014684239
perceptual metrics distance between adv_current and img 0.0014684239
normalized perceptual metrics distance between adv and img 5.0986939944171654e-06
normalized perceptual metrics distance between adv_current and img 5.0986939944171654e-06
perceptual hash difference is  10
Saving to id39_differ10_True_l21.90_pdistance0.0014684238703921437
[STATS][L1] total = 40, id = 39, time = 28.367, success = True, const = 100.000000, hash_avg=10.10256, distortion = 1.90242, success_rate = 0.975, l2_avg=3.70284, p_avg=0.006136368261650205, iteration_avg=21.102564102564102
overall average l2  3.702841334156931
overal average perceptual distance  0.006136368261650205
overal average iterations  21.102564102564102
for image id  40
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.543, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 5.3743e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.115, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00012863, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.670, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00023015, lr=0.01
saving outstep 0 and iteration 3
[STATS][L2] iter = 4, cost = 1024, time = 6.229, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00036436, lr=0.01
saving outstep 0 and iteration 4
[STATS][L2] iter = 5, cost = 1280, time = 7.822, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00055984, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.362, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00070623, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.909, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00089455, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.436, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0010711, lr=0.01
saving outstep 0 and iteration 8
[STATS][L2] iter = 9, cost = 2304, time = 13.992, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0013409, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.541, size = (1, 32, 32, 1), loss = 0.0015175, loss1 = 0, loss2 = 0.0015175, lr=0.01
saving outstep 0 and iteration 10
[STATS][L3](First valid attack found!) iter = 10, cost = 2816, time = 15.541, size = (1, 32, 32, 1), loss = 0.0015177, loss1 = 0, loss2 = 0.0015177
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.603, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 6.1213e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.198, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0.00014255, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.754, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00026705, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.342, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00040942, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.896, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00060148, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.481, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00078813, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.015, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.0010457, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.570, size = (1, 32, 32, 1), loss = 9.8701, loss1 = 9.8688, loss2 = 0.0013597, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.161, size = (1, 32, 32, 1), loss = 9.8704, loss1 = 9.8688, loss2 = 0.0016158, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.977, size = (1, 32, 32, 1), loss = 9.8707, loss1 = 9.8688, loss2 = 0.0018836, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.529, size = (1, 32, 32, 1), loss = 0.0020998, loss1 = 0, loss2 = 0.0020998, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 11, cost = 3072, time = 17.529, size = (1, 32, 32, 1), loss = 0.0020995, loss1 = 0, loss2 = 0.0020995
:localhost/replica:0/task:0/device:GPU:0
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  2.6355006644796326
l2_distortion between inputs and adv_current  2.6355006644796326
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.001517438
perceptual metrics distance between adv_current and img 0.001517438
normalized perceptual metrics distance between adv and img 5.268881876771856e-06
normalized perceptual metrics distance between adv_current and img 5.268881876771856e-06
perceptual hash difference is  10
Saving to id40_differ10_True_l22.64_pdistance0.0015174379805102944
[STATS][L1] total = 41, id = 40, time = 37.889, success = True, const = 100.000000, hash_avg=10.10000, distortion = 2.63550, success_rate = 0.976, l2_avg=3.67616, p_avg=0.006020895004621707, iteration_avg=20.85
ask:0/device:GPU:0
overall average hash  10.1
overall average l2  3.6761578174149983
overal average perceptual distance  0.006020895004621707
overal average iterations  20.85
for image id  41
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.557, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 5.5658e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.143, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00012659, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.722, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00021133, lr=0.01
saving outstep 0 and iteration 3
[STATS][L2] iter = 4, cost = 1024, time = 6.275, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00032684, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.810, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00042491, lr=0.01
saving outstep 0 and iteration 5
[STATS][L2] iter = 6, cost = 1536, time = 9.347, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00057097, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.878, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00072588, lr=0.01
saving outstep 0 and iteration 7
[STATS][L2] iter = 8, cost = 2048, time = 12.419, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00085875, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 13.959, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0010401, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.500, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0012361, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.099, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.001438, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.742, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0016556, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.293, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0018478, lr=0.01
saving outstep 0 and iteration 13
[STATS][L2] iter = 14, cost = 3584, time = 21.824, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0020839, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.366, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.002308, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 24.933, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0025576, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.467, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0028181, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 27.993, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0030411, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.554, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0033018, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.185, size = (1, 32, 32, 1), loss = 0.0035509, loss1 = 0, loss2 = 0.0035509, lr=0.01
saving outstep 0 and iteration 20
[STATS][L3](First valid attack found!) iter = 20, cost = 5376, time = 31.185, size = (1, 32, 32, 1), loss = 0.0035519, loss1 = 0, loss2 = 0.0035519
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.556, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 5.1239e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.099, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0.0001147, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.704, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00019903, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.317, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00030229, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.846, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00042983, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.372, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00056001, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.930, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.000709, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.512, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00086653, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.140, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.0010094, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.907, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0011761, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.442, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0013585, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 19.038, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0015568, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.559, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0017582, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.074, size = (1, 32, 32, 1), loss = 9.8707, loss1 = 9.8688, loss2 = 0.0019739, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.683, size = (1, 32, 32, 1), loss = 9.871, loss1 = 9.8688, loss2 = 0.0021929, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.257, size = (1, 32, 32, 1), loss = 9.8712, loss1 = 9.8688, loss2 = 0.0024211, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.852, size = (1, 32, 32, 1), loss = 9.8714, loss1 = 9.8688, loss2 = 0.0026421, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.440, size = (1, 32, 32, 1), loss = 9.8716, loss1 = 9.8688, loss2 = 0.002833, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 30.053, size = (1, 32, 32, 1), loss = 9.8718, loss1 = 9.8688, loss2 = 0.0030781, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.584, size = (1, 32, 32, 1), loss = 0.0032848, loss1 = 0, loss2 = 0.0032848, lr=0.01
saving outstep 1 and iteration 20
[STATS][L3](Attack found!) iter = 20, cost = 5376, time = 31.584, size = (1, 32, 32, 1), loss = 0.0032871, loss1 = 0, loss2 = 0.0032871
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  3.928494250607791
l2_distortion between inputs and adv_current  3.928494250607791
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.00328508
perceptual metrics distance between adv_current and img 0.00328508
normalized perceptual metrics distance between adv and img 1.1406527644592441e-05
normalized perceptual metrics distance between adv_current and img 1.1406527644592441e-05
perceptual hash difference is  10
Saving to id41_differ10_True_l23.93_pdistance0.003285079961642623
[STATS][L1] total = 42, id = 41, time = 67.790, success = True, const = 50.000000, hash_avg=10.09756, distortion = 3.92849, success_rate = 0.976, l2_avg=3.68231, p_avg=0.005954167808451485, iteration_avg=20.853658536585368
impoverall average hash  10.097560975609756
overall average l2  3.6823123645660423
overal average perceptual distance  0.005954167808451485
overal average iterations  20.853658536585368
for image id  42
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.551, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 5.3824e-05, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.336, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00013794, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.922, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00023032, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.712, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00034584, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 8.235, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00048069, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.765, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00062215, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.322, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00075281, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.867, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00095652, lr=0.01
saving outstep 0 and iteration 8
[STATS][L2] iter = 9, cost = 2304, time = 14.406, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.0011898, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.968, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.0015074, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.686, size = (1, 32, 32, 1), loss = 53.707, loss1 = 53.705, loss2 = 0.0017711, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 19.221, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0020907, lr=0.01
saving outstep 0 and iteration 12
[STATS][L2] iter = 13, cost = 3328, time = 20.775, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0024521, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.303, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0028035, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.842, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0031305, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.373, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0035172, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.911, size = (1, 32, 32, 1), loss = 37.999, loss1 = 37.995, loss2 = 0.0039259, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.461, size = (1, 32, 32, 1), loss = 37.999, loss1 = 37.995, loss2 = 0.0043723, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 30.050, size = (1, 32, 32, 1), loss = 38, loss1 = 37.995, loss2 = 0.0047693, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.865, size = (1, 32, 32, 1), loss = 38, loss1 = 37.995, loss2 = 0.0051675, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 33.522, size = (1, 32, 32, 1), loss = 38.001, loss1 = 37.995, loss2 = 0.0056176, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 35.045, size = (1, 32, 32, 1), loss = 38.001, loss1 = 37.995, loss2 = 0.0061227, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 36.577, size = (1, 32, 32, 1), loss = 38.002, loss1 = 37.995, loss2 = 0.0066388, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 38.121, size = (1, 32, 32, 1), loss = 38.002, loss1 = 37.995, loss2 = 0.007047, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 39.667, size = (1, 32, 32, 1), loss = 38.002, loss1 = 37.995, loss2 = 0.0074156, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 41.198, size = (1, 32, 32, 1), loss = 38.003, loss1 = 37.995, loss2 = 0.0076938, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.740, size = (1, 32, 32, 1), loss = 38.003, loss1 = 37.995, loss2 = 0.0079965, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 44.335, size = (1, 32, 32, 1), loss = 38.003, loss1 = 37.995, loss2 = 0.0084081, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.888, size = (1, 32, 32, 1), loss = 38.004, loss1 = 37.995, loss2 = 0.0086178, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 47.493, size = (1, 32, 32, 1), loss = 38.004, loss1 = 37.995, loss2 = 0.0090504, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 49.033, size = (1, 32, 32, 1), loss = 38.004, loss1 = 37.995, loss2 = 0.0093847, lr=0.01
[STATS][L2] iter = 32, cost = 8192, time = 50.602, size = (1, 32, 32, 1), loss = 38.005, loss1 = 37.995, loss2 = 0.0098614, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 52.144, size = (1, 32, 32, 1), loss = 38.005, loss1 = 37.995, loss2 = 0.010225, lr=0.01
[STATS][L2] iter = 34, cost = 8704, time = 53.678, size = (1, 32, 32, 1), loss = 19.748, loss1 = 19.738, loss2 = 0.010647, lr=0.01
saving outstep 0 and iteration 34
[STATS][L2] iter = 35, cost = 8960, time = 55.224, size = (1, 32, 32, 1), loss = 19.748, loss1 = 19.738, loss2 = 0.010964, lr=0.01
[STATS][L2] iter = 36, cost = 9216, time = 56.781, size = (1, 32, 32, 1), loss = 19.749, loss1 = 19.738, loss2 = 0.01159, lr=0.01
[STATS][L2] iter = 37, cost = 9472, time = 58.351, size = (1, 32, 32, 1), loss = 19.75, loss1 = 19.738, loss2 = 0.012089, lr=0.01
[STATS][L2] iter = 38, cost = 9728, time = 60.001, size = (1, 32, 32, 1), loss = 19.75, loss1 = 19.738, loss2 = 0.012623, lr=0.01
[STATS][L2] iter = 39, cost = 9984, time = 61.566, size = (1, 32, 32, 1), loss = 19.751, loss1 = 19.738, loss2 = 0.013012, lr=0.01
[STATS][L2] iter = 40, cost = 10240, time = 63.125, size = (1, 32, 32, 1), loss = 19.751, loss1 = 19.738, loss2 = 0.013504, lr=0.01
[STATS][L2] iter = 41, cost = 10496, time = 64.690, size = (1, 32, 32, 1), loss = 19.752, loss1 = 19.738, loss2 = 0.014018, lr=0.01
[STATS][L2] iter = 42, cost = 10752, time = 66.439, size = (1, 32, 32, 1), loss = 19.752, loss1 = 19.738, loss2 = 0.01454, lr=0.01
[STATS][L2] iter = 43, cost = 11008, time = 67.968, size = (1, 32, 32, 1), loss = 19.752, loss1 = 19.738, loss2 = 0.01495, lr=0.01
[STATS][L2] iter = 44, cost = 11264, time = 69.496, size = (1, 32, 32, 1), loss = 19.753, loss1 = 19.738, loss2 = 0.015469, lr=0.01
[STATS][L2] iter = 45, cost = 11520, time = 71.097, size = (1, 32, 32, 1), loss = 19.753, loss1 = 19.738, loss2 = 0.015874, lr=0.01
[STATS][L2] iter = 46, cost = 11776, time = 72.703, size = (1, 32, 32, 1), loss = 19.754, loss1 = 19.738, loss2 = 0.016166, lr=0.01
[STATS][L2] iter = 47, cost = 12032, time = 74.376, size = (1, 32, 32, 1), loss = 19.754, loss1 = 19.738, loss2 = 0.016674, lr=0.01
[STATS][L2] iter = 48, cost = 12288, time = 75.919, size = (1, 32, 32, 1), loss = 19.755, loss1 = 19.738, loss2 = 0.017179, lr=0.01
[STATS][L2] iter = 49, cost = 12544, time = 77.481, size = (1, 32, 32, 1), loss = 19.755, loss1 = 19.738, loss2 = 0.017588, lr=0.01
[STATS][L2] iter = 50, cost = 12800, time = 79.027, size = (1, 32, 32, 1), loss = 19.756, loss1 = 19.738, loss2 = 0.018038, lr=0.01
[STATS][L2] iter = 51, cost = 13056, time = 80.576, size = (1, 32, 32, 1), loss = 19.756, loss1 = 19.738, loss2 = 0.018398, lr=0.01
[STATS][L2] iter = 52, cost = 13312, time = 82.125, size = (1, 32, 32, 1), loss = 19.756, loss1 = 19.738, loss2 = 0.018618, lr=0.01
[STATS][L2] iter = 53, cost = 13568, time = 83.656, size = (1, 32, 32, 1), loss = 0.018867, loss1 = 0, loss2 = 0.018867, lr=0.01
saving outstep 0 and iteration 53
[STATS][L3](First valid attack found!) iter = 53, cost = 13824, time = 83.656, size = (1, 32, 32, 1), loss = 0.018865, loss1 = 0, loss2 = 0.018865
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.573, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 5.0209e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.149, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00012395, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.719, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00022801, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.258, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00038059, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.814, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00052282, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.424, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.00072601, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.945, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.00089573, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.490, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.0010409, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.074, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.0012318, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.703, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.0014604, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.304, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.0017156, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.859, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.00198, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.414, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0022409, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.956, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.002491, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.480, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0028079, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.032, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.003032, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.586, size = (1, 32, 32, 1), loss = 19.001, loss1 = 18.997, loss2 = 0.0034721, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.139, size = (1, 32, 32, 1), loss = 19.001, loss1 = 18.997, loss2 = 0.00385, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.721, size = (1, 32, 32, 1), loss = 19.002, loss1 = 18.997, loss2 = 0.0041711, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.290, size = (1, 32, 32, 1), loss = 19.002, loss1 = 18.997, loss2 = 0.0044499, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.835, size = (1, 32, 32, 1), loss = 19.002, loss1 = 18.997, loss2 = 0.0047899, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.422, size = (1, 32, 32, 1), loss = 19.003, loss1 = 18.997, loss2 = 0.0052991, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 35.942, size = (1, 32, 32, 1), loss = 19.003, loss1 = 18.997, loss2 = 0.0056606, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.475, size = (1, 32, 32, 1), loss = 19.004, loss1 = 18.997, loss2 = 0.0060594, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 39.032, size = (1, 32, 32, 1), loss = 19.004, loss1 = 18.997, loss2 = 0.0065541, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 40.584, size = (1, 32, 32, 1), loss = 19.004, loss1 = 18.997, loss2 = 0.0070262, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.142, size = (1, 32, 32, 1), loss = 19.005, loss1 = 18.997, loss2 = 0.0075241, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 43.708, size = (1, 32, 32, 1), loss = 19.005, loss1 = 18.997, loss2 = 0.0078682, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.265, size = (1, 32, 32, 1), loss = 19.006, loss1 = 18.997, loss2 = 0.008332, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 46.790, size = (1, 32, 32, 1), loss = 19.006, loss1 = 18.997, loss2 = 0.0087844, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 48.330, size = (1, 32, 32, 1), loss = 19.007, loss1 = 18.997, loss2 = 0.0093578, lr=0.01
[STATS][L2] iter = 32, cost = 8192, time = 49.860, size = (1, 32, 32, 1), loss = 19.007, loss1 = 18.997, loss2 = 0.010033, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 51.382, size = (1, 32, 32, 1), loss = 19.008, loss1 = 18.997, loss2 = 0.010485, lr=0.01
[STATS][L2] iter = 34, cost = 8704, time = 52.945, size = (1, 32, 32, 1), loss = 19.008, loss1 = 18.997, loss2 = 0.010795, lr=0.01
[STATS][L2] iter = 35, cost = 8960, time = 54.496, size = (1, 32, 32, 1), loss = 19.009, loss1 = 18.997, loss2 = 0.011247, lr=0.01
[STATS][L2] iter = 36, cost = 9216, time = 56.144, size = (1, 32, 32, 1), loss = 19.009, loss1 = 18.997, loss2 = 0.011796, lr=0.01
[STATS][L2] iter = 37, cost = 9472, time = 57.759, size = (1, 32, 32, 1), loss = 19.01, loss1 = 18.997, loss2 = 0.012369, lr=0.01
[STATS][L2] iter = 38, cost = 9728, time = 59.285, size = (1, 32, 32, 1), loss = 19.01, loss1 = 18.997, loss2 = 0.012696, lr=0.01
[STATS][L2] iter = 39, cost = 9984, time = 60.840, size = (1, 32, 32, 1), loss = 19.01, loss1 = 18.997, loss2 = 0.01304, lr=0.01
[STATS][L2] iter = 40, cost = 10240, time = 62.359, size = (1, 32, 32, 1), loss = 9.8821, loss1 = 9.8688, loss2 = 0.013339, lr=0.01
[STATS][L2] iter = 41, cost = 10496, time = 64.064, size = (1, 32, 32, 1), loss = 9.8825, loss1 = 9.8688, loss2 = 0.013724, lr=0.01
[STATS][L2] iter = 42, cost = 10752, time = 65.579, size = (1, 32, 32, 1), loss = 9.8829, loss1 = 9.8688, loss2 = 0.014095, lr=0.01
[STATS][L2] iter = 43, cost = 11008, time = 67.092, size = (1, 32, 32, 1), loss = 9.8833, loss1 = 9.8688, loss2 = 0.014543, lr=0.01
[STATS][L2] iter = 44, cost = 11264, time = 68.669, size = (1, 32, 32, 1), loss = 9.8836, loss1 = 9.8688, loss2 = 0.014829, lr=0.01
[STATS][L2] iter = 45, cost = 11520, time = 70.219, size = (1, 32, 32, 1), loss = 9.884, loss1 = 9.8688, loss2 = 0.015205, lr=0.01
[STATS][L2] iter = 46, cost = 11776, time = 71.843, size = (1, 32, 32, 1), loss = 0.015693, loss1 = 0, loss2 = 0.015693, lr=0.01
saving outstep 1 and iteration 46
[STATS][L3](Attack found!) iter = 46, cost = 12032, time = 71.843, size = (1, 32, 32, 1), loss = 0.015692, loss1 = 0, loss2 = 0.015692
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  7.478252646377772
l2_distortion between inputs and adv_current  7.478252646377772
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.015692435
perceptual metrics distance between adv_current and img 0.015692435
normalized perceptual metrics distance between adv and img 5.4487622239523465e-05
normalized perceptual metrics distance between adv_current and img 5.4487622239523465e-05
perceptual hash difference is  10
Saving to id42_differ10_True_l27.48_pdistance0.015692435204982758
[STATS][L1] total = 43, id = 42, time = 161.033, success = True, const = 50.000000, hash_avg=10.09524, distortion = 7.47825, success_rate = 0.977, l2_avg=3.77269, p_avg=0.006186031317892706, iteration_avg=21.642857142857142
ocalhost/replica:0/task:0/device:GPU:0
overall average l2  3.772691895085369
overal average perceptual distance  0.006186031317892706
overal average iterations  21.642857142857142
for image id  43
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.572, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 8.9815e-05, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.159, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00020539, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.699, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00035143, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.255, size = (1, 32, 32, 1), loss = 37.995, loss1 = 37.995, loss2 = 0.000514, lr=0.01
saving outstep 0 and iteration 4
[STATS][L2] iter = 5, cost = 1280, time = 7.817, size = (1, 32, 32, 1), loss = 19.738, loss1 = 19.738, loss2 = 0.00067481, lr=0.01
saving outstep 0 and iteration 5
[STATS][L2] iter = 6, cost = 1536, time = 9.419, size = (1, 32, 32, 1), loss = 0.00090033, loss1 = 0, loss2 = 0.00090033, lr=0.01
saving outstep 0 and iteration 6
[STATS][L3](First valid attack found!) iter = 6, cost = 1792, time = 9.419, size = (1, 32, 32, 1), loss = 0.0008994, loss1 = 0, loss2 = 0.0008994
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.552, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 9.5968e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.093, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00021636, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.646, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00036441, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.373, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00053082, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.951, size = (1, 32, 32, 1), loss = 0.00071784, loss1 = 0, loss2 = 0.00071784, lr=0.01
saving outstep 1 and iteration 5
[STATS][L3](Attack found!) iter = 5, cost = 1536, time = 7.951, size = (1, 32, 32, 1), loss = 0.00071827, loss1 = 0, loss2 = 0.00071827
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  1.6089715736962569
l2_distortion between inputs and adv_current  1.6089715736962569
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.00071774586
perceptual metrics distance between adv_current and img 0.00071774586
normalized perceptual metrics distance between adv and img 2.492173128606131e-06
normalized perceptual metrics distance between adv_current and img 2.492173128606131e-06
perceptual hash difference is  10
Saving to id43_differ10_True_l21.61_pdistance0.0007177458610385656
[STATS][L1] total = 44, id = 43, time = 22.338, success = True, const = 50.000000, hash_avg=10.09302, distortion = 1.60897, success_rate = 0.977, l2_avg=3.72237, p_avg=0.00605886188866354, iteration_avg=21.302325581395348
overall average l2  3.722372817843762
overal average perceptual distance  0.00605886188866354
overal average iterations  21.302325581395348
for image id  44
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.559, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 6.2445e-05, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.091, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00013122, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.645, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00025203, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.250, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00038777, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.801, size = (1, 32, 32, 1), loss = 37.995, loss1 = 37.995, loss2 = 0.00056101, lr=0.01
saving outstep 0 and iteration 5
[STATS][L2] iter = 6, cost = 1536, time = 9.371, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00075032, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.903, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00093325, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.452, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0010723, lr=0.01
saving outstep 0 and iteration 8
[STATS][L2] iter = 9, cost = 2304, time = 13.990, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0012318, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.539, size = (1, 32, 32, 1), loss = 0.001549, loss1 = 0, loss2 = 0.001549, lr=0.01
saving outstep 0 and iteration 10
[STATS][L3](First valid attack found!) iter = 10, cost = 2816, time = 15.539, size = (1, 32, 32, 1), loss = 0.0015491, loss1 = 0, loss2 = 0.0015491
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.537, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 5.6923e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.090, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.0001396, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.660, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00022468, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.280, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00035945, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.828, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00056816, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.552, size = (1, 32, 32, 1), loss = 9.8695, loss1 = 9.8688, loss2 = 0.00072693, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.093, size = (1, 32, 32, 1), loss = 9.8697, loss1 = 9.8688, loss2 = 0.00089979, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.919, size = (1, 32, 32, 1), loss = 9.8699, loss1 = 9.8688, loss2 = 0.0011768, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.511, size = (1, 32, 32, 1), loss = 0.001409, loss1 = 0, loss2 = 0.001409, lr=0.01
saving outstep 1 and iteration 9
[STATS][L3](Attack found!) iter = 9, cost = 2560, time = 14.511, size = (1, 32, 32, 1), loss = 0.0014087, loss1 = 0, loss2 = 0.0014087
device:GPU:0
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  2.418349549549805
l2_distortion between inputs and adv_current  2.418349549549805
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0014088254
perceptual metrics distance between adv_current and img 0.0014088254
normalized perceptual metrics distance between adv and img 4.8917548459333675e-06
normalized perceptual metrics distance between adv_current and img 4.8917548459333675e-06
perceptual hash difference is  10
Saving to id44_differ10_True_l22.42_pdistance0.00140882539562881
[STATS][L1] total = 45, id = 44, time = 34.950, success = True, const = 50.000000, hash_avg=10.09091, distortion = 2.41835, success_rate = 0.978, l2_avg=3.69274, p_avg=0.005953179241094569, iteration_avg=21.068181818181817
overall average l2  3.692735925382536
overal average perceptual distance  0.005953179241094569
overal average iterations  21.068181818181817
for image id  45
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.542, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 5.2511e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.083, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00011762, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.616, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00022187, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.149, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00033673, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.682, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00052556, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.229, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00072996, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.874, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00092032, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.471, size = (1, 32, 32, 1), loss = 76.161, loss1 = 76.159, loss2 = 0.0010985, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.209, size = (1, 32, 32, 1), loss = 76.161, loss1 = 76.159, loss2 = 0.0013452, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.738, size = (1, 32, 32, 1), loss = 76.161, loss1 = 76.159, loss2 = 0.0016533, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.471, size = (1, 32, 32, 1), loss = 76.161, loss1 = 76.159, loss2 = 0.0019571, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 19.011, size = (1, 32, 32, 1), loss = 76.162, loss1 = 76.159, loss2 = 0.0022995, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.559, size = (1, 32, 32, 1), loss = 76.162, loss1 = 76.159, loss2 = 0.0026644, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.143, size = (1, 32, 32, 1), loss = 76.162, loss1 = 76.159, loss2 = 0.0028724, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.689, size = (1, 32, 32, 1), loss = 66.407, loss1 = 66.404, loss2 = 0.0033122, lr=0.01
saving outstep 0 and iteration 15
[STATS][L2] iter = 16, cost = 4096, time = 25.240, size = (1, 32, 32, 1), loss = 66.407, loss1 = 66.404, loss2 = 0.0037653, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.831, size = (1, 32, 32, 1), loss = 66.408, loss1 = 66.404, loss2 = 0.0042216, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.386, size = (1, 32, 32, 1), loss = 66.408, loss1 = 66.404, loss2 = 0.0047049, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 30.110, size = (1, 32, 32, 1), loss = 53.71, loss1 = 53.705, loss2 = 0.0052648, lr=0.01
saving outstep 0 and iteration 19
[STATS][L2] iter = 20, cost = 5120, time = 31.635, size = (1, 32, 32, 1), loss = 38.001, loss1 = 37.995, loss2 = 0.0058169, lr=0.01
saving outstep 0 and iteration 20
[STATS][L2] iter = 21, cost = 5376, time = 33.346, size = (1, 32, 32, 1), loss = 38.001, loss1 = 37.995, loss2 = 0.0061511, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.889, size = (1, 32, 32, 1), loss = 38.002, loss1 = 37.995, loss2 = 0.0066957, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 36.429, size = (1, 32, 32, 1), loss = 38.003, loss1 = 37.995, loss2 = 0.0076083, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 38.049, size = (1, 32, 32, 1), loss = 38.003, loss1 = 37.995, loss2 = 0.0083378, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 39.604, size = (1, 32, 32, 1), loss = 38.004, loss1 = 37.995, loss2 = 0.0089805, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 41.151, size = (1, 32, 32, 1), loss = 38.005, loss1 = 37.995, loss2 = 0.0098973, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.703, size = (1, 32, 32, 1), loss = 38.005, loss1 = 37.995, loss2 = 0.010504, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 44.263, size = (1, 32, 32, 1), loss = 38.006, loss1 = 37.995, loss2 = 0.011262, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.831, size = (1, 32, 32, 1), loss = 38.007, loss1 = 37.995, loss2 = 0.011873, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 47.359, size = (1, 32, 32, 1), loss = 38.008, loss1 = 37.995, loss2 = 0.012881, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 48.878, size = (1, 32, 32, 1), loss = 38.009, loss1 = 37.995, loss2 = 0.013672, lr=0.01
[STATS][L2] iter = 32, cost = 8192, time = 50.425, size = (1, 32, 32, 1), loss = 38.009, loss1 = 37.995, loss2 = 0.014452, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 52.016, size = (1, 32, 32, 1), loss = 38.01, loss1 = 37.995, loss2 = 0.015455, lr=0.01
[STATS][L2] iter = 34, cost = 8704, time = 53.599, size = (1, 32, 32, 1), loss = 38.011, loss1 = 37.995, loss2 = 0.016293, lr=0.01
[STATS][L2] iter = 35, cost = 8960, time = 55.306, size = (1, 32, 32, 1), loss = 38.012, loss1 = 37.995, loss2 = 0.017006, lr=0.01
[STATS][L2] iter = 36, cost = 9216, time = 56.819, size = (1, 32, 32, 1), loss = 38.013, loss1 = 37.995, loss2 = 0.017802, lr=0.01
[STATS][L2] iter = 37, cost = 9472, time = 58.379, size = (1, 32, 32, 1), loss = 38.014, loss1 = 37.995, loss2 = 0.018941, lr=0.01
[STATS][L2] iter = 38, cost = 9728, time = 59.954, size = (1, 32, 32, 1), loss = 38.015, loss1 = 37.995, loss2 = 0.019705, lr=0.01
[STATS][L2] iter = 39, cost = 9984, time = 61.558, size = (1, 32, 32, 1), loss = 38.015, loss1 = 37.995, loss2 = 0.020558, lr=0.01
[STATS][L2] iter = 40, cost = 10240, time = 63.095, size = (1, 32, 32, 1), loss = 38.016, loss1 = 37.995, loss2 = 0.021264, lr=0.01
[STATS][L2] iter = 41, cost = 10496, time = 64.650, size = (1, 32, 32, 1), loss = 38.017, loss1 = 37.995, loss2 = 0.022167, lr=0.01
[STATS][L2] iter = 42, cost = 10752, time = 66.207, size = (1, 32, 32, 1), loss = 38.018, loss1 = 37.995, loss2 = 0.023205, lr=0.01
[STATS][L2] iter = 43, cost = 11008, time = 67.789, size = (1, 32, 32, 1), loss = 38.019, loss1 = 37.995, loss2 = 0.02427, lr=0.01
[STATS][L2] iter = 44, cost = 11264, time = 69.411, size = (1, 32, 32, 1), loss = 38.02, loss1 = 37.995, loss2 = 0.025438, lr=0.01
[STATS][L2] iter = 45, cost = 11520, time = 70.975, size = (1, 32, 32, 1), loss = 38.021, loss1 = 37.995, loss2 = 0.026595, lr=0.01
[STATS][L2] iter = 46, cost = 11776, time = 72.506, size = (1, 32, 32, 1), loss = 38.023, loss1 = 37.995, loss2 = 0.02801, lr=0.01
[STATS][L2] iter = 47, cost = 12032, time = 74.040, size = (1, 32, 32, 1), loss = 38.024, loss1 = 37.995, loss2 = 0.028975, lr=0.01
[STATS][L2] iter = 48, cost = 12288, time = 75.578, size = (1, 32, 32, 1), loss = 38.025, loss1 = 37.995, loss2 = 0.030214, lr=0.01
[STATS][L2] iter = 49, cost = 12544, time = 77.143, size = (1, 32, 32, 1), loss = 19.769, loss1 = 19.738, loss2 = 0.031278, lr=0.01
saving outstep 0 and iteration 49
[STATS][L2] iter = 50, cost = 12800, time = 78.705, size = (1, 32, 32, 1), loss = 19.77, loss1 = 19.738, loss2 = 0.032844, lr=0.01
[STATS][L2] iter = 51, cost = 13056, time = 80.469, size = (1, 32, 32, 1), loss = 19.772, loss1 = 19.738, loss2 = 0.034005, lr=0.01
[STATS][L2] iter = 52, cost = 13312, time = 81.997, size = (1, 32, 32, 1), loss = 19.773, loss1 = 19.738, loss2 = 0.035237, lr=0.01
[STATS][L2] iter = 53, cost = 13568, time = 83.517, size = (1, 32, 32, 1), loss = 19.774, loss1 = 19.738, loss2 = 0.036414, lr=0.01
[STATS][L2] iter = 54, cost = 13824, time = 85.052, size = (1, 32, 32, 1), loss = 19.775, loss1 = 19.738, loss2 = 0.037485, lr=0.01
[STATS][L2] iter = 55, cost = 14080, time = 86.584, size = (1, 32, 32, 1), loss = 19.777, loss1 = 19.738, loss2 = 0.039292, lr=0.01
[STATS][L2] iter = 56, cost = 14336, time = 88.147, size = (1, 32, 32, 1), loss = 19.778, loss1 = 19.738, loss2 = 0.040656, lr=0.01
[STATS][L2] iter = 57, cost = 14592, time = 89.892, size = (1, 32, 32, 1), loss = 19.779, loss1 = 19.738, loss2 = 0.041885, lr=0.01
[STATS][L2] iter = 58, cost = 14848, time = 91.462, size = (1, 32, 32, 1), loss = 19.781, loss1 = 19.738, loss2 = 0.043545, lr=0.01
[STATS][L2] iter = 59, cost = 15104, time = 93.212, size = (1, 32, 32, 1), loss = 19.782, loss1 = 19.738, loss2 = 0.044891, lr=0.01
[STATS][L2] iter = 60, cost = 15360, time = 94.835, size = (1, 32, 32, 1), loss = 19.783, loss1 = 19.738, loss2 = 0.04585, lr=0.01
[STATS][L2] iter = 61, cost = 15616, time = 96.398, size = (1, 32, 32, 1), loss = 19.785, loss1 = 19.738, loss2 = 0.047515, lr=0.01
[STATS][L2] iter = 62, cost = 15872, time = 97.969, size = (1, 32, 32, 1), loss = 19.787, loss1 = 19.738, loss2 = 0.049172, lr=0.01
[STATS][L2] iter = 63, cost = 16128, time = 99.534, size = (1, 32, 32, 1), loss = 19.788, loss1 = 19.738, loss2 = 0.050239, lr=0.01
[STATS][L2] iter = 64, cost = 16384, time = 101.096, size = (1, 32, 32, 1), loss = 19.789, loss1 = 19.738, loss2 = 0.051532, lr=0.01
[STATS][L2] iter = 65, cost = 16640, time = 102.658, size = (1, 32, 32, 1), loss = 19.79, loss1 = 19.738, loss2 = 0.052346, lr=0.01
[STATS][L2] iter = 66, cost = 16896, time = 104.182, size = (1, 32, 32, 1), loss = 0.053865, loss1 = 0, loss2 = 0.053865, lr=0.01
saving outstep 0 and iteration 66
[STATS][L3](First valid attack found!) iter = 66, cost = 17152, time = 104.182, size = (1, 32, 32, 1), loss = 0.053857, loss1 = 0, loss2 = 0.053857
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.602, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 4.7235e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.230, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0.00011891, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.812, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0.0002136, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.450, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0.0003725, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 8.010, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0.00053227, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.548, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0.00067387, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.083, size = (1, 32, 32, 1), loss = 38.081, loss1 = 38.08, loss2 = 0.00084079, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.627, size = (1, 32, 32, 1), loss = 38.081, loss1 = 38.08, loss2 = 0.0010206, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.188, size = (1, 32, 32, 1), loss = 38.081, loss1 = 38.08, loss2 = 0.0012766, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.754, size = (1, 32, 32, 1), loss = 38.081, loss1 = 38.08, loss2 = 0.0016322, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.421, size = (1, 32, 32, 1), loss = 38.082, loss1 = 38.08, loss2 = 0.0019033, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 19.025, size = (1, 32, 32, 1), loss = 38.082, loss1 = 38.08, loss2 = 0.0021682, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.590, size = (1, 32, 32, 1), loss = 38.082, loss1 = 38.08, loss2 = 0.0024789, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.153, size = (1, 32, 32, 1), loss = 38.083, loss1 = 38.08, loss2 = 0.0028356, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.695, size = (1, 32, 32, 1), loss = 33.205, loss1 = 33.202, loss2 = 0.0032771, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.239, size = (1, 32, 32, 1), loss = 33.205, loss1 = 33.202, loss2 = 0.0036428, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.797, size = (1, 32, 32, 1), loss = 26.857, loss1 = 26.852, loss2 = 0.0041542, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.399, size = (1, 32, 32, 1), loss = 26.857, loss1 = 26.852, loss2 = 0.0046088, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 30.031, size = (1, 32, 32, 1), loss = 26.858, loss1 = 26.852, loss2 = 0.0051964, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.568, size = (1, 32, 32, 1), loss = 26.858, loss1 = 26.852, loss2 = 0.0058039, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 33.107, size = (1, 32, 32, 1), loss = 26.859, loss1 = 26.852, loss2 = 0.006444, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.655, size = (1, 32, 32, 1), loss = 26.859, loss1 = 26.852, loss2 = 0.0069909, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 36.208, size = (1, 32, 32, 1), loss = 26.86, loss1 = 26.852, loss2 = 0.0074411, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.822, size = (1, 32, 32, 1), loss = 26.861, loss1 = 26.852, loss2 = 0.008219, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 39.368, size = (1, 32, 32, 1), loss = 19.006, loss1 = 18.997, loss2 = 0.008927, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 40.927, size = (1, 32, 32, 1), loss = 19.007, loss1 = 18.997, loss2 = 0.009786, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.517, size = (1, 32, 32, 1), loss = 19.008, loss1 = 18.997, loss2 = 0.010667, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 44.115, size = (1, 32, 32, 1), loss = 19.009, loss1 = 18.997, loss2 = 0.011283, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.671, size = (1, 32, 32, 1), loss = 19.009, loss1 = 18.997, loss2 = 0.012027, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 47.206, size = (1, 32, 32, 1), loss = 19.011, loss1 = 18.997, loss2 = 0.013325, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 48.982, size = (1, 32, 32, 1), loss = 19.011, loss1 = 18.997, loss2 = 0.013969, lr=0.01
[STATS][L2] iter = 32, cost = 8192, time = 50.535, size = (1, 32, 32, 1), loss = 19.013, loss1 = 18.997, loss2 = 0.015112, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 52.104, size = (1, 32, 32, 1), loss = 19.014, loss1 = 18.997, loss2 = 0.016213, lr=0.01
[STATS][L2] iter = 34, cost = 8704, time = 53.665, size = (1, 32, 32, 1), loss = 19.015, loss1 = 18.997, loss2 = 0.017226, lr=0.01
[STATS][L2] iter = 35, cost = 8960, time = 55.240, size = (1, 32, 32, 1), loss = 19.016, loss1 = 18.997, loss2 = 0.018357, lr=0.01
[STATS][L2] iter = 36, cost = 9216, time = 56.798, size = (1, 32, 32, 1), loss = 19.017, loss1 = 18.997, loss2 = 0.019343, lr=0.01
[STATS][L2] iter = 37, cost = 9472, time = 58.353, size = (1, 32, 32, 1), loss = 9.889, loss1 = 9.8688, loss2 = 0.02023, lr=0.01
[STATS][L2] iter = 38, cost = 9728, time = 59.893, size = (1, 32, 32, 1), loss = 9.8901, loss1 = 9.8688, loss2 = 0.021331, lr=0.01
[STATS][L2] iter = 39, cost = 9984, time = 61.430, size = (1, 32, 32, 1), loss = 9.8908, loss1 = 9.8688, loss2 = 0.022039, lr=0.01
[STATS][L2] iter = 40, cost = 10240, time = 62.972, size = (1, 32, 32, 1), loss = 9.892, loss1 = 9.8688, loss2 = 0.023228, lr=0.01
[STATS][L2] iter = 41, cost = 10496, time = 64.506, size = (1, 32, 32, 1), loss = 9.8933, loss1 = 9.8688, loss2 = 0.024557, lr=0.01
[STATS][L2] iter = 42, cost = 10752, time = 66.044, size = (1, 32, 32, 1), loss = 9.8944, loss1 = 9.8688, loss2 = 0.025682, lr=0.01
[STATS][L2] iter = 43, cost = 11008, time = 67.587, size = (1, 32, 32, 1), loss = 9.8953, loss1 = 9.8688, loss2 = 0.026564, lr=0.01
[STATS][L2] iter = 44, cost = 11264, time = 69.144, size = (1, 32, 32, 1), loss = 9.8964, loss1 = 9.8688, loss2 = 0.027616, lr=0.01
[STATS][L2] iter = 45, cost = 11520, time = 70.726, size = (1, 32, 32, 1), loss = 9.8978, loss1 = 9.8688, loss2 = 0.029055, lr=0.01
[STATS][L2] iter = 46, cost = 11776, time = 72.280, size = (1, 32, 32, 1), loss = 9.8988, loss1 = 9.8688, loss2 = 0.030002, lr=0.01
[STATS][L2] iter = 47, cost = 12032, time = 73.815, size = (1, 32, 32, 1), loss = 9.8998, loss1 = 9.8688, loss2 = 0.031064, lr=0.01
[STATS][L2] iter = 48, cost = 12288, time = 75.340, size = (1, 32, 32, 1), loss = 9.9012, loss1 = 9.8688, loss2 = 0.032438, lr=0.01
[STATS][L2] iter = 49, cost = 12544, time = 76.873, size = (1, 32, 32, 1), loss = 9.902, loss1 = 9.8688, loss2 = 0.033267, lr=0.01
[STATS][L2] iter = 50, cost = 12800, time = 78.413, size = (1, 32, 32, 1), loss = 9.9029, loss1 = 9.8688, loss2 = 0.034093, lr=0.01
[STATS][L2] iter = 51, cost = 13056, time = 80.110, size = (1, 32, 32, 1), loss = 9.9039, loss1 = 9.8688, loss2 = 0.035114, lr=0.01
[STATS][L2] iter = 52, cost = 13312, time = 81.616, size = (1, 32, 32, 1), loss = 9.9049, loss1 = 9.8688, loss2 = 0.036159, lr=0.01
[STATS][L2] iter = 53, cost = 13568, time = 83.188, size = (1, 32, 32, 1), loss = 9.9061, loss1 = 9.8688, loss2 = 0.03733, lr=0.01
[STATS][L2] iter = 54, cost = 13824, time = 84.718, size = (1, 32, 32, 1), loss = 9.9068, loss1 = 9.8688, loss2 = 0.038021, lr=0.01
[STATS][L2] iter = 55, cost = 14080, time = 86.275, size = (1, 32, 32, 1), loss = 9.9081, loss1 = 9.8688, loss2 = 0.039322, lr=0.01
[STATS][L2] iter = 56, cost = 14336, time = 87.989, size = (1, 32, 32, 1), loss = 9.9094, loss1 = 9.8688, loss2 = 0.04065, lr=0.01
[STATS][L2] iter = 57, cost = 14592, time = 89.537, size = (1, 32, 32, 1), loss = 9.9106, loss1 = 9.8688, loss2 = 0.041857, lr=0.01
[STATS][L2] iter = 58, cost = 14848, time = 91.129, size = (1, 32, 32, 1), loss = 9.9118, loss1 = 9.8688, loss2 = 0.043004, lr=0.01
[STATS][L2] iter = 59, cost = 15104, time = 92.697, size = (1, 32, 32, 1), loss = 9.913, loss1 = 9.8688, loss2 = 0.044242, lr=0.01
[STATS][L2] iter = 60, cost = 15360, time = 94.281, size = (1, 32, 32, 1), loss = 9.9142, loss1 = 9.8688, loss2 = 0.045442, lr=0.01
[STATS][L2] iter = 61, cost = 15616, time = 95.843, size = (1, 32, 32, 1), loss = 9.9157, loss1 = 9.8688, loss2 = 0.046916, lr=0.01
[STATS][L2] iter = 62, cost = 15872, time = 97.381, size = (1, 32, 32, 1), loss = 9.9168, loss1 = 9.8688, loss2 = 0.04806, lr=0.01
[STATS][L2] iter = 63, cost = 16128, time = 98.954, size = (1, 32, 32, 1), loss = 9.918, loss1 = 9.8688, loss2 = 0.049205, lr=0.01
[STATS][L2] iter = 64, cost = 16384, time = 100.564, size = (1, 32, 32, 1), loss = 9.9194, loss1 = 9.8688, loss2 = 0.050605, lr=0.01
[STATS][L2] iter = 65, cost = 16640, time = 102.118, size = (1, 32, 32, 1), loss = 9.9203, loss1 = 9.8688, loss2 = 0.051535, lr=0.01
[STATS][L2] iter = 66, cost = 16896, time = 103.669, size = (1, 32, 32, 1), loss = 9.9214, loss1 = 9.8688, loss2 = 0.052648, lr=0.01
[STATS][L2] iter = 67, cost = 17152, time = 105.206, size = (1, 32, 32, 1), loss = 9.9223, loss1 = 9.8688, loss2 = 0.053529, lr=0.01
[STATS][L2] iter = 68, cost = 17408, time = 106.780, size = (1, 32, 32, 1), loss = 9.9235, loss1 = 9.8688, loss2 = 0.054761, lr=0.01
[STATS][L2] iter = 69, cost = 17664, time = 108.357, size = (1, 32, 32, 1), loss = 0.055876, loss1 = 0, loss2 = 0.055876, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 69, cost = 17920, time = 108.357, size = (1, 32, 32, 1), loss = 0.055882, loss1 = 0, loss2 = 0.055882
:localhost/replica:0/task:0/device:GPU:0
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  7.895321954944697
l2_distortion between inputs and adv_current  7.895321954944697
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.05386414
perceptual metrics distance between adv_current and img 0.05386414
normalized perceptual metrics distance between adv and img 0.00018702826410945918
normalized perceptual metrics distance between adv_current and img 0.00018702826410945918
perceptual hash difference is  10
Saving to id45_differ10_True_l27.90_pdistance0.053864140063524246
[STATS][L1] total = 46, id = 45, time = 218.518, success = True, const = 100.000000, hash_avg=10.08889, distortion = 7.89532, success_rate = 0.978, l2_avg=3.78613, p_avg=0.007017867259370784, iteration_avg=22.08888888888889
lica:0/task:0/device:GPU:0
overall average l2  3.786126726039473
overal average perceptual distance  0.007017867259370784
overal average iterations  22.08888888888889
for image id  46
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.553, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.0001751, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.099, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00036622, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.695, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00063789, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.274, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.001024, lr=0.01
saving outstep 0 and iteration 4
[STATS][L2] iter = 5, cost = 1280, time = 7.922, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0014537, lr=0.01
saving outstep 0 and iteration 5
[STATS][L2] iter = 6, cost = 1536, time = 9.467, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0018303, lr=0.01
saving outstep 0 and iteration 6
[STATS][L2] iter = 7, cost = 1792, time = 11.047, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0022633, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.583, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.002715, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.126, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0033043, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.664, size = (1, 32, 32, 1), loss = 0.0036783, loss1 = 0, loss2 = 0.0036783, lr=0.01
saving outstep 0 and iteration 10
[STATS][L3](First valid attack found!) iter = 10, cost = 2816, time = 15.664, size = (1, 32, 32, 1), loss = 0.0036785, loss1 = 0, loss2 = 0.0036785
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.594, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00020027, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.178, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00046404, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.912, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.00071838, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.458, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.0011247, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 8.004, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0014696, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.568, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0018437, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.102, size = (1, 32, 32, 1), loss = 9.871, loss1 = 9.8688, loss2 = 0.0022536, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.623, size = (1, 32, 32, 1), loss = 9.8716, loss1 = 9.8688, loss2 = 0.0028402, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.363, size = (1, 32, 32, 1), loss = 9.8721, loss1 = 9.8688, loss2 = 0.0033118, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.984, size = (1, 32, 32, 1), loss = 0.0039276, loss1 = 0, loss2 = 0.0039276, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 10, cost = 2816, time = 15.984, size = (1, 32, 32, 1), loss = 0.0039279, loss1 = 0, loss2 = 0.0039279
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  2.960752756436311
l2_distortion between inputs and adv_current  2.960752756436311
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.003678322
perceptual metrics distance between adv_current and img 0.003678322
normalized perceptual metrics distance between adv and img 1.2771951636144271e-05
normalized perceptual metrics distance between adv_current and img 1.2771951636144271e-05
perceptual hash difference is  10
Saving to id46_differ10_True_l22.96_pdistance0.00367832207120955
[STATS][L1] total = 47, id = 46, time = 36.868, success = True, const = 100.000000, hash_avg=10.08696, distortion = 2.96075, success_rate = 0.979, l2_avg=3.76818, p_avg=0.006945268450932496, iteration_avg=21.847826086956523
0/task:0/device:GPU:0
overall average l2  3.7681838136567953
overal average perceptual distance  0.006945268450932496
overal average iterations  21.847826086956523
for image id  47
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.572, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 6.1562e-05, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.094, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00013977, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.681, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00024996, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.253, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00035988, lr=0.01
saving outstep 0 and iteration 4
[STATS][L2] iter = 5, cost = 1280, time = 7.859, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00047334, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.447, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00062046, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.013, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00076555, lr=0.01
saving outstep 0 and iteration 7
[STATS][L2] iter = 8, cost = 2048, time = 12.582, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.00092302, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.112, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0011206, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.669, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0012853, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.185, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0014744, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.736, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0016594, lr=0.01
saving outstep 0 and iteration 12
[STATS][L2] iter = 13, cost = 3328, time = 20.320, size = (1, 32, 32, 1), loss = 19.739, loss1 = 19.738, loss2 = 0.0018452, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.001, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0020423, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.563, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0022275, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.112, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0024013, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.662, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0025936, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.263, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0027687, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.806, size = (1, 32, 32, 1), loss = 19.74, loss1 = 19.738, loss2 = 0.0028939, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.333, size = (1, 32, 32, 1), loss = 19.741, loss1 = 19.738, loss2 = 0.0030438, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.895, size = (1, 32, 32, 1), loss = 0.0032327, loss1 = 0, loss2 = 0.0032327, lr=0.01
saving outstep 0 and iteration 21
[STATS][L3](First valid attack found!) iter = 21, cost = 5632, time = 32.895, size = (1, 32, 32, 1), loss = 0.003233, loss1 = 0, loss2 = 0.003233
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.619, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 5.3692e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.229, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00012798, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.815, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00021016, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.399, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00032192, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 8.003, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00045377, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.618, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.0005687, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 11.206, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00072058, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.796, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.00085708, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.420, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.0010429, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 16.227, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0012299, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.790, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0014343, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 19.345, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0016114, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.901, size = (1, 32, 32, 1), loss = 9.8706, loss1 = 9.8688, loss2 = 0.0018312, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 22.432, size = (1, 32, 32, 1), loss = 9.8708, loss1 = 9.8688, loss2 = 0.0020438, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.990, size = (1, 32, 32, 1), loss = 9.871, loss1 = 9.8688, loss2 = 0.0022481, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 25.564, size = (1, 32, 32, 1), loss = 9.8712, loss1 = 9.8688, loss2 = 0.0024699, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 27.119, size = (1, 32, 32, 1), loss = 9.8714, loss1 = 9.8688, loss2 = 0.002636, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.672, size = (1, 32, 32, 1), loss = 9.8716, loss1 = 9.8688, loss2 = 0.0028277, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 30.266, size = (1, 32, 32, 1), loss = 0.0030284, loss1 = 0, loss2 = 0.0030284, lr=0.01
saving outstep 1 and iteration 19
[STATS][L3](Attack found!) iter = 19, cost = 5120, time = 30.266, size = (1, 32, 32, 1), loss = 0.003028, loss1 = 0, loss2 = 0.003028
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  4.366310427548311
l2_distortion between inputs and adv_current  4.366310427548311
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.0030287614
perceptual metrics distance between adv_current and img 0.0030287614
normalized perceptual metrics distance between adv and img 1.0516532509225524e-05
normalized perceptual metrics distance between adv_current and img 1.0516532509225524e-05
perceptual hash difference is  10
Saving to id47_differ10_True_l24.37_pdistance0.003028761362656951
[STATS][L1] total = 48, id = 47, time = 68.652, success = True, const = 50.000000, hash_avg=10.08511, distortion = 4.36631, success_rate = 0.979, l2_avg=3.78091, p_avg=0.00686193851288408, iteration_avg=21.851063829787233
overall average l2  3.7809099118247
overal average perceptual distance  0.00686193851288408
overal average iterations  21.851063829787233
for image id  48
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.525, size = (1, 32, 32, 1), loss = 76.16, loss1 = 76.159, loss2 = 0.00012146, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.071, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 0.00029888, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.645, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00048948, lr=0.01
saving outstep 0 and iteration 3
[STATS][L2] iter = 4, cost = 1024, time = 6.307, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00079172, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.848, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.0011639, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.373, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0014861, lr=0.01
saving outstep 0 and iteration 6
[STATS][L2] iter = 7, cost = 1792, time = 10.912, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0020925, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.486, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0027333, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.004, size = (1, 32, 32, 1), loss = 0.0032702, loss1 = 0, loss2 = 0.0032702, lr=0.01
saving outstep 0 and iteration 9
[STATS][L3](First valid attack found!) iter = 9, cost = 2560, time = 14.004, size = (1, 32, 32, 1), loss = 0.0032707, loss1 = 0, loss2 = 0.0032707
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.542, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0.00013797, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.123, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00036321, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.707, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 0.00064824, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.272, size = (1, 32, 32, 1), loss = 33.203, loss1 = 33.202, loss2 = 0.0009695, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.814, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.0013819, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.390, size = (1, 32, 32, 1), loss = 26.854, loss1 = 26.852, loss2 = 0.00193, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.932, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.002606, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.491, size = (1, 32, 32, 1), loss = 9.8719, loss1 = 9.8688, loss2 = 0.0031165, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 14.020, size = (1, 32, 32, 1), loss = 0.0041921, loss1 = 0, loss2 = 0.0041921, lr=0.01
do I get here
[STATS][L3](Attack found!) iter = 9, cost = 2560, time = 14.020, size = (1, 32, 32, 1), loss = 0.0041931, loss1 = 0, loss2 = 0.0041931
st/replica:0/task:0/device:GPU:0
Device mapping:
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  2.7214903338344163
l2_distortion between inputs and adv_current  2.7214903338344163
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.003270114
perceptual metrics distance between adv_current and img 0.003270114
normalized perceptual metrics distance between adv and img 1.1354562755311943e-05
normalized perceptual metrics distance between adv_current and img 1.1354562755311943e-05
perceptual hash difference is  10
Saving to id48_differ10_True_l22.72_pdistance0.0032701140735298395
[STATS][L1] total = 49, id = 48, time = 32.895, success = True, const = 100.000000, hash_avg=10.08333, distortion = 2.72149, success_rate = 0.980, l2_avg=3.75884, p_avg=0.0067871088370642, iteration_avg=21.604166666666668
overall average l2  3.7588386706165693
overal average perceptual distance  0.0067871088370642
overal average iterations  21.604166666666668
for image id  49
each rgb inputs shape  (1, 288, 288, 3)
each gray inputs shape  (1, 288, 288, 1)
new image L3 False
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 76.159, loss1 = 76.159, loss2 = 0, lr=0.01
saving outstep 0 and iteration 0
[STATS][L2] iter = 1, cost = 256, time = 1.586, size = (1, 32, 32, 1), loss = 66.404, loss1 = 66.404, loss2 = 9.7319e-05, lr=0.01
saving outstep 0 and iteration 1
[STATS][L2] iter = 2, cost = 512, time = 3.133, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.0002488, lr=0.01
saving outstep 0 and iteration 2
[STATS][L2] iter = 3, cost = 768, time = 4.670, size = (1, 32, 32, 1), loss = 53.705, loss1 = 53.705, loss2 = 0.00048294, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.196, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00058332, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.750, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00072171, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.305, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.00096313, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.844, size = (1, 32, 32, 1), loss = 53.706, loss1 = 53.705, loss2 = 0.0011694, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.422, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.0013335, lr=0.01
saving outstep 0 and iteration 8
[STATS][L2] iter = 9, cost = 2304, time = 13.984, size = (1, 32, 32, 1), loss = 37.996, loss1 = 37.995, loss2 = 0.001553, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.600, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0018204, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.135, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0021661, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.693, size = (1, 32, 32, 1), loss = 37.997, loss1 = 37.995, loss2 = 0.0024201, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.216, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0027086, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.796, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0029798, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.374, size = (1, 32, 32, 1), loss = 37.998, loss1 = 37.995, loss2 = 0.0033864, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 24.918, size = (1, 32, 32, 1), loss = 37.999, loss1 = 37.995, loss2 = 0.0037737, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.464, size = (1, 32, 32, 1), loss = 37.999, loss1 = 37.995, loss2 = 0.0040155, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 28.038, size = (1, 32, 32, 1), loss = 37.999, loss1 = 37.995, loss2 = 0.0043999, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.603, size = (1, 32, 32, 1), loss = 38, loss1 = 37.995, loss2 = 0.0047226, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.133, size = (1, 32, 32, 1), loss = 38, loss1 = 37.995, loss2 = 0.0051669, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.689, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0054928, lr=0.01
saving outstep 0 and iteration 21
[STATS][L2] iter = 22, cost = 5632, time = 34.223, size = (1, 32, 32, 1), loss = 19.743, loss1 = 19.738, loss2 = 0.0059227, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 35.832, size = (1, 32, 32, 1), loss = 19.744, loss1 = 19.738, loss2 = 0.0063048, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.352, size = (1, 32, 32, 1), loss = 19.744, loss1 = 19.738, loss2 = 0.0066595, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 38.920, size = (1, 32, 32, 1), loss = 19.745, loss1 = 19.738, loss2 = 0.0070894, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 40.492, size = (1, 32, 32, 1), loss = 19.745, loss1 = 19.738, loss2 = 0.0076499, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 42.121, size = (1, 32, 32, 1), loss = 19.746, loss1 = 19.738, loss2 = 0.0082522, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 43.665, size = (1, 32, 32, 1), loss = 19.746, loss1 = 19.738, loss2 = 0.008822, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.204, size = (1, 32, 32, 1), loss = 19.747, loss1 = 19.738, loss2 = 0.0092796, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 46.728, size = (1, 32, 32, 1), loss = 19.747, loss1 = 19.738, loss2 = 0.0099087, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 48.265, size = (1, 32, 32, 1), loss = 19.748, loss1 = 19.738, loss2 = 0.010522, lr=0.01
[STATS][L2] iter = 32, cost = 8192, time = 49.810, size = (1, 32, 32, 1), loss = 19.749, loss1 = 19.738, loss2 = 0.011006, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 51.363, size = (1, 32, 32, 1), loss = 19.749, loss1 = 19.738, loss2 = 0.011325, lr=0.01
[STATS][L2] iter = 34, cost = 8704, time = 52.933, size = (1, 32, 32, 1), loss = 19.749, loss1 = 19.738, loss2 = 0.011719, lr=0.01
[STATS][L2] iter = 35, cost = 8960, time = 54.543, size = (1, 32, 32, 1), loss = 19.75, loss1 = 19.738, loss2 = 0.012151, lr=0.01
[STATS][L2] iter = 36, cost = 9216, time = 56.077, size = (1, 32, 32, 1), loss = 19.75, loss1 = 19.738, loss2 = 0.012649, lr=0.01
[STATS][L2] iter = 37, cost = 9472, time = 57.609, size = (1, 32, 32, 1), loss = 19.751, loss1 = 19.738, loss2 = 0.013128, lr=0.01
[STATS][L2] iter = 38, cost = 9728, time = 59.153, size = (1, 32, 32, 1), loss = 19.751, loss1 = 19.738, loss2 = 0.013568, lr=0.01
[STATS][L2] iter = 39, cost = 9984, time = 60.690, size = (1, 32, 32, 1), loss = 19.752, loss1 = 19.738, loss2 = 0.014192, lr=0.01
[STATS][L2] iter = 40, cost = 10240, time = 62.212, size = (1, 32, 32, 1), loss = 19.752, loss1 = 19.738, loss2 = 0.014877, lr=0.01
[STATS][L2] iter = 41, cost = 10496, time = 63.798, size = (1, 32, 32, 1), loss = 19.753, loss1 = 19.738, loss2 = 0.015523, lr=0.01
[STATS][L2] iter = 42, cost = 10752, time = 65.375, size = (1, 32, 32, 1), loss = 19.754, loss1 = 19.738, loss2 = 0.015972, lr=0.01
[STATS][L2] iter = 43, cost = 11008, time = 66.967, size = (1, 32, 32, 1), loss = 19.754, loss1 = 19.738, loss2 = 0.01644, lr=0.01
[STATS][L2] iter = 44, cost = 11264, time = 68.540, size = (1, 32, 32, 1), loss = 19.754, loss1 = 19.738, loss2 = 0.016942, lr=0.01
[STATS][L2] iter = 45, cost = 11520, time = 70.067, size = (1, 32, 32, 1), loss = 19.755, loss1 = 19.738, loss2 = 0.017244, lr=0.01
[STATS][L2] iter = 46, cost = 11776, time = 71.595, size = (1, 32, 32, 1), loss = 19.755, loss1 = 19.738, loss2 = 0.017658, lr=0.01
[STATS][L2] iter = 47, cost = 12032, time = 73.112, size = (1, 32, 32, 1), loss = 19.756, loss1 = 19.738, loss2 = 0.018035, lr=0.01
[STATS][L2] iter = 48, cost = 12288, time = 74.662, size = (1, 32, 32, 1), loss = 19.756, loss1 = 19.738, loss2 = 0.01873, lr=0.01
[STATS][L2] iter = 49, cost = 12544, time = 76.191, size = (1, 32, 32, 1), loss = 19.757, loss1 = 19.738, loss2 = 0.019195, lr=0.01
[STATS][L2] iter = 50, cost = 12800, time = 77.718, size = (1, 32, 32, 1), loss = 19.757, loss1 = 19.738, loss2 = 0.019718, lr=0.01
[STATS][L2] iter = 51, cost = 13056, time = 79.246, size = (1, 32, 32, 1), loss = 19.758, loss1 = 19.738, loss2 = 0.020193, lr=0.01
[STATS][L2] iter = 52, cost = 13312, time = 80.834, size = (1, 32, 32, 1), loss = 19.758, loss1 = 19.738, loss2 = 0.0207, lr=0.01
[STATS][L2] iter = 53, cost = 13568, time = 82.478, size = (1, 32, 32, 1), loss = 19.759, loss1 = 19.738, loss2 = 0.021336, lr=0.01
[STATS][L2] iter = 54, cost = 13824, time = 84.093, size = (1, 32, 32, 1), loss = 19.759, loss1 = 19.738, loss2 = 0.021753, lr=0.01
[STATS][L2] iter = 55, cost = 14080, time = 85.653, size = (1, 32, 32, 1), loss = 19.76, loss1 = 19.738, loss2 = 0.022086, lr=0.01
[STATS][L2] iter = 56, cost = 14336, time = 87.213, size = (1, 32, 32, 1), loss = 19.76, loss1 = 19.738, loss2 = 0.022516, lr=0.01
[STATS][L2] iter = 57, cost = 14592, time = 88.764, size = (1, 32, 32, 1), loss = 19.76, loss1 = 19.738, loss2 = 0.02294, lr=0.01
[STATS][L2] iter = 58, cost = 14848, time = 90.301, size = (1, 32, 32, 1), loss = 19.761, loss1 = 19.738, loss2 = 0.023449, lr=0.01
[STATS][L2] iter = 59, cost = 15104, time = 91.834, size = (1, 32, 32, 1), loss = 19.762, loss1 = 19.738, loss2 = 0.023998, lr=0.01
[STATS][L2] iter = 60, cost = 15360, time = 93.379, size = (1, 32, 32, 1), loss = 19.762, loss1 = 19.738, loss2 = 0.02456, lr=0.01
[STATS][L2] iter = 61, cost = 15616, time = 94.929, size = (1, 32, 32, 1), loss = 19.762, loss1 = 19.738, loss2 = 0.024966, lr=0.01
[STATS][L2] iter = 62, cost = 15872, time = 96.504, size = (1, 32, 32, 1), loss = 19.763, loss1 = 19.738, loss2 = 0.025645, lr=0.01
[STATS][L2] iter = 63, cost = 16128, time = 98.302, size = (1, 32, 32, 1), loss = 19.764, loss1 = 19.738, loss2 = 0.02607, lr=0.01
[STATS][L2] iter = 64, cost = 16384, time = 99.886, size = (1, 32, 32, 1), loss = 19.764, loss1 = 19.738, loss2 = 0.026449, lr=0.01
[STATS][L2] iter = 65, cost = 16640, time = 101.439, size = (1, 32, 32, 1), loss = 19.764, loss1 = 19.738, loss2 = 0.026894, lr=0.01
[STATS][L2] iter = 66, cost = 16896, time = 102.979, size = (1, 32, 32, 1), loss = 19.765, loss1 = 19.738, loss2 = 0.027297, lr=0.01
[STATS][L2] iter = 67, cost = 17152, time = 104.502, size = (1, 32, 32, 1), loss = 19.766, loss1 = 19.738, loss2 = 0.028041, lr=0.01
[STATS][L2] iter = 68, cost = 17408, time = 106.037, size = (1, 32, 32, 1), loss = 19.766, loss1 = 19.738, loss2 = 0.02847, lr=0.01
[STATS][L2] iter = 69, cost = 17664, time = 107.607, size = (1, 32, 32, 1), loss = 19.766, loss1 = 19.738, loss2 = 0.028891, lr=0.01
[STATS][L2] iter = 70, cost = 17920, time = 109.193, size = (1, 32, 32, 1), loss = 19.767, loss1 = 19.738, loss2 = 0.029293, lr=0.01
[STATS][L2] iter = 71, cost = 18176, time = 110.752, size = (1, 32, 32, 1), loss = 19.767, loss1 = 19.738, loss2 = 0.029916, lr=0.01
[STATS][L2] iter = 72, cost = 18432, time = 112.277, size = (1, 32, 32, 1), loss = 19.768, loss1 = 19.738, loss2 = 0.030571, lr=0.01
[STATS][L2] iter = 73, cost = 18688, time = 113.978, size = (1, 32, 32, 1), loss = 19.769, loss1 = 19.738, loss2 = 0.031194, lr=0.01
[STATS][L2] iter = 74, cost = 18944, time = 115.510, size = (1, 32, 32, 1), loss = 19.769, loss1 = 19.738, loss2 = 0.031563, lr=0.01
[STATS][L2] iter = 75, cost = 19200, time = 117.020, size = (1, 32, 32, 1), loss = 19.769, loss1 = 19.738, loss2 = 0.031935, lr=0.01
[STATS][L2] iter = 76, cost = 19456, time = 118.710, size = (1, 32, 32, 1), loss = 19.77, loss1 = 19.738, loss2 = 0.032392, lr=0.01
[STATS][L2] iter = 77, cost = 19712, time = 120.238, size = (1, 32, 32, 1), loss = 19.77, loss1 = 19.738, loss2 = 0.03286, lr=0.01
[STATS][L2] iter = 78, cost = 19968, time = 121.879, size = (1, 32, 32, 1), loss = 19.771, loss1 = 19.738, loss2 = 0.033215, lr=0.01
[STATS][L2] iter = 79, cost = 20224, time = 123.488, size = (1, 32, 32, 1), loss = 0.033368, loss1 = 0, loss2 = 0.033368, lr=0.01
saving outstep 0 and iteration 79
[STATS][L3](First valid attack found!) iter = 79, cost = 20480, time = 123.488, size = (1, 32, 32, 1), loss = 0.033364, loss1 = 0, loss2 = 0.033364
Early stopping because we found the adversarial example
old constant:  100
new constant:  50.0
[STATS][L2] iter = 0, cost = 0, time = 0.000, size = (1, 32, 32, 1), loss = 38.08, loss1 = 38.08, loss2 = 0, lr=0.01
[STATS][L2] iter = 1, cost = 256, time = 1.555, size = (1, 32, 32, 1), loss = 33.202, loss1 = 33.202, loss2 = 9.1588e-05, lr=0.01
[STATS][L2] iter = 2, cost = 512, time = 3.119, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.0002024, lr=0.01
[STATS][L2] iter = 3, cost = 768, time = 4.654, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00032609, lr=0.01
[STATS][L2] iter = 4, cost = 1024, time = 6.184, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00048154, lr=0.01
[STATS][L2] iter = 5, cost = 1280, time = 7.711, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00066858, lr=0.01
[STATS][L2] iter = 6, cost = 1536, time = 9.265, size = (1, 32, 32, 1), loss = 26.853, loss1 = 26.852, loss2 = 0.00084006, lr=0.01
[STATS][L2] iter = 7, cost = 1792, time = 10.868, size = (1, 32, 32, 1), loss = 18.998, loss1 = 18.997, loss2 = 0.0010322, lr=0.01
[STATS][L2] iter = 8, cost = 2048, time = 12.456, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0011777, lr=0.01
[STATS][L2] iter = 9, cost = 2304, time = 13.992, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0013826, lr=0.01
[STATS][L2] iter = 10, cost = 2560, time = 15.519, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.001581, lr=0.01
[STATS][L2] iter = 11, cost = 2816, time = 17.043, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0017874, lr=0.01
[STATS][L2] iter = 12, cost = 3072, time = 18.594, size = (1, 32, 32, 1), loss = 18.999, loss1 = 18.997, loss2 = 0.0020212, lr=0.01
[STATS][L2] iter = 13, cost = 3328, time = 20.153, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.002331, lr=0.01
[STATS][L2] iter = 14, cost = 3584, time = 21.724, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.0026422, lr=0.01
[STATS][L2] iter = 15, cost = 3840, time = 23.261, size = (1, 32, 32, 1), loss = 19, loss1 = 18.997, loss2 = 0.002895, lr=0.01
[STATS][L2] iter = 16, cost = 4096, time = 24.866, size = (1, 32, 32, 1), loss = 9.872, loss1 = 9.8688, loss2 = 0.0032644, lr=0.01
[STATS][L2] iter = 17, cost = 4352, time = 26.443, size = (1, 32, 32, 1), loss = 9.8724, loss1 = 9.8688, loss2 = 0.0035879, lr=0.01
[STATS][L2] iter = 18, cost = 4608, time = 27.986, size = (1, 32, 32, 1), loss = 9.8727, loss1 = 9.8688, loss2 = 0.0039601, lr=0.01
[STATS][L2] iter = 19, cost = 4864, time = 29.538, size = (1, 32, 32, 1), loss = 9.8731, loss1 = 9.8688, loss2 = 0.0043034, lr=0.01
[STATS][L2] iter = 20, cost = 5120, time = 31.086, size = (1, 32, 32, 1), loss = 9.8734, loss1 = 9.8688, loss2 = 0.0046282, lr=0.01
[STATS][L2] iter = 21, cost = 5376, time = 32.634, size = (1, 32, 32, 1), loss = 9.8738, loss1 = 9.8688, loss2 = 0.0050175, lr=0.01
[STATS][L2] iter = 22, cost = 5632, time = 34.166, size = (1, 32, 32, 1), loss = 9.8742, loss1 = 9.8688, loss2 = 0.0054001, lr=0.01
[STATS][L2] iter = 23, cost = 5888, time = 35.679, size = (1, 32, 32, 1), loss = 9.8747, loss1 = 9.8688, loss2 = 0.0059616, lr=0.01
[STATS][L2] iter = 24, cost = 6144, time = 37.231, size = (1, 32, 32, 1), loss = 9.8753, loss1 = 9.8688, loss2 = 0.0065538, lr=0.01
[STATS][L2] iter = 25, cost = 6400, time = 38.817, size = (1, 32, 32, 1), loss = 9.8759, loss1 = 9.8688, loss2 = 0.0071137, lr=0.01
[STATS][L2] iter = 26, cost = 6656, time = 40.431, size = (1, 32, 32, 1), loss = 9.8766, loss1 = 9.8688, loss2 = 0.0077858, lr=0.01
[STATS][L2] iter = 27, cost = 6912, time = 41.981, size = (1, 32, 32, 1), loss = 9.877, loss1 = 9.8688, loss2 = 0.0082658, lr=0.01
[STATS][L2] iter = 28, cost = 7168, time = 43.518, size = (1, 32, 32, 1), loss = 9.8776, loss1 = 9.8688, loss2 = 0.0087901, lr=0.01
[STATS][L2] iter = 29, cost = 7424, time = 45.112, size = (1, 32, 32, 1), loss = 9.8779, loss1 = 9.8688, loss2 = 0.0090889, lr=0.01
[STATS][L2] iter = 30, cost = 7680, time = 46.626, size = (1, 32, 32, 1), loss = 9.8784, loss1 = 9.8688, loss2 = 0.0095874, lr=0.01
[STATS][L2] iter = 31, cost = 7936, time = 48.146, size = (1, 32, 32, 1), loss = 9.8787, loss1 = 9.8688, loss2 = 0.0099254, lr=0.01
[STATS][L2] iter = 32, cost = 8192, time = 49.680, size = (1, 32, 32, 1), loss = 9.879, loss1 = 9.8688, loss2 = 0.010221, lr=0.01
[STATS][L2] iter = 33, cost = 8448, time = 51.214, size = (1, 32, 32, 1), loss = 9.8795, loss1 = 9.8688, loss2 = 0.010698, lr=0.01
[STATS][L2] iter = 34, cost = 8704, time = 52.765, size = (1, 32, 32, 1), loss = 9.8799, loss1 = 9.8688, loss2 = 0.011136, lr=0.01
[STATS][L2] iter = 35, cost = 8960, time = 54.371, size = (1, 32, 32, 1), loss = 9.8804, loss1 = 9.8688, loss2 = 0.011659, lr=0.01
[STATS][L2] iter = 36, cost = 9216, time = 55.906, size = (1, 32, 32, 1), loss = 9.881, loss1 = 9.8688, loss2 = 0.012217, lr=0.01
[STATS][L2] iter = 37, cost = 9472, time = 57.436, size = (1, 32, 32, 1), loss = 9.8814, loss1 = 9.8688, loss2 = 0.012622, lr=0.01
[STATS][L2] iter = 38, cost = 9728, time = 58.987, size = (1, 32, 32, 1), loss = 9.8818, loss1 = 9.8688, loss2 = 0.012997, lr=0.01
[STATS][L2] iter = 39, cost = 9984, time = 60.577, size = (1, 32, 32, 1), loss = 9.8821, loss1 = 9.8688, loss2 = 0.013377, lr=0.01
[STATS][L2] iter = 40, cost = 10240, time = 62.169, size = (1, 32, 32, 1), loss = 9.8825, loss1 = 9.8688, loss2 = 0.013772, lr=0.01
[STATS][L2] iter = 41, cost = 10496, time = 63.882, size = (1, 32, 32, 1), loss = 9.8831, loss1 = 9.8688, loss2 = 0.014287, lr=0.01
[STATS][L2] iter = 42, cost = 10752, time = 65.625, size = (1, 32, 32, 1), loss = 9.8835, loss1 = 9.8688, loss2 = 0.014693, lr=0.01
[STATS][L2] iter = 43, cost = 11008, time = 67.182, size = (1, 32, 32, 1), loss = 9.8839, loss1 = 9.8688, loss2 = 0.015144, lr=0.01
[STATS][L2] iter = 44, cost = 11264, time = 68.782, size = (1, 32, 32, 1), loss = 9.8843, loss1 = 9.8688, loss2 = 0.015484, lr=0.01
[STATS][L2] iter = 45, cost = 11520, time = 70.387, size = (1, 32, 32, 1), loss = 9.8846, loss1 = 9.8688, loss2 = 0.015812, lr=0.01
[STATS][L2] iter = 46, cost = 11776, time = 71.926, size = (1, 32, 32, 1), loss = 9.885, loss1 = 9.8688, loss2 = 0.016283, lr=0.01
[STATS][L2] iter = 47, cost = 12032, time = 73.477, size = (1, 32, 32, 1), loss = 9.8855, loss1 = 9.8688, loss2 = 0.016689, lr=0.01
[STATS][L2] iter = 48, cost = 12288, time = 75.013, size = (1, 32, 32, 1), loss = 9.8859, loss1 = 9.8688, loss2 = 0.017125, lr=0.01
[STATS][L2] iter = 49, cost = 12544, time = 76.556, size = (1, 32, 32, 1), loss = 9.8864, loss1 = 9.8688, loss2 = 0.017657, lr=0.01
[STATS][L2] iter = 50, cost = 12800, time = 78.121, size = (1, 32, 32, 1), loss = 9.8868, loss1 = 9.8688, loss2 = 0.018039, lr=0.01
[STATS][L2] iter = 51, cost = 13056, time = 79.667, size = (1, 32, 32, 1), loss = 9.8872, loss1 = 9.8688, loss2 = 0.018459, lr=0.01
[STATS][L2] iter = 52, cost = 13312, time = 81.295, size = (1, 32, 32, 1), loss = 9.8876, loss1 = 9.8688, loss2 = 0.018793, lr=0.01
[STATS][L2] iter = 53, cost = 13568, time = 82.819, size = (1, 32, 32, 1), loss = 9.8879, loss1 = 9.8688, loss2 = 0.019156, lr=0.01
[STATS][L2] iter = 54, cost = 13824, time = 84.349, size = (1, 32, 32, 1), loss = 9.8883, loss1 = 9.8688, loss2 = 0.019534, lr=0.01
[STATS][L2] iter = 55, cost = 14080, time = 85.872, size = (1, 32, 32, 1), loss = 9.8887, loss1 = 9.8688, loss2 = 0.019978, lr=0.01
[STATS][L2] iter = 56, cost = 14336, time = 87.412, size = (1, 32, 32, 1), loss = 9.8891, loss1 = 9.8688, loss2 = 0.020318, lr=0.01
[STATS][L2] iter = 57, cost = 14592, time = 88.960, size = (1, 32, 32, 1), loss = 9.8895, loss1 = 9.8688, loss2 = 0.020747, lr=0.01
[STATS][L2] iter = 58, cost = 14848, time = 90.492, size = (1, 32, 32, 1), loss = 9.8898, loss1 = 9.8688, loss2 = 0.02103, lr=0.01
[STATS][L2] iter = 59, cost = 15104, time = 92.001, size = (1, 32, 32, 1), loss = 9.8901, loss1 = 9.8688, loss2 = 0.021378, lr=0.01
[STATS][L2] iter = 60, cost = 15360, time = 93.562, size = (1, 32, 32, 1), loss = 9.8906, loss1 = 9.8688, loss2 = 0.021862, lr=0.01
[STATS][L2] iter = 61, cost = 15616, time = 95.157, size = (1, 32, 32, 1), loss = 9.891, loss1 = 9.8688, loss2 = 0.022262, lr=0.01
[STATS][L2] iter = 62, cost = 15872, time = 96.745, size = (1, 32, 32, 1), loss = 9.8914, loss1 = 9.8688, loss2 = 0.022656, lr=0.01
[STATS][L2] iter = 63, cost = 16128, time = 98.282, size = (1, 32, 32, 1), loss = 9.8918, loss1 = 9.8688, loss2 = 0.022997, lr=0.01
[STATS][L2] iter = 64, cost = 16384, time = 99.878, size = (1, 32, 32, 1), loss = 9.8921, loss1 = 9.8688, loss2 = 0.023333, lr=0.01
[STATS][L2] iter = 65, cost = 16640, time = 101.443, size = (1, 32, 32, 1), loss = 9.8925, loss1 = 9.8688, loss2 = 0.023749, lr=0.01
[STATS][L2] iter = 66, cost = 16896, time = 102.984, size = (1, 32, 32, 1), loss = 9.8929, loss1 = 9.8688, loss2 = 0.024085, lr=0.01
[STATS][L2] iter = 67, cost = 17152, time = 104.524, size = (1, 32, 32, 1), loss = 9.8932, loss1 = 9.8688, loss2 = 0.024456, lr=0.01
[STATS][L2] iter = 68, cost = 17408, time = 106.086, size = (1, 32, 32, 1), loss = 9.8935, loss1 = 9.8688, loss2 = 0.024739, lr=0.01
[STATS][L2] iter = 69, cost = 17664, time = 107.639, size = (1, 32, 32, 1), loss = 9.8938, loss1 = 9.8688, loss2 = 0.025029, lr=0.01
[STATS][L2] iter = 70, cost = 17920, time = 109.188, size = (1, 32, 32, 1), loss = 9.8941, loss1 = 9.8688, loss2 = 0.025354, lr=0.01
[STATS][L2] iter = 71, cost = 18176, time = 110.782, size = (1, 32, 32, 1), loss = 0.025684, loss1 = 0, loss2 = 0.025684, lr=0.01
saving outstep 1 and iteration 71
[STATS][L3](Attack found!) iter = 71, cost = 18432, time = 110.782, size = (1, 32, 32, 1), loss = 0.025677, loss1 = 0, loss2 = 0.025677
host/replica:0/task:0/device:GPU:0
Device mapping:
imEarly stopping because we found the adversarial example
old constant:  50.0
new constant:  25.0
finish attack adv shape  (288, 288, 1)
l2_distortion between inputs and adv  8.938970282562213
l2_distortion between inputs and adv_current  8.938970282562213
normalized a,b,c 288 288 1
(1, 288, 288, 3)
(1, 288, 288, 3)
perceptual metrics distance between adv and img 0.025684878
perceptual metrics distance between adv_current and img 0.025684878
normalized perceptual metrics distance between adv and img 8.918360496560733e-05
normalized perceptual metrics distance between adv_current and img 8.918360496560733e-05
perceptual hash difference is  10
Saving to id49_differ10_True_l28.94_pdistance0.02568487823009491
[STATS][L1] total = 50, id = 49, time = 240.445, success = True, const = 50.000000, hash_avg=10.08163, distortion = 8.93897, success_rate = 0.980, l2_avg=3.86456, p_avg=0.007172777600187276, iteration_avg=22.79591836734694
overall average hash  10.081632653061224
overall average l2  3.86455564228893
overal average perceptual distance  0.007172777600187276
overal average iterations  22.79591836734694
